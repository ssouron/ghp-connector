52dba99764d93d5045d645f4cf667928
"use strict";
/**
 * Tests for configuration module
 */
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", { value: true });
// Mock fs module
jest.mock('fs');
jest.mock('path');
jest.mock('os');
const fs_1 = __importDefault(require("fs"));
const path_1 = __importDefault(require("path"));
const os_1 = __importDefault(require("os"));
const index_1 = require("./index");
const test_utils_1 = require("../test-helpers/test-utils");
describe('Configuration Module', () => {
    // Cleanup temp files after each test
    const tempPaths = [];
    afterEach(() => {
        // Restore all mocks
        jest.restoreAllMocks();
        // Clean up temporary files
        (0, test_utils_1.cleanupTestFiles)(...tempPaths);
        tempPaths.length = 0;
    });
    describe('findConfigFile', () => {
        it('devrait trouver le fichier de configuration dans le répertoire courant', () => {
            // Mock fs.existsSync
            const mockExistsSync = jest.spyOn(fs_1.default, 'existsSync').mockImplementation((filePath) => {
                return filePath.toString().includes(index_1.CONFIG_FILENAME);
            });
            // Mock process.cwd and path.join
            jest.spyOn(process, 'cwd').mockReturnValue('/fake/current/dir');
            jest.spyOn(path_1.default, 'join').mockImplementation((...paths) => paths.join('/'));
            const configPath = (0, index_1.findConfigFile)();
            expect(configPath).toBe('/fake/current/dir/.ghprc.json');
            expect(mockExistsSync).toHaveBeenCalledWith('/fake/current/dir/.ghprc.json');
        });
        it('devrait trouver le fichier de configuration dans le répertoire home si absent du répertoire courant', () => {
            // Mock fs.existsSync to return false for current dir, true for home dir
            const mockExistsSync = jest.spyOn(fs_1.default, 'existsSync').mockImplementation((filePath) => {
                return filePath.toString().includes('home') && filePath.toString().includes(index_1.CONFIG_FILENAME);
            });
            // Mock process.cwd, os.homedir, and path.join
            jest.spyOn(process, 'cwd').mockReturnValue('/fake/current/dir');
            jest.spyOn(os_1.default, 'homedir').mockReturnValue('/fake/home/dir');
            jest.spyOn(path_1.default, 'join').mockImplementation((...paths) => paths.join('/'));
            const configPath = (0, index_1.findConfigFile)();
            expect(configPath).toBe('/fake/home/dir/.ghprc.json');
            expect(mockExistsSync).toHaveBeenCalledWith('/fake/current/dir/.ghprc.json');
            expect(mockExistsSync).toHaveBeenCalledWith('/fake/home/dir/.ghprc.json');
        });
        it('devrait retourner null si aucun fichier de configuration n\'est trouvé', () => {
            // Mock fs.existsSync to always return false
            jest.spyOn(fs_1.default, 'existsSync').mockReturnValue(false);
            // Mock process.cwd, os.homedir, and path.join
            jest.spyOn(process, 'cwd').mockReturnValue('/fake/current/dir');
            jest.spyOn(os_1.default, 'homedir').mockReturnValue('/fake/home/dir');
            jest.spyOn(path_1.default, 'join').mockImplementation((...paths) => paths.join('/'));
            const configPath = (0, index_1.findConfigFile)();
            expect(configPath).toBeNull();
        });
    });
    describe('loadConfigFile', () => {
        it('devrait charger et parser correctement un fichier de configuration JSON', () => {
            const testConfig = {
                github: {
                    owner: 'test-owner',
                    repo: 'test-repo'
                }
            };
            // Mock fs.readFileSync
            jest.spyOn(fs_1.default, 'readFileSync').mockReturnValue(JSON.stringify(testConfig));
            const config = (0, index_1.loadConfigFile)('/fake/path/.ghprc.json');
            expect(config).toEqual(testConfig);
        });
        it('devrait lancer une erreur si le fichier ne peut pas être lu', () => {
            // Mock fs.readFileSync to throw
            jest.spyOn(fs_1.default, 'readFileSync').mockImplementation(() => {
                throw new Error('File read error');
            });
            expect(() => {
                (0, index_1.loadConfigFile)('/fake/path/.ghprc.json');
            }).toThrow('Failed to load config file: File read error');
        });
        it('devrait lancer une erreur si le JSON est invalide', () => {
            // Mock fs.readFileSync to return invalid JSON
            jest.spyOn(fs_1.default, 'readFileSync').mockReturnValue('{ invalid: json }');
            expect(() => {
                (0, index_1.loadConfigFile)('/fake/path/.ghprc.json');
            }).toThrow('Failed to load config file:');
        });
    });
    describe('getEnvConfig', () => {
        it('devrait extraire la configuration depuis les variables d\'environnement', () => {
            // Mock environment variables
            const restoreEnv = (0, test_utils_1.mockEnv)({
                GITHUB_OWNER: 'env-owner',
                GITHUB_REPO: 'env-repo',
                GITHUB_TOKEN: 'env-token',
                GITHUB_API_URL: 'https://custom.github.api'
            });
            try {
                const config = (0, index_1.getEnvConfig)();
                expect(config).toEqual({
                    github: {
                        owner: 'env-owner',
                        repo: 'env-repo',
                        token: 'env-token',
                        baseUrl: 'https://custom.github.api'
                    }
                });
            }
            finally {
                restoreEnv();
            }
        });
        it('devrait retourner un objet vide si aucune variable d\'environnement pertinente n\'est définie', () => {
            // Mock environment variables (clear relevant ones)
            const restoreEnv = (0, test_utils_1.mockEnv)({
                GITHUB_OWNER: undefined,
                GITHUB_REPO: undefined,
                GITHUB_TOKEN: undefined,
                GITHUB_API_URL: undefined
            });
            try {
                const config = (0, index_1.getEnvConfig)();
                expect(config).toEqual({});
            }
            finally {
                restoreEnv();
            }
        });
        it('devrait inclure seulement les variables définies', () => {
            // Mock only some environment variables
            const restoreEnv = (0, test_utils_1.mockEnv)({
                GITHUB_OWNER: 'env-owner',
                GITHUB_REPO: undefined,
                GITHUB_TOKEN: 'env-token',
                GITHUB_API_URL: undefined
            });
            try {
                const config = (0, index_1.getEnvConfig)();
                expect(config).toEqual({
                    github: {
                        owner: 'env-owner',
                        token: 'env-token'
                    }
                });
            }
            finally {
                restoreEnv();
            }
        });
    });
    describe('mergeConfigs', () => {
        it('devrait fusionner les configurations avec la priorité correcte', () => {
            const fileConfig = {
                github: {
                    owner: 'file-owner',
                    repo: 'file-repo',
                    baseUrl: 'https://file.github.api'
                },
                defaults: {
                    format: 'json',
                    issues: {
                        state: 'all'
                    },
                    projects: {}
                }
            };
            const envConfig = {
                github: {
                    owner: 'env-owner',
                    repo: 'file-repo', // Needs both owner and repo
                    token: 'env-token'
                }
            };
            const cmdConfig = {
                github: {
                    owner: 'file-owner', // Needs both owner and repo
                    repo: 'cmd-repo'
                },
                defaults: {
                    format: 'table',
                    issues: {
                        state: 'open'
                    },
                    projects: {}
                }
            };
            const mergedConfig = (0, index_1.mergeConfigs)(cmdConfig, envConfig, fileConfig);
            // Check priorities: cmd > env > file > default
            expect(mergedConfig.github.owner).toBe('env-owner'); // From env
            expect(mergedConfig.github.repo).toBe('cmd-repo'); // From cmd
            expect(mergedConfig.github.token).toBe('env-token'); // From env
            expect(mergedConfig.github.baseUrl).toBe('https://file.github.api'); // From file
            expect(mergedConfig.defaults.format).toBe('table'); // From cmd
            expect(mergedConfig.defaults.issues.state).toBe('all'); // From file
            expect(mergedConfig.defaults.issues.limit).toBe(10); // From default
        });
        it('devrait utiliser les valeurs par défaut lorsqu\'aucune autre configuration n\'est fournie', () => {
            const mergedConfig = (0, index_1.mergeConfigs)({}, {}, {});
            expect(mergedConfig).toEqual((0, index_1.getDefaultConfig)());
        });
        it('devrait gérer correctement les configurations partielles', () => {
            const fileConfig = {
                github: {
                    owner: 'file-owner',
                    repo: '', // Add empty repo to satisfy type
                }
            };
            const mergedConfig = (0, index_1.mergeConfigs)({}, {}, fileConfig);
            const defaultConfig = (0, index_1.getDefaultConfig)();
            expect(mergedConfig.github.owner).toBe('file-owner');
            expect(mergedConfig.github.repo).toBe('');
            expect(mergedConfig.github.baseUrl).toBe('https://api.github.com');
            expect(mergedConfig.defaults).toEqual(defaultConfig.defaults);
        });
    });
    describe('cmdArgsToConfig', () => {
        it('devrait convertir les options de commande en structure de configuration', () => {
            const options = {
                owner: 'cmd-owner',
                repo: 'cmd-repo',
                format: 'json'
            };
            const config = (0, index_1.cmdArgsToConfig)(options);
            expect(config).toEqual({
                github: {
                    owner: 'cmd-owner',
                    repo: 'cmd-repo'
                },
                defaults: {
                    format: 'json'
                }
            });
        });
        it('devrait gérer les options partielles', () => {
            const options = {
                owner: 'cmd-owner'
            };
            const config = (0, index_1.cmdArgsToConfig)(options);
            expect(config).toEqual({
                github: {
                    owner: 'cmd-owner'
                }
            });
        });
        it('devrait retourner un objet vide si aucune option pertinente n\'est fournie', () => {
            const options = {
                irrelevant: 'value'
            };
            const config = (0, index_1.cmdArgsToConfig)(options);
            expect(config).toEqual({});
        });
    });
    describe('loadConfig', () => {
        it('devrait charger la configuration depuis toutes les sources', () => {
            // Prepare mocks
            const mockFileConfig = {
                github: {
                    owner: 'file-owner',
                    repo: 'file-repo'
                }
            };
            // Mock findConfigFile and loadConfigFile
            jest.spyOn(fs_1.default, 'existsSync').mockReturnValue(true);
            jest.spyOn(process, 'cwd').mockReturnValue('/fake/current/dir');
            jest.spyOn(path_1.default, 'join').mockImplementation((...paths) => paths.join('/'));
            jest.spyOn(fs_1.default, 'readFileSync').mockReturnValue(JSON.stringify(mockFileConfig));
            // Mock env
            const restoreEnv = (0, test_utils_1.mockEnv)({
                GITHUB_TOKEN: 'env-token'
            });
            try {
                const cmdArgs = {
                    defaults: {
                        format: 'table',
                        issues: {
                            state: 'open'
                        },
                        projects: {}
                    }
                };
                const config = (0, index_1.loadConfig)(cmdArgs);
                expect(config.github.owner).toBe('file-owner');
                expect(config.github.repo).toBe('file-repo');
                expect(config.github.token).toBe('env-token');
                expect(config.defaults.format).toBe('table');
            }
            finally {
                restoreEnv();
            }
        });
        it('devrait gérer l\'absence de fichier de configuration', () => {
            // Mock findConfigFile to return null
            jest.spyOn(fs_1.default, 'existsSync').mockReturnValue(false);
            // Mock env
            const restoreEnv = (0, test_utils_1.mockEnv)({
                GITHUB_OWNER: 'env-owner',
                GITHUB_REPO: 'env-repo'
            });
            try {
                const config = (0, index_1.loadConfig)();
                expect(config.github.owner).toBe('env-owner');
                expect(config.github.repo).toBe('env-repo');
            }
            finally {
                restoreEnv();
            }
        });
        it('devrait gérer les erreurs lors du chargement du fichier de configuration', () => {
            // Mock findConfigFile and loadConfigFile
            jest.spyOn(fs_1.default, 'existsSync').mockReturnValue(true);
            jest.spyOn(process, 'cwd').mockReturnValue('/fake/current/dir');
            jest.spyOn(path_1.default, 'join').mockImplementation((...paths) => paths.join('/'));
            jest.spyOn(fs_1.default, 'readFileSync').mockImplementation(() => {
                throw new Error('File error');
            });
            // Mock console.error
            const mockConsoleError = jest.spyOn(console, 'error').mockImplementation();
            const config = (0, index_1.loadConfig)();
            expect(mockConsoleError).toHaveBeenCalled();
            expect(config).toEqual((0, index_1.getDefaultConfig)());
        });
    });
    describe('initConfigFile', () => {
        it('devrait créer un nouveau fichier de configuration avec les paramètres par défaut', () => {
            // Mock fs.writeFileSync
            const mockWriteFileSync = jest.spyOn(fs_1.default, 'writeFileSync').mockImplementation();
            (0, index_1.initConfigFile)('/fake/path/.ghprc.json');
            expect(mockWriteFileSync).toHaveBeenCalledWith('/fake/path/.ghprc.json', expect.any(String), 'utf-8');
            // Check content contains JSON
            const content = mockWriteFileSync.mock.calls[0][1];
            const parsedContent = JSON.parse(content);
            expect(parsedContent).toEqual((0, index_1.getDefaultConfig)());
        });
        it('devrait lancer une erreur si le fichier ne peut pas être créé', () => {
            // Mock fs.writeFileSync to throw
            jest.spyOn(fs_1.default, 'writeFileSync').mockImplementation(() => {
                throw new Error('File write error');
            });
            expect(() => {
                (0, index_1.initConfigFile)('/fake/path/.ghprc.json');
            }).toThrow('Failed to create config file: File write error');
        });
    });
    describe('validateConfig', () => {
        it('devrait valider une configuration complète et correcte', () => {
            const config = {
                github: {
                    owner: 'valid-owner',
                    repo: 'valid-repo'
                },
                defaults: {
                    format: 'human',
                    issues: {
                        state: 'open'
                    },
                    projects: {}
                }
            };
            expect((0, index_1.validateConfig)(config)).toBe(true);
        });
        it('devrait lancer une erreur si owner est manquant', () => {
            const config = {
                github: {
                    repo: 'valid-repo'
                }
            };
            expect(() => (0, index_1.validateConfig)(config)).toThrow('owner is required');
        });
        it('devrait lancer une erreur si repo est manquant', () => {
            const config = {
                github: {
                    owner: 'valid-owner'
                }
            };
            expect(() => (0, index_1.validateConfig)(config)).toThrow('repo is required');
        });
        it('devrait lancer une erreur si format est invalide', () => {
            const config = {
                github: {
                    owner: 'valid-owner',
                    repo: 'valid-repo'
                },
                defaults: {
                    format: 'invalid-format',
                    issues: {
                        state: 'open'
                    },
                    projects: {}
                }
            };
            expect(() => (0, index_1.validateConfig)(config)).toThrow('Invalid format');
        });
    });
    // Tests d'intégration (avec le système de fichiers réel)
    describe('Integration tests with real file system', () => {
        // Restaurer les mocks pour ces tests
        beforeEach(() => {
            jest.restoreAllMocks();
        });
        it('devrait trouver et charger un fichier de configuration réel', () => {
            // Créer un fichier de configuration temporaire
            const testConfig = {
                github: {
                    owner: 'test-integration-owner',
                    repo: 'test-integration-repo'
                }
            };
            const tempDir = (0, test_utils_1.createTempTestDir)();
            tempPaths.push(tempDir);
            const configPath = (0, test_utils_1.createTempConfigFile)(testConfig, tempDir);
            // Mock process.cwd to return our temp directory
            jest.spyOn(process, 'cwd').mockReturnValue(tempDir);
            // Test findConfigFile and loadConfigFile with real files
            const foundPath = (0, index_1.findConfigFile)();
            expect(foundPath).toBe(configPath);
            const loadedConfig = (0, index_1.loadConfigFile)(foundPath);
            expect(loadedConfig).toEqual(testConfig);
        });
        it('devrait créer un fichier de configuration réel', () => {
            const tempDir = (0, test_utils_1.createTempTestDir)();
            tempPaths.push(tempDir);
            const configPath = path_1.default.join(tempDir, index_1.CONFIG_FILENAME);
            // Create the file
            (0, index_1.initConfigFile)(configPath);
            // Verify file exists
            expect(fs_1.default.existsSync(configPath)).toBe(true);
            // Verify content
            const content = fs_1.default.readFileSync(configPath, 'utf-8');
            const parsedContent = JSON.parse(content);
            expect(parsedContent).toEqual((0, index_1.getDefaultConfig)());
        });
        it('devrait charger et fusionner correctement des configurations depuis plusieurs sources', () => {
            // Create a config file
            const fileConfig = {
                github: {
                    owner: 'file-owner',
                    repo: 'file-repo'
                }
            };
            const tempDir = (0, test_utils_1.createTempTestDir)();
            tempPaths.push(tempDir);
            (0, test_utils_1.createTempConfigFile)(fileConfig, tempDir);
            // Mock process.cwd and env vars
            jest.spyOn(process, 'cwd').mockReturnValue(tempDir);
            const restoreEnv = (0, test_utils_1.mockEnv)({
                GITHUB_TOKEN: 'env-token'
            });
            try {
                // Command line args
                const cmdArgs = {
                    defaults: {
                        format: 'table',
                        issues: {
                            state: 'open'
                        },
                        projects: {}
                    }
                };
                // Load full config
                const config = (0, index_1.loadConfig)(cmdArgs);
                // Verify merging works correctly
                expect(config.github.owner).toBe('file-owner');
                expect(config.github.repo).toBe('file-repo');
                expect(config.github.token).toBe('env-token');
                expect(config.defaults.format).toBe('table');
            }
            finally {
                restoreEnv();
            }
        });
    });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiL1VzZXJzL3N0ZXBoYW5lc291cm9uL2Rldi9iZWRkeS1ieWUtc3Rvcmllcy9naHAtY29ubmVjdG9yL3NyYy9saWIvY29uZmlnL2luZGV4LnNwZWMudHMiLCJtYXBwaW5ncyI6IjtBQUFBOztHQUVHOzs7OztBQTJCSCxpQkFBaUI7QUFDakIsSUFBSSxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsQ0FBQztBQUNoQixJQUFJLENBQUMsSUFBSSxDQUFDLE1BQU0sQ0FBQyxDQUFDO0FBQ2xCLElBQUksQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLENBQUM7QUE1QmhCLDRDQUFvQjtBQUNwQixnREFBd0I7QUFDeEIsNENBQW9CO0FBQ3BCLG1DQWFpQjtBQUNqQiwyREFNb0M7QUFPcEMsUUFBUSxDQUFDLHNCQUFzQixFQUFFLEdBQUcsRUFBRTtJQUNwQyxxQ0FBcUM7SUFDckMsTUFBTSxTQUFTLEdBQWEsRUFBRSxDQUFDO0lBRS9CLFNBQVMsQ0FBQyxHQUFHLEVBQUU7UUFDYixvQkFBb0I7UUFDcEIsSUFBSSxDQUFDLGVBQWUsRUFBRSxDQUFDO1FBRXZCLDJCQUEyQjtRQUMzQixJQUFBLDZCQUFnQixFQUFDLEdBQUcsU0FBUyxDQUFDLENBQUM7UUFDL0IsU0FBUyxDQUFDLE1BQU0sR0FBRyxDQUFDLENBQUM7SUFDdkIsQ0FBQyxDQUFDLENBQUM7SUFFSCxRQUFRLENBQUMsZ0JBQWdCLEVBQUUsR0FBRyxFQUFFO1FBQzlCLEVBQUUsQ0FBQyx3RUFBd0UsRUFBRSxHQUFHLEVBQUU7WUFDaEYscUJBQXFCO1lBQ3JCLE1BQU0sY0FBYyxHQUFHLElBQUksQ0FBQyxLQUFLLENBQUMsWUFBRSxFQUFFLFlBQVksQ0FBQyxDQUFDLGtCQUFrQixDQUFDLENBQUMsUUFBUSxFQUFFLEVBQUU7Z0JBQ2xGLE9BQU8sUUFBUSxDQUFDLFFBQVEsRUFBRSxDQUFDLFFBQVEsQ0FBQyx1QkFBZSxDQUFDLENBQUM7WUFDdkQsQ0FBQyxDQUFDLENBQUM7WUFFSCxpQ0FBaUM7WUFDakMsSUFBSSxDQUFDLEtBQUssQ0FBQyxP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ZXMvZ2hwLWNvbm5lY3Rvci9zcmMvbGliL2NvbmZpZy9pbmRleC5zcGVjLnRzIl0sInNvdXJjZXNDb250ZW50IjpbIi8qKlxuICogVGVzdHMgZm9yIGNvbmZpZ3VyYXRpb24gbW9kdWxlXG4gKi9cblxuaW1wb3J0IGZzIGZyb20gJ2ZzJztcbmltcG9ydCBwYXRoIGZyb20gJ3BhdGgnO1xuaW1wb3J0IG9zIGZyb20gJ29zJztcbmltcG9ydCB7IFxuICBDT05GSUdfRklMRU5BTUUsXG4gIGZpbmRDb25maWdGaWxlLFxuICBsb2FkQ29uZmlnRmlsZSxcbiAgZ2V0RW52Q29uZmlnLFxuICBtZXJnZUNvbmZpZ3MsXG4gIGNtZEFyZ3NUb0NvbmZpZyxcbiAgbG9hZENvbmZpZyxcbiAgaW5pdENvbmZpZ0ZpbGUsXG4gIGdldERlZmF1bHRDb25maWcsXG4gIHZhbGlkYXRlQ29uZmlnLFxuICBHSFBDb25maWcsXG4gIEdpdEh1YkNvbmZpZ1xufSBmcm9tICcuL2luZGV4JztcbmltcG9ydCB7XG4gIGNyZWF0ZVRlbXBUZXN0RGlyLFxuICBjcmVhdGVUZW1wVGVzdEZpbGUsXG4gIGNyZWF0ZVRlbXBDb25maWdGaWxlLFxuICBjbGVhbnVwVGVzdEZpbGVzLFxuICBtb2NrRW52XG59IGZyb20gJy4uL3Rlc3QtaGVscGVycy90ZXN0LXV0aWxzJztcblxuLy8gTW9jayBmcyBtb2R1bGVcbmplc3QubW9jaygnZnMnKTtcbmplc3QubW9jaygncGF0aCcpO1xuamVzdC5tb2NrKCdvcycpO1xuXG5kZXNjcmliZSgnQ29uZmlndXJhdGlvbiBNb2R1bGUnLCAoKSA9PiB7XG4gIC8vIENsZWFudXAgdGVtcCBmaWxlcyBhZnRlciBlYWNoIHRlc3RcbiAgY29uc3QgdGVtcFBhdGhzOiBzdHJpbmdbXSA9IFtdO1xuICBcbiAgYWZ0ZXJFYWNoKCgpID0+IHtcbiAgICAvLyBSZXN0b3JlIGFsbCBtb2Nrc1xuICAgIGplc3QucmVzdG9yZUFsbE1vY2tzKCk7XG4gICAgXG4gICAgLy8gQ2xlYW4gdXAgdGVtcG9yYXJ5IGZpbGVzXG4gICAgY2xlYW51cFRlc3RGaWxlcyguLi50ZW1wUGF0aHMpO1xuICAgIHRlbXBQYXRocy5sZW5ndGggPSAwO1xuICB9KTtcblxuICBkZXNjcmliZSgnZmluZENvbmZpZ0ZpbGUnLCAoKSA9PiB7XG4gICAgaXQoJ2RldnJhaXQgdHJvdXZlciBsZSBmaWNoaWVyIGRlIGNvbmZpZ3VyYXRpb24gZGFucyBsZSByw6lwZXJ0b2lyZSBjb3VyYW50JywgKCkgPT4ge1xuICAgICAgLy8gTW9jayBmcy5leGlzdHNTeW5jXG4gICAgICBjb25zdCBtb2NrRXhpc3RzU3luYyA9IGplc3Quc3B5T24oZnMsICdleGlzdHNTeW5jJykubW9ja0ltcGxlbWVudGF0aW9uKChmaWxlUGF0aCkgPT4ge1xuICAgICAgICByZXR1cm4gZmlsZVBhdGgudG9TdHJpbmcoKS5pbmNsdWRlcyhDT05GSUdfRklMRU5BTUUpO1xuICAgICAgfSk7XG4gICAgICBcbiAgICAgIC8vIE1vY2sgcHJvY2Vzcy5jd2QgYW5kIHBhdGguam9pblxuICAgICAgamVzdC5zcHlPbihwcm9jZXNzLCAnY3dkJykubW9ja1JldHVyblZhbHVlKCcvZmFrZS9jdXJyZW50L2RpcicpO1xuICAgICAgamVzdC5zcHlPbihwYXRoLCAnam9pbicpLm1vY2tJbXBsZW1lbnRhdGlvbigoLi4ucGF0aHMpID0+IHBhdGhzLmpvaW4oJy8nKSk7XG4gICAgICBcbiAgICAgIGNvbnN0IGNvbmZpZ1BhdGggPSBmaW5kQ29uZmlnRmlsZSgpO1xuICAgICAgXG4gICAgICBleHBlY3QoY29uZmlnUGF0aCkudG9CZSgnL2Zha2UvY3VycmVudC9kaXIvLmdocHJjLmpzb24nKTtcbiAgICAgIGV4cGVjdChtb2NrRXhpc3RzU3luYykudG9IYXZlQmVlbkNhbGxlZFdpdGgoJy9mYWtlL2N1cnJlbnQvZGlyLy5naHByYy5qc29uJyk7XG4gICAgfSk7XG5cbiAgICBpdCgnZGV2cmFpdCB0cm91dmVyIGxlIGZpY2hpZXIgZGUgY29uZmlndXJhdGlvbiBkYW5zIGxlIHLDqXBlcnRvaXJlIGhvbWUgc2kgYWJzZW50IGR1IHLDqXBlcnRvaXJlIGNvdXJhbnQnLCAoKSA9PiB7XG4gICAgICAvLyBNb2NrIGZzLmV4aXN0c1N5bmMgdG8gcmV0dXJuIGZhbHNlIGZvciBjdXJyZW50IGRpciwgdHJ1ZSBmb3IgaG9tZSBkaXJcbiAgICAgIGNvbnN0IG1vY2tFeGlzdHNTeW5jID0gamVzdC5zcHlPbihmcywgJ2V4aXN0c1N5bmMnKS5tb2NrSW1wbGVtZW50YXRpb24oKGZpbGVQYXRoKSA9PiB7XG4gICAgICAgIHJldHVybiBmaWxlUGF0aC50b1N0cmluZygpLmluY2x1ZGVzKCdob21lJykgJiYgZmlsZVBhdGgudG9TdHJpbmcoKS5pbmNsdWRlcyhDT05GSUdfRklMRU5BTUUpO1xuICAgICAgfSk7XG4gICAgICBcbiAgICAgIC8vIE1vY2sgcHJvY2Vzcy5jd2QsIG9zLmhvbWVkaXIsIGFuZCBwYXRoLmpvaW5cbiAgICAgIGplc3Quc3B5T24ocHJvY2VzcywgJ2N3ZCcpLm1vY2tSZXR1cm5WYWx1ZSgnL2Zha2UvY3VycmVudC9kaXInKTtcbiAgICAgIGplc3Quc3B5T24ob3MsICdob21lZGlyJykubW9ja1JldHVyblZhbHVlKCcvZmFrZS9ob21lL2RpcicpO1xuICAgICAgamVzdC5zcHlPbihwYXRoLCAnam9pbicpLm1vY2tJbXBsZW1lbnRhdGlvbigoLi4ucGF0aHMpID0+IHBhdGhzLmpvaW4oJy8nKSk7XG4gICAgICBcbiAgICAgIGNvbnN0IGNvbmZpZ1BhdGggPSBmaW5kQ29uZmlnRmlsZSgpO1xuICAgICAgXG4gICAgICBleHBlY3QoY29uZmlnUGF0aCkudG9CZSgnL2Zha2UvaG9tZS9kaXIvLmdocHJjLmpzb24nKTtcbiAgICAgIGV4cGVjdChtb2NrRXhpc3RzU3luYykudG9IYXZlQmVlbkNhbGxlZFdpdGgoJy9mYWtlL2N1cnJlbnQvZGlyLy5naHByYy5qc29uJyk7XG4gICAgICBleHBlY3QobW9ja0V4aXN0c1N5bmMpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKCcvZmFrZS9ob21lL2Rpci8uZ2hwcmMuanNvbicpO1xuICAgIH0pO1xuXG4gICAgaXQoJ2RldnJhaXQgcmV0b3VybmVyIG51bGwgc2kgYXVjdW4gZmljaGllciBkZSBjb25maWd1cmF0aW9uIG5cXCdlc3QgdHJvdXbDqScsICgpID0+IHtcbiAgICAgIC8vIE1vY2sgZnMuZXhpc3RzU3luYyB0byBhbHdheXMgcmV0dXJuIGZhbHNlXG4gICAgICBqZXN0LnNweU9uKGZzLCAnZXhpc3RzU3luYycpLm1vY2tSZXR1cm5WYWx1ZShmYWxzZSk7XG4gICAgICBcbiAgICAgIC8vIE1vY2sgcHJvY2Vzcy5jd2QsIG9zLmhvbWVkaXIsIGFuZCBwYXRoLmpvaW5cbiAgICAgIGplc3Quc3B5T24ocHJvY2VzcywgJ2N3ZCcpLm1vY2tSZXR1cm5WYWx1ZSgnL2Zha2UvY3VycmVudC9kaXInKTtcbiAgICAgIGplc3Quc3B5T24ob3MsICdob21lZGlyJykubW9ja1JldHVyblZhbHVlKCcvZmFrZS9ob21lL2RpcicpO1xuICAgICAgamVzdC5zcHlPbihwYXRoLCAnam9pbicpLm1vY2tJbXBsZW1lbnRhdGlvbigoLi4ucGF0aHMpID0+IHBhdGhzLmpvaW4oJy8nKSk7XG4gICAgICBcbiAgICAgIGNvbnN0IGNvbmZpZ1BhdGggPSBmaW5kQ29uZmlnRmlsZSgpO1xuICAgICAgXG4gICAgICBleHBlY3QoY29uZmlnUGF0aCkudG9CZU51bGwoKTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ2xvYWRDb25maWdGaWxlJywgKCkgPT4ge1xuICAgIGl0KCdkZXZyYWl0IGNoYXJnZXIgZXQgcGFyc2VyIGNvcnJlY3RlbWVudCB1biBmaWNoaWVyIGRlIGNvbmZpZ3VyYXRpb24gSlNPTicsICgpID0+IHtcbiAgICAgIGNvbnN0IHRlc3RDb25maWcgPSB7XG4gICAgICAgIGdpdGh1Yjoge1xuICAgICAgICAgIG93bmVyOiAndGVzdC1vd25lcicsXG4gICAgICAgICAgcmVwbzogJ3Rlc3QtcmVwbydcbiAgICAgICAgfVxuICAgICAgfTtcbiAgICAgIFxuICAgICAgLy8gTW9jayBmcy5yZWFkRmlsZVN5bmNcbiAgICAgIGplc3Quc3B5T24oZnMsICdyZWFkRmlsZVN5bmMnKS5tb2NrUmV0dXJuVmFsdWUoSlNPTi5zdHJpbmdpZnkodGVzdENvbmZpZykpO1xuICAgICAgXG4gICAgICBjb25zdCBjb25maWcgPSBsb2FkQ29uZmlnRmlsZSgnL2Zha2UvcGF0aC8uZ2hwcmMuanNvbicpO1xuICAgICAgXG4gICAgICBleHBlY3QoY29uZmlnKS50b0VxdWFsKHRlc3RDb25maWcpO1xuICAgIH0pO1xuXG4gICAgaXQoJ2RldnJhaXQgbGFuY2VyIHVuZSBlcnJldXIgc2kgbGUgZmljaGllciBuZSBwZXV0IHBhcyDDqnRyZSBsdScsICgpID0+IHtcbiAgICAgIC8vIE1vY2sgZnMucmVhZEZpbGVTeW5jIHRvIHRocm93XG4gICAgICBqZXN0LnNweU9uKGZzLCAncmVhZEZpbGVTeW5jJykubW9ja0ltcGxlbWVudGF0aW9uKCgpID0+IHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdGaWxlIHJlYWQgZXJyb3InKTtcbiAgICAgIH0pO1xuICAgICAgXG4gICAgICBleHBlY3QoKCkgPT4ge1xuICAgICAgICBsb2FkQ29uZmlnRmlsZSgnL2Zha2UvcGF0aC8uZ2hwcmMuanNvbicpO1xuICAgICAgfSkudG9UaHJvdygnRmFpbGVkIHRvIGxvYWQgY29uZmlnIGZpbGU6IEZpbGUgcmVhZCBlcnJvcicpO1xuICAgIH0pO1xuXG4gICAgaXQoJ2RldnJhaXQgbGFuY2VyIHVuZSBlcnJldXIgc2kgbGUgSlNPTiBlc3QgaW52YWxpZGUnLCAoKSA9PiB7XG4gICAgICAvLyBNb2NrIGZzLnJlYWRGaWxlU3luYyB0byByZXR1cm4gaW52YWxpZCBKU09OXG4gICAgICBqZXN0LnNweU9uKGZzLCAncmVhZEZpbGVTeW5jJykubW9ja1JldHVyblZhbHVlKCd7IGludmFsaWQ6IGpzb24gfScpO1xuICAgICAgXG4gICAgICBleHBlY3QoKCkgPT4ge1xuICAgICAgICBsb2FkQ29uZmlnRmlsZSgnL2Zha2UvcGF0aC8uZ2hwcmMuanNvbicpO1xuICAgICAgfSkudG9UaHJvdygnRmFpbGVkIHRvIGxvYWQgY29uZmlnIGZpbGU6Jyk7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdnZXRFbnZDb25maWcnLCAoKSA9PiB7XG4gICAgaXQoJ2RldnJhaXQgZXh0cmFpcmUgbGEgY29uZmlndXJhdGlvbiBkZXB1aXMgbGVzIHZhcmlhYmxlcyBkXFwnZW52aXJvbm5lbWVudCcsICgpID0+IHtcbiAgICAgIC8vIE1vY2sgZW52aXJvbm1lbnQgdmFyaWFibGVzXG4gICAgICBjb25zdCByZXN0b3JlRW52ID0gbW9ja0Vudih7XG4gICAgICAgIEdJVEhVQl9PV05FUjogJ2Vudi1vd25lcicsXG4gICAgICAgIEdJVEhVQl9SRVBPOiAnZW52LXJlcG8nLFxuICAgICAgICBHSVRIVUJfVE9LRU46ICdlbnYtdG9rZW4nLFxuICAgICAgICBHSVRIVUJfQVBJX1VSTDogJ2h0dHBzOi8vY3VzdG9tLmdpdGh1Yi5hcGknXG4gICAgICB9KTtcbiAgICAgIFxuICAgICAgdHJ5IHtcbiAgICAgICAgY29uc3QgY29uZmlnID0gZ2V0RW52Q29uZmlnKCk7XG4gICAgICAgIFxuICAgICAgICBleHBlY3QoY29uZmlnKS50b0VxdWFsKHtcbiAgICAgICAgICBnaXRodWI6IHtcbiAgICAgICAgICAgIG93bmVyOiAnZW52LW93bmVyJyxcbiAgICAgICAgICAgIHJlcG86ICdlbnYtcmVwbycsXG4gICAgICAgICAgICB0b2tlbjogJ2Vudi10b2tlbicsXG4gICAgICAgICAgICBiYXNlVXJsOiAnaHR0cHM6Ly9jdXN0b20uZ2l0aHViLmFwaSdcbiAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgfSBmaW5hbGx5IHtcbiAgICAgICAgcmVzdG9yZUVudigpO1xuICAgICAgfVxuICAgIH0pO1xuXG4gICAgaXQoJ2RldnJhaXQgcmV0b3VybmVyIHVuIG9iamV0IHZpZGUgc2kgYXVjdW5lIHZhcmlhYmxlIGRcXCdlbnZpcm9ubmVtZW50IHBlcnRpbmVudGUgblxcJ2VzdCBkw6lmaW5pZScsICgpID0+IHtcbiAgICAgIC8vIE1vY2sgZW52aXJvbm1lbnQgdmFyaWFibGVzIChjbGVhciByZWxldmFudCBvbmVzKVxuICAgICAgY29uc3QgcmVzdG9yZUVudiA9IG1vY2tFbnYoe1xuICAgICAgICBHSVRIVUJfT1dORVI6IHVuZGVmaW5lZCxcbiAgICAgICAgR0lUSFVCX1JFUE86IHVuZGVmaW5lZCxcbiAgICAgICAgR0lUSFVCX1RPS0VOOiB1bmRlZmluZWQsXG4gICAgICAgIEdJVEhVQl9BUElfVVJMOiB1bmRlZmluZWRcbiAgICAgIH0pO1xuICAgICAgXG4gICAgICB0cnkge1xuICAgICAgICBjb25zdCBjb25maWcgPSBnZXRFbnZDb25maWcoKTtcbiAgICAgICAgZXhwZWN0KGNvbmZpZykudG9FcXVhbCh7fSk7XG4gICAgICB9IGZpbmFsbHkge1xuICAgICAgICByZXN0b3JlRW52KCk7XG4gICAgICB9XG4gICAgfSk7XG5cbiAgICBpdCgnZGV2cmFpdCBpbmNsdXJlIHNldWxlbWVudCBsZXMgdmFyaWFibGVzIGTDqWZpbmllcycsICgpID0+IHtcbiAgICAgIC8vIE1vY2sgb25seSBzb21lIGVudmlyb25tZW50IHZhcmlhYmxlc1xuICAgICAgY29uc3QgcmVzdG9yZUVudiA9IG1vY2tFbnYoe1xuICAgICAgICBHSVRIVUJfT1dORVI6ICdlbnYtb3duZXInLFxuICAgICAgICBHSVRIVUJfUkVQTzogdW5kZWZpbmVkLFxuICAgICAgICBHSVRIVUJfVE9LRU46ICdlbnYtdG9rZW4nLFxuICAgICAgICBHSVRIVUJfQVBJX1VSTDogdW5kZWZpbmVkXG4gICAgICB9KTtcbiAgICAgIFxuICAgICAgdHJ5IHtcbiAgICAgICAgY29uc3QgY29uZmlnID0gZ2V0RW52Q29uZmlnKCk7XG4gICAgICAgIFxuICAgICAgICBleHBlY3QoY29uZmlnKS50b0VxdWFsKHtcbiAgICAgICAgICBnaXRodWI6IHtcbiAgICAgICAgICAgIG93bmVyOiAnZW52LW93bmVyJyxcbiAgICAgICAgICAgIHRva2VuOiAnZW52LXRva2VuJ1xuICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICB9IGZpbmFsbHkge1xuICAgICAgICByZXN0b3JlRW52KCk7XG4gICAgICB9XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdtZXJnZUNvbmZpZ3MnLCAoKSA9PiB7XG4gICAgaXQoJ2RldnJhaXQgZnVzaW9ubmVyIGxlcyBjb25maWd1cmF0aW9ucyBhdmVjIGxhIHByaW9yaXTDqSBjb3JyZWN0ZScsICgpID0+IHtcbiAgICAgIGNvbnN0IGZpbGVDb25maWc6IFBhcnRpYWw8R0hQQ29uZmlnPiA9IHtcbiAgICAgICAgZ2l0aHViOiB7XG4gICAgICAgICAgb3duZXI6ICdmaWxlLW93bmVyJyxcbiAgICAgICAgICByZXBvOiAnZmlsZS1yZXBvJyxcbiAgICAgICAgICBiYXNlVXJsOiAnaHR0cHM6Ly9maWxlLmdpdGh1Yi5hcGknXG4gICAgICAgIH0gYXMgR2l0SHViQ29uZmlnLFxuICAgICAgICBkZWZhdWx0czoge1xuICAgICAgICAgIGZvcm1hdDogJ2pzb24nIGFzIGNvbnN0LFxuICAgICAgICAgIGlzc3Vlczoge1xuICAgICAgICAgICAgc3RhdGU6ICdhbGwnXG4gICAgICAgICAgfSxcbiAgICAgICAgICBwcm9qZWN0czoge31cbiAgICAgICAgfVxuICAgICAgfTtcbiAgICAgIFxuICAgICAgY29uc3QgZW52Q29uZmlnOiBQYXJ0aWFsPEdIUENvbmZpZz4gPSB7XG4gICAgICAgIGdpdGh1Yjoge1xuICAgICAgICAgIG93bmVyOiAnZW52LW93bmVyJyxcbiAgICAgICAgICByZXBvOiAnZmlsZS1yZXBvJywgLy8gTmVlZHMgYm90aCBvd25lciBhbmQgcmVwb1xuICAgICAgICAgIHRva2VuOiAnZW52LXRva2VuJ1xuICAgICAgICB9IGFzIEdpdEh1YkNvbmZpZ1xuICAgICAgfTtcbiAgICAgIFxuICAgICAgY29uc3QgY21kQ29uZmlnOiBQYXJ0aWFsPEdIUENvbmZpZz4gPSB7XG4gICAgICAgIGdpdGh1Yjoge1xuICAgICAgICAgIG93bmVyOiAnZmlsZS1vd25lcicsIC8vIE5lZWRzIGJvdGggb3duZXIgYW5kIHJlcG9cbiAgICAgICAgICByZXBvOiAnY21kLXJlcG8nXG4gICAgICAgIH0gYXMgR2l0SHViQ29uZmlnLFxuICAgICAgICBkZWZhdWx0czoge1xuICAgICAgICAgIGZvcm1hdDogJ3RhYmxlJyBhcyBjb25zdCxcbiAgICAgICAgICBpc3N1ZXM6IHtcbiAgICAgICAgICAgIHN0YXRlOiAnb3BlbidcbiAgICAgICAgICB9LFxuICAgICAgICAgIHByb2plY3RzOiB7fVxuICAgICAgICB9XG4gICAgICB9O1xuICAgICAgXG4gICAgICBjb25zdCBtZXJnZWRDb25maWcgPSBtZXJnZUNvbmZpZ3MoY21kQ29uZmlnLCBlbnZDb25maWcsIGZpbGVDb25maWcpO1xuICAgICAgXG4gICAgICAvLyBDaGVjayBwcmlvcml0aWVzOiBjbWQgPiBlbnYgPiBmaWxlID4gZGVmYXVsdFxuICAgICAgZXhwZWN0KG1lcmdlZENvbmZpZy5naXRodWIub3duZXIpLnRvQmUoJ2Vudi1vd25lcicpOyAvLyBGcm9tIGVudlxuICAgICAgZXhwZWN0KG1lcmdlZENvbmZpZy5naXRodWIucmVwbykudG9CZSgnY21kLXJlcG8nKTsgLy8gRnJvbSBjbWRcbiAgICAgIGV4cGVjdChtZXJnZWRDb25maWcuZ2l0aHViLnRva2VuKS50b0JlKCdlbnYtdG9rZW4nKTsgLy8gRnJvbSBlbnZcbiAgICAgIGV4cGVjdChtZXJnZWRDb25maWcuZ2l0aHViLmJhc2VVcmwpLnRvQmUoJ2h0dHBzOi8vZmlsZS5naXRodWIuYXBpJyk7IC8vIEZyb20gZmlsZVxuICAgICAgZXhwZWN0KG1lcmdlZENvbmZpZy5kZWZhdWx0cy5mb3JtYXQpLnRvQmUoJ3RhYmxlJyk7IC8vIEZyb20gY21kXG4gICAgICBleHBlY3QobWVyZ2VkQ29uZmlnLmRlZmF1bHRzLmlzc3Vlcy5zdGF0ZSkudG9CZSgnYWxsJyk7IC8vIEZyb20gZmlsZVxuICAgICAgZXhwZWN0KG1lcmdlZENvbmZpZy5kZWZhdWx0cy5pc3N1ZXMubGltaXQpLnRvQmUoMTApOyAvLyBGcm9tIGRlZmF1bHRcbiAgICB9KTtcblxuICAgIGl0KCdkZXZyYWl0IHV0aWxpc2VyIGxlcyB2YWxldXJzIHBhciBkw6lmYXV0IGxvcnNxdVxcJ2F1Y3VuZSBhdXRyZSBjb25maWd1cmF0aW9uIG5cXCdlc3QgZm91cm5pZScsICgpID0+IHtcbiAgICAgIGNvbnN0IG1lcmdlZENvbmZpZyA9IG1lcmdlQ29uZmlncyh7fSwge30sIHt9KTtcbiAgICAgIFxuICAgICAgZXhwZWN0KG1lcmdlZENvbmZpZykudG9FcXVhbChnZXREZWZhdWx0Q29uZmlnKCkpO1xuICAgIH0pO1xuXG4gICAgaXQoJ2RldnJhaXQgZ8OpcmVyIGNvcnJlY3RlbWVudCBsZXMgY29uZmlndXJhdGlvbnMgcGFydGllbGxlcycsICgpID0+IHtcbiAgICAgIGNvbnN0IGZpbGVDb25maWc6IFBhcnRpYWw8R0hQQ29uZmlnPiA9IHtcbiAgICAgICAgZ2l0aHViOiB7XG4gICAgICAgICAgb3duZXI6ICdmaWxlLW93bmVyJyxcbiAgICAgICAgICByZXBvOiAnJywgLy8gQWRkIGVtcHR5IHJlcG8gdG8gc2F0aXNmeSB0eXBlXG4gICAgICAgIH0gYXMgR2l0SHViQ29uZmlnXG4gICAgICB9O1xuICAgICAgXG4gICAgICBjb25zdCBtZXJnZWRDb25maWcgPSBtZXJnZUNvbmZpZ3Moe30sIHt9LCBmaWxlQ29uZmlnKTtcbiAgICAgIFxuICAgICAgY29uc3QgZGVmYXVsdENvbmZpZyA9IGdldERlZmF1bHRDb25maWcoKTtcbiAgICAgIGV4cGVjdChtZXJnZWRDb25maWcuZ2l0aHViLm93bmVyKS50b0JlKCdmaWxlLW93bmVyJyk7XG4gICAgICBleHBlY3QobWVyZ2VkQ29uZmlnLmdpdGh1Yi5yZXBvKS50b0JlKCcnKTtcbiAgICAgIGV4cGVjdChtZXJnZWRDb25maWcuZ2l0aHViLmJhc2VVcmwpLnRvQmUoJ2h0dHBzOi8vYXBpLmdpdGh1Yi5jb20nKTtcbiAgICAgIGV4cGVjdChtZXJnZWRDb25maWcuZGVmYXVsdHMpLnRvRXF1YWwoZGVmYXVsdENvbmZpZy5kZWZhdWx0cyk7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdjbWRBcmdzVG9Db25maWcnLCAoKSA9PiB7XG4gICAgaXQoJ2RldnJhaXQgY29udmVydGlyIGxlcyBvcHRpb25zIGRlIGNvbW1hbmRlIGVuIHN0cnVjdHVyZSBkZSBjb25maWd1cmF0aW9uJywgKCkgPT4ge1xuICAgICAgY29uc3Qgb3B0aW9ucyA9IHtcbiAgICAgICAgb3duZXI6ICdjbWQtb3duZXInLFxuICAgICAgICByZXBvOiAnY21kLXJlcG8nLFxuICAgICAgICBmb3JtYXQ6ICdqc29uJ1xuICAgICAgfTtcbiAgICAgIFxuICAgICAgY29uc3QgY29uZmlnID0gY21kQXJnc1RvQ29uZmlnKG9wdGlvbnMpO1xuICAgICAgXG4gICAgICBleHBlY3QoY29uZmlnKS50b0VxdWFsKHtcbiAgICAgICAgZ2l0aHViOiB7XG4gICAgICAgICAgb3duZXI6ICdjbWQtb3duZXInLFxuICAgICAgICAgIHJlcG86ICdjbWQtcmVwbydcbiAgICAgICAgfSxcbiAgICAgICAgZGVmYXVsdHM6IHtcbiAgICAgICAgICBmb3JtYXQ6ICdqc29uJ1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICB9KTtcblxuICAgIGl0KCdkZXZyYWl0IGfDqXJlciBsZXMgb3B0aW9ucyBwYXJ0aWVsbGVzJywgKCkgPT4ge1xuICAgICAgY29uc3Qgb3B0aW9ucyA9IHtcbiAgICAgICAgb3duZXI6ICdjbWQtb3duZXInXG4gICAgICB9O1xuICAgICAgXG4gICAgICBjb25zdCBjb25maWcgPSBjbWRBcmdzVG9Db25maWcob3B0aW9ucyk7XG4gICAgICBcbiAgICAgIGV4cGVjdChjb25maWcpLnRvRXF1YWwoe1xuICAgICAgICBnaXRodWI6IHtcbiAgICAgICAgICBvd25lcjogJ2NtZC1vd25lcidcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfSk7XG5cbiAgICBpdCgnZGV2cmFpdCByZXRvdXJuZXIgdW4gb2JqZXQgdmlkZSBzaSBhdWN1bmUgb3B0aW9uIHBlcnRpbmVudGUgblxcJ2VzdCBmb3VybmllJywgKCkgPT4ge1xuICAgICAgY29uc3Qgb3B0aW9ucyA9IHtcbiAgICAgICAgaXJyZWxldmFudDogJ3ZhbHVlJ1xuICAgICAgfTtcbiAgICAgIFxuICAgICAgY29uc3QgY29uZmlnID0gY21kQXJnc1RvQ29uZmlnKG9wdGlvbnMpO1xuICAgICAgXG4gICAgICBleHBlY3QoY29uZmlnKS50b0VxdWFsKHt9KTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ2xvYWRDb25maWcnLCAoKSA9PiB7XG4gICAgaXQoJ2RldnJhaXQgY2hhcmdlciBsYSBjb25maWd1cmF0aW9uIGRlcHVpcyB0b3V0ZXMgbGVzIHNvdXJjZXMnLCAoKSA9PiB7XG4gICAgICAvLyBQcmVwYXJlIG1vY2tzXG4gICAgICBjb25zdCBtb2NrRmlsZUNvbmZpZyA9IHtcbiAgICAgICAgZ2l0aHViOiB7XG4gICAgICAgICAgb3duZXI6ICdmaWxlLW93bmVyJyxcbiAgICAgICAgICByZXBvOiAnZmlsZS1yZXBvJ1xuICAgICAgICB9XG4gICAgICB9O1xuICAgICAgXG4gICAgICAvLyBNb2NrIGZpbmRDb25maWdGaWxlIGFuZCBsb2FkQ29uZmlnRmlsZVxuICAgICAgamVzdC5zcHlPbihmcywgJ2V4aXN0c1N5bmMnKS5tb2NrUmV0dXJuVmFsdWUodHJ1ZSk7XG4gICAgICBqZXN0LnNweU9uKHByb2Nlc3MsICdjd2QnKS5tb2NrUmV0dXJuVmFsdWUoJy9mYWtlL2N1cnJlbnQvZGlyJyk7XG4gICAgICBqZXN0LnNweU9uKHBhdGgsICdqb2luJykubW9ja0ltcGxlbWVudGF0aW9uKCguLi5wYXRocykgPT4gcGF0aHMuam9pbignLycpKTtcbiAgICAgIGplc3Quc3B5T24oZnMsICdyZWFkRmlsZVN5bmMnKS5tb2NrUmV0dXJuVmFsdWUoSlNPTi5zdHJpbmdpZnkobW9ja0ZpbGVDb25maWcpKTtcbiAgICAgIFxuICAgICAgLy8gTW9jayBlbnZcbiAgICAgIGNvbnN0IHJlc3RvcmVFbnYgPSBtb2NrRW52KHtcbiAgICAgICAgR0lUSFVCX1RPS0VOOiAnZW52LXRva2VuJ1xuICAgICAgfSk7XG4gICAgICBcbiAgICAgIHRyeSB7XG4gICAgICAgIGNvbnN0IGNtZEFyZ3M6IFBhcnRpYWw8R0hQQ29uZmlnPiA9IHtcbiAgICAgICAgICBkZWZhdWx0czoge1xuICAgICAgICAgICAgZm9ybWF0OiAndGFibGUnIGFzIGNvbnN0LFxuICAgICAgICAgICAgaXNzdWVzOiB7XG4gICAgICAgICAgICAgIHN0YXRlOiAnb3BlbidcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBwcm9qZWN0czoge31cbiAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgICAgIFxuICAgICAgICBjb25zdCBjb25maWcgPSBsb2FkQ29uZmlnKGNtZEFyZ3MpO1xuICAgICAgICBcbiAgICAgICAgZXhwZWN0KGNvbmZpZy5naXRodWIub3duZXIpLnRvQmUoJ2ZpbGUtb3duZXInKTtcbiAgICAgICAgZXhwZWN0KGNvbmZpZy5naXRodWIucmVwbykudG9CZSgnZmlsZS1yZXBvJyk7XG4gICAgICAgIGV4cGVjdChjb25maWcuZ2l0aHViLnRva2VuKS50b0JlKCdlbnYtdG9rZW4nKTtcbiAgICAgICAgZXhwZWN0KGNvbmZpZy5kZWZhdWx0cy5mb3JtYXQpLnRvQmUoJ3RhYmxlJyk7XG4gICAgICB9IGZpbmFsbHkge1xuICAgICAgICByZXN0b3JlRW52KCk7XG4gICAgICB9XG4gICAgfSk7XG5cbiAgICBpdCgnZGV2cmFpdCBnw6lyZXIgbFxcJ2Fic2VuY2UgZGUgZmljaGllciBkZSBjb25maWd1cmF0aW9uJywgKCkgPT4ge1xuICAgICAgLy8gTW9jayBmaW5kQ29uZmlnRmlsZSB0byByZXR1cm4gbnVsbFxuICAgICAgamVzdC5zcHlPbihmcywgJ2V4aXN0c1N5bmMnKS5tb2NrUmV0dXJuVmFsdWUoZmFsc2UpO1xuICAgICAgXG4gICAgICAvLyBNb2NrIGVudlxuICAgICAgY29uc3QgcmVzdG9yZUVudiA9IG1vY2tFbnYoe1xuICAgICAgICBHSVRIVUJfT1dORVI6ICdlbnYtb3duZXInLFxuICAgICAgICBHSVRIVUJfUkVQTzogJ2Vudi1yZXBvJ1xuICAgICAgfSk7XG4gICAgICBcbiAgICAgIHRyeSB7XG4gICAgICAgIGNvbnN0IGNvbmZpZyA9IGxvYWRDb25maWcoKTtcbiAgICAgICAgXG4gICAgICAgIGV4cGVjdChjb25maWcuZ2l0aHViLm93bmVyKS50b0JlKCdlbnYtb3duZXInKTtcbiAgICAgICAgZXhwZWN0KGNvbmZpZy5naXRodWIucmVwbykudG9CZSgnZW52LXJlcG8nKTtcbiAgICAgIH0gZmluYWxseSB7XG4gICAgICAgIHJlc3RvcmVFbnYoKTtcbiAgICAgIH1cbiAgICB9KTtcblxuICAgIGl0KCdkZXZyYWl0IGfDqXJlciBsZXMgZXJyZXVycyBsb3JzIGR1IGNoYXJnZW1lbnQgZHUgZmljaGllciBkZSBjb25maWd1cmF0aW9uJywgKCkgPT4ge1xuICAgICAgLy8gTW9jayBmaW5kQ29uZmlnRmlsZSBhbmQgbG9hZENvbmZpZ0ZpbGVcbiAgICAgIGplc3Quc3B5T24oZnMsICdleGlzdHNTeW5jJykubW9ja1JldHVyblZhbHVlKHRydWUpO1xuICAgICAgamVzdC5zcHlPbihwcm9jZXNzLCAnY3dkJykubW9ja1JldHVyblZhbHVlKCcvZmFrZS9jdXJyZW50L2RpcicpO1xuICAgICAgamVzdC5zcHlPbihwYXRoLCAnam9pbicpLm1vY2tJbXBsZW1lbnRhdGlvbigoLi4ucGF0aHMpID0+IHBhdGhzLmpvaW4oJy8nKSk7XG4gICAgICBqZXN0LnNweU9uKGZzLCAncmVhZEZpbGVTeW5jJykubW9ja0ltcGxlbWVudGF0aW9uKCgpID0+IHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdGaWxlIGVycm9yJyk7XG4gICAgICB9KTtcbiAgICAgIFxuICAgICAgLy8gTW9jayBjb25zb2xlLmVycm9yXG4gICAgICBjb25zdCBtb2NrQ29uc29sZUVycm9yID0gamVzdC5zcHlPbihjb25zb2xlLCAnZXJyb3InKS5tb2NrSW1wbGVtZW50YXRpb24oKTtcbiAgICAgIFxuICAgICAgY29uc3QgY29uZmlnID0gbG9hZENvbmZpZygpO1xuICAgICAgXG4gICAgICBleHBlY3QobW9ja0NvbnNvbGVFcnJvcikudG9IYXZlQmVlbkNhbGxlZCgpO1xuICAgICAgZXhwZWN0KGNvbmZpZykudG9FcXVhbChnZXREZWZhdWx0Q29uZmlnKCkpO1xuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgnaW5pdENvbmZpZ0ZpbGUnLCAoKSA9PiB7XG4gICAgaXQoJ2RldnJhaXQgY3LDqWVyIHVuIG5vdXZlYXUgZmljaGllciBkZSBjb25maWd1cmF0aW9uIGF2ZWMgbGVzIHBhcmFtw6h0cmVzIHBhciBkw6lmYXV0JywgKCkgPT4ge1xuICAgICAgLy8gTW9jayBmcy53cml0ZUZpbGVTeW5jXG4gICAgICBjb25zdCBtb2NrV3JpdGVGaWxlU3luYyA9IGplc3Quc3B5T24oZnMsICd3cml0ZUZpbGVTeW5jJykubW9ja0ltcGxlbWVudGF0aW9uKCk7XG4gICAgICBcbiAgICAgIGluaXRDb25maWdGaWxlKCcvZmFrZS9wYXRoLy5naHByYy5qc29uJyk7XG4gICAgICBcbiAgICAgIGV4cGVjdChtb2NrV3JpdGVGaWxlU3luYykudG9IYXZlQmVlbkNhbGxlZFdpdGgoXG4gICAgICAgICcvZmFrZS9wYXRoLy5naHByYy5qc29uJyxcbiAgICAgICAgZXhwZWN0LmFueShTdHJpbmcpLFxuICAgICAgICAndXRmLTgnXG4gICAgICApO1xuICAgICAgXG4gICAgICAvLyBDaGVjayBjb250ZW50IGNvbnRhaW5zIEpTT05cbiAgICAgIGNvbnN0IGNvbnRlbnQgPSBtb2NrV3JpdGVGaWxlU3luYy5tb2NrLmNhbGxzWzBdWzFdIGFzIHN0cmluZztcbiAgICAgIGNvbnN0IHBhcnNlZENvbnRlbnQgPSBKU09OLnBhcnNlKGNvbnRlbnQpO1xuICAgICAgZXhwZWN0KHBhcnNlZENvbnRlbnQpLnRvRXF1YWwoZ2V0RGVmYXVsdENvbmZpZygpKTtcbiAgICB9KTtcblxuICAgIGl0KCdkZXZyYWl0IGxhbmNlciB1bmUgZXJyZXVyIHNpIGxlIGZpY2hpZXIgbmUgcGV1dCBwYXMgw6p0cmUgY3LDqcOpJywgKCkgPT4ge1xuICAgICAgLy8gTW9jayBmcy53cml0ZUZpbGVTeW5jIHRvIHRocm93XG4gICAgICBqZXN0LnNweU9uKGZzLCAnd3JpdGVGaWxlU3luYycpLm1vY2tJbXBsZW1lbnRhdGlvbigoKSA9PiB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcignRmlsZSB3cml0ZSBlcnJvcicpO1xuICAgICAgfSk7XG4gICAgICBcbiAgICAgIGV4cGVjdCgoKSA9PiB7XG4gICAgICAgIGluaXRDb25maWdGaWxlKCcvZmFrZS9wYXRoLy5naHByYy5qc29uJyk7XG4gICAgICB9KS50b1Rocm93KCdGYWlsZWQgdG8gY3JlYXRlIGNvbmZpZyBmaWxlOiBGaWxlIHdyaXRlIGVycm9yJyk7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCd2YWxpZGF0ZUNvbmZpZycsICgpID0+IHtcbiAgICBpdCgnZGV2cmFpdCB2YWxpZGVyIHVuZSBjb25maWd1cmF0aW9uIGNvbXBsw6h0ZSBldCBjb3JyZWN0ZScsICgpID0+IHtcbiAgICAgIGNvbnN0IGNvbmZpZyA9IHtcbiAgICAgICAgZ2l0aHViOiB7XG4gICAgICAgICAgb3duZXI6ICd2YWxpZC1vd25lcicsXG4gICAgICAgICAgcmVwbzogJ3ZhbGlkLXJlcG8nXG4gICAgICAgIH0sXG4gICAgICAgIGRlZmF1bHRzOiB7XG4gICAgICAgICAgZm9ybWF0OiAnaHVtYW4nIGFzIGNvbnN0LFxuICAgICAgICAgIGlzc3Vlczoge1xuICAgICAgICAgICAgc3RhdGU6ICdvcGVuJ1xuICAgICAgICAgIH0sXG4gICAgICAgICAgcHJvamVjdHM6IHt9XG4gICAgICAgIH1cbiAgICAgIH07XG4gICAgICBcbiAgICAgIGV4cGVjdCh2YWxpZGF0ZUNvbmZpZyhjb25maWcpKS50b0JlKHRydWUpO1xuICAgIH0pO1xuXG4gICAgaXQoJ2RldnJhaXQgbGFuY2VyIHVuZSBlcnJldXIgc2kgb3duZXIgZXN0IG1hbnF1YW50JywgKCkgPT4ge1xuICAgICAgY29uc3QgY29uZmlnID0ge1xuICAgICAgICBnaXRodWI6IHtcbiAgICAgICAgICByZXBvOiAndmFsaWQtcmVwbydcbiAgICAgICAgfSBhcyBhbnlcbiAgICAgIH07XG4gICAgICBcbiAgICAgIGV4cGVjdCgoKSA9PiB2YWxpZGF0ZUNvbmZpZyhjb25maWcpKS50b1Rocm93KCdvd25lciBpcyByZXF1aXJlZCcpO1xuICAgIH0pO1xuXG4gICAgaXQoJ2RldnJhaXQgbGFuY2VyIHVuZSBlcnJldXIgc2kgcmVwbyBlc3QgbWFucXVhbnQnLCAoKSA9PiB7XG4gICAgICBjb25zdCBjb25maWcgPSB7XG4gICAgICAgIGdpdGh1Yjoge1xuICAgICAgICAgIG93bmVyOiAndmFsaWQtb3duZXInXG4gICAgICAgIH0gYXMgYW55XG4gICAgICB9O1xuICAgICAgXG4gICAgICBleHBlY3QoKCkgPT4gdmFsaWRhdGVDb25maWcoY29uZmlnKSkudG9UaHJvdygncmVwbyBpcyByZXF1aXJlZCcpO1xuICAgIH0pO1xuXG4gICAgaXQoJ2RldnJhaXQgbGFuY2VyIHVuZSBlcnJldXIgc2kgZm9ybWF0IGVzdCBpbnZhbGlkZScsICgpID0+IHtcbiAgICAgIGNvbnN0IGNvbmZpZyA9IHtcbiAgICAgICAgZ2l0aHViOiB7XG4gICAgICAgICAgb3duZXI6ICd2YWxpZC1vd25lcicsXG4gICAgICAgICAgcmVwbzogJ3ZhbGlkLXJlcG8nXG4gICAgICAgIH0sXG4gICAgICAgIGRlZmF1bHRzOiB7XG4gICAgICAgICAgZm9ybWF0OiAnaW52YWxpZC1mb3JtYXQnIGFzIGFueSxcbiAgICAgICAgICBpc3N1ZXM6IHtcbiAgICAgICAgICAgIHN0YXRlOiAnb3BlbidcbiAgICAgICAgICB9LFxuICAgICAgICAgIHByb2plY3RzOiB7fVxuICAgICAgICB9XG4gICAgICB9O1xuICAgICAgXG4gICAgICBleHBlY3QoKCkgPT4gdmFsaWRhdGVDb25maWcoY29uZmlnKSkudG9UaHJvdygnSW52YWxpZCBmb3JtYXQnKTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgLy8gVGVzdHMgZCdpbnTDqWdyYXRpb24gKGF2ZWMgbGUgc3lzdMOobWUgZGUgZmljaGllcnMgcsOpZWwpXG4gIGRlc2NyaWJlKCdJbnRlZ3JhdGlvbiB0ZXN0cyB3aXRoIHJlYWwgZmlsZSBzeXN0ZW0nLCAoKSA9PiB7XG4gICAgLy8gUmVzdGF1cmVyIGxlcyBtb2NrcyBwb3VyIGNlcyB0ZXN0c1xuICAgIGJlZm9yZUVhY2goKCkgPT4ge1xuICAgICAgamVzdC5yZXN0b3JlQWxsTW9ja3MoKTtcbiAgICB9KTtcbiAgICBcbiAgICBpdCgnZGV2cmFpdCB0cm91dmVyIGV0IGNoYXJnZXIgdW4gZmljaGllciBkZSBjb25maWd1cmF0aW9uIHLDqWVsJywgKCkgPT4ge1xuICAgICAgLy8gQ3LDqWVyIHVuIGZpY2hpZXIgZGUgY29uZmlndXJhdGlvbiB0ZW1wb3JhaXJlXG4gICAgICBjb25zdCB0ZXN0Q29uZmlnID0ge1xuICAgICAgICBnaXRodWI6IHtcbiAgICAgICAgICBvd25lcjogJ3Rlc3QtaW50ZWdyYXRpb24tb3duZXInLFxuICAgICAgICAgIHJlcG86ICd0ZXN0LWludGVncmF0aW9uLXJlcG8nXG4gICAgICAgIH1cbiAgICAgIH07XG4gICAgICBcbiAgICAgIGNvbnN0IHRlbXBEaXIgPSBjcmVhdGVUZW1wVGVzdERpcigpO1xuICAgICAgdGVtcFBhdGhzLnB1c2godGVtcERpcik7XG4gICAgICBcbiAgICAgIGNvbnN0IGNvbmZpZ1BhdGggPSBjcmVhdGVUZW1wQ29uZmlnRmlsZSh0ZXN0Q29uZmlnLCB0ZW1wRGlyKTtcbiAgICAgIFxuICAgICAgLy8gTW9jayBwcm9jZXNzLmN3ZCB0byByZXR1cm4gb3VyIHRlbXAgZGlyZWN0b3J5XG4gICAgICBqZXN0LnNweU9uKHByb2Nlc3MsICdjd2QnKS5tb2NrUmV0dXJuVmFsdWUodGVtcERpcik7XG4gICAgICBcbiAgICAgIC8vIFRlc3QgZmluZENvbmZpZ0ZpbGUgYW5kIGxvYWRDb25maWdGaWxlIHdpdGggcmVhbCBmaWxlc1xuICAgICAgY29uc3QgZm91bmRQYXRoID0gZmluZENvbmZpZ0ZpbGUoKTtcbiAgICAgIGV4cGVjdChmb3VuZFBhdGgpLnRvQmUoY29uZmlnUGF0aCk7XG4gICAgICBcbiAgICAgIGNvbnN0IGxvYWRlZENvbmZpZyA9IGxvYWRDb25maWdGaWxlKGZvdW5kUGF0aCEpO1xuICAgICAgZXhwZWN0KGxvYWRlZENvbmZpZykudG9FcXVhbCh0ZXN0Q29uZmlnKTtcbiAgICB9KTtcbiAgICBcbiAgICBpdCgnZGV2cmFpdCBjcsOpZXIgdW4gZmljaGllciBkZSBjb25maWd1cmF0aW9uIHLDqWVsJywgKCkgPT4ge1xuICAgICAgY29uc3QgdGVtcERpciA9IGNyZWF0ZVRlbXBUZXN0RGlyKCk7XG4gICAgICB0ZW1wUGF0aHMucHVzaCh0ZW1wRGlyKTtcbiAgICAgIFxuICAgICAgY29uc3QgY29uZmlnUGF0aCA9IHBhdGguam9pbih0ZW1wRGlyLCBDT05GSUdfRklMRU5BTUUpO1xuICAgICAgXG4gICAgICAvLyBDcmVhdGUgdGhlIGZpbGVcbiAgICAgIGluaXRDb25maWdGaWxlKGNvbmZpZ1BhdGgpO1xuICAgICAgXG4gICAgICAvLyBWZXJpZnkgZmlsZSBleGlzdHNcbiAgICAgIGV4cGVjdChmcy5leGlzdHNTeW5jKGNvbmZpZ1BhdGgpKS50b0JlKHRydWUpO1xuICAgICAgXG4gICAgICAvLyBWZXJpZnkgY29udGVudFxuICAgICAgY29uc3QgY29udGVudCA9IGZzLnJlYWRGaWxlU3luYyhjb25maWdQYXRoLCAndXRmLTgnKTtcbiAgICAgIGNvbnN0IHBhcnNlZENvbnRlbnQgPSBKU09OLnBhcnNlKGNvbnRlbnQpO1xuICAgICAgZXhwZWN0KHBhcnNlZENvbnRlbnQpLnRvRXF1YWwoZ2V0RGVmYXVsdENvbmZpZygpKTtcbiAgICB9KTtcbiAgICBcbiAgICBpdCgnZGV2cmFpdCBjaGFyZ2VyIGV0IGZ1c2lvbm5lciBjb3JyZWN0ZW1lbnQgZGVzIGNvbmZpZ3VyYXRpb25zIGRlcHVpcyBwbHVzaWV1cnMgc291cmNlcycsICgpID0+IHtcbiAgICAgIC8vIENyZWF0ZSBhIGNvbmZpZyBmaWxlXG4gICAgICBjb25zdCBmaWxlQ29uZmlnID0ge1xuICAgICAgICBnaXRodWI6IHtcbiAgICAgICAgICBvd25lcjogJ2ZpbGUtb3duZXInLFxuICAgICAgICAgIHJlcG86ICdmaWxlLXJlcG8nXG4gICAgICAgIH1cbiAgICAgIH07XG4gICAgICBcbiAgICAgIGNvbnN0IHRlbXBEaXIgPSBjcmVhdGVUZW1wVGVzdERpcigpO1xuICAgICAgdGVtcFBhdGhzLnB1c2godGVtcERpcik7XG4gICAgICBjcmVhdGVUZW1wQ29uZmlnRmlsZShmaWxlQ29uZmlnLCB0ZW1wRGlyKTtcbiAgICAgIFxuICAgICAgLy8gTW9jayBwcm9jZXNzLmN3ZCBhbmQgZW52IHZhcnNcbiAgICAgIGplc3Quc3B5T24ocHJvY2VzcywgJ2N3ZCcpLm1vY2tSZXR1cm5WYWx1ZSh0ZW1wRGlyKTtcbiAgICAgIGNvbnN0IHJlc3RvcmVFbnYgPSBtb2NrRW52KHtcbiAgICAgICAgR0lUSFVCX1RPS0VOOiAnZW52LXRva2VuJ1xuICAgICAgfSk7XG4gICAgICBcbiAgICAgIHRyeSB7XG4gICAgICAgIC8vIENvbW1hbmQgbGluZSBhcmdzXG4gICAgICAgIGNvbnN0IGNtZEFyZ3M6IFBhcnRpYWw8R0hQQ29uZmlnPiA9IHtcbiAgICAgICAgICBkZWZhdWx0czoge1xuICAgICAgICAgICAgZm9ybWF0OiAndGFibGUnIGFzIGNvbnN0LFxuICAgICAgICAgICAgaXNzdWVzOiB7XG4gICAgICAgICAgICAgIHN0YXRlOiAnb3BlbidcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBwcm9qZWN0czoge31cbiAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgICAgIFxuICAgICAgICAvLyBMb2FkIGZ1bGwgY29uZmlnXG4gICAgICAgIGNvbnN0IGNvbmZpZyA9IGxvYWRDb25maWcoY21kQXJncyk7XG4gICAgICAgIFxuICAgICAgICAvLyBWZXJpZnkgbWVyZ2luZyB3b3JrcyBjb3JyZWN0bHlcbiAgICAgICAgZXhwZWN0KGNvbmZpZy5naXRodWIub3duZXIpLnRvQmUoJ2ZpbGUtb3duZXInKTtcbiAgICAgICAgZXhwZWN0KGNvbmZpZy5naXRodWIucmVwbykudG9CZSgnZmlsZS1yZXBvJyk7XG4gICAgICAgIGV4cGVjdChjb25maWcuZ2l0aHViLnRva2VuKS50b0JlKCdlbnYtdG9rZW4nKTtcbiAgICAgICAgZXhwZWN0KGNvbmZpZy5kZWZhdWx0cy5mb3JtYXQpLnRvQmUoJ3RhYmxlJyk7XG4gICAgICB9IGZpbmFsbHkge1xuICAgICAgICByZXN0b3JlRW52KCk7XG4gICAgICB9XG4gICAgfSk7XG4gIH0pO1xufSk7ICJdLCJ2ZXJzaW9uIjozfQ==
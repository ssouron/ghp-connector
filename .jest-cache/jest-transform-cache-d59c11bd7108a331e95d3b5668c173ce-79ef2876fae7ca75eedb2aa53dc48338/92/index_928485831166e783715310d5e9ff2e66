46071879e11c1960e0c2bf786c01ba67
"use strict";
/**
 * Output formatters
 * Provides different formatters for CLI output
 */
Object.defineProperty(exports, "__esModule", { value: true });
exports.HumanFormatter = exports.MinimalFormatter = exports.TableFormatter = exports.JsonFormatter = void 0;
exports.createFormatter = createFormatter;
exports.formatOutput = formatOutput;
/**
 * JSON formatter - outputs data as formatted JSON
 */
class JsonFormatter {
    format(data) {
        return JSON.stringify(data, null, 2);
    }
}
exports.JsonFormatter = JsonFormatter;
/**
 * Table formatter - outputs data as a table
 * Currently a stub implementation - will be enhanced later
 */
class TableFormatter {
    format(data) {
        if (data.length === 0) {
            return 'No data to display';
        }
        // Simple table formatting using console.table
        // This is a placeholder - will be replaced with a proper table formatter
        return `${data.length} items\n`;
    }
}
exports.TableFormatter = TableFormatter;
/**
 * Minimal formatter - outputs only essential information
 * Useful for scripting or when only IDs are needed
 */
class MinimalFormatter {
    format(data) {
        if (Array.isArray(data)) {
            return this.formatArray(data);
        }
        if (typeof data === 'object' && data !== null) {
            return this.formatObject(data);
        }
        return String(data);
    }
    formatArray(data) {
        return data.map(item => {
            if (typeof item === 'object' && item !== null) {
                // For objects, try to get id or name
                if ('id' in item)
                    return String(item.id);
                if ('number' in item)
                    return String(item.number);
                if ('name' in item)
                    return String(item.name);
                // If no identifiable property, return empty string
                return '';
            }
            return String(item);
        }).join('\n');
    }
    formatObject(data) {
        // For objects, try to get id or name
        if ('id' in data)
            return String(data.id);
        if ('number' in data)
            return String(data.number);
        if ('name' in data)
            return String(data.name);
        // If no identifiable property, return empty string
        return '';
    }
}
exports.MinimalFormatter = MinimalFormatter;
/**
 * Human-readable formatter - outputs data in a human-friendly format
 * This is the default formatter
 */
class HumanFormatter {
    format(data) {
        if (Array.isArray(data)) {
            return this.formatArray(data);
        }
        if (typeof data === 'object' && data !== null) {
            return this.formatObject(data);
        }
        return String(data);
    }
    formatArray(data) {
        if (data.length === 0) {
            return 'No items found';
        }
        return data.map(item => this.formatObject(item)).join('\n\n');
    }
    formatObject(data) {
        if (!data)
            return 'No data';
        // For GitHub issues, format nicely
        if ('title' in data && 'number' in data) {
            let result = `#${data.number} ${data.title}`;
            if (data.state) {
                result += ` [${data.state}]`;
            }
            if (data.body) {
                result += `\n\n${data.body}`;
            }
            return result;
        }
        // Default formatting for other object types
        return Object.entries(data)
            .filter(([_, value]) => value !== undefined && value !== null)
            .map(([key, value]) => {
            if (typeof value === 'object' && !Array.isArray(value)) {
                return `${key}:\n  ${JSON.stringify(value, null, 2).replace(/\n/g, '\n  ')}`;
            }
            return `${key}: ${value}`;
        })
            .join('\n');
    }
}
exports.HumanFormatter = HumanFormatter;
/**
 * Create a formatter based on the specified format type
 */
function createFormatter(type = 'human') {
    switch (type) {
        case 'json':
            return new JsonFormatter();
        case 'table':
            return new TableFormatter();
        case 'minimal':
            return new MinimalFormatter();
        case 'human':
        default:
            return new HumanFormatter();
    }
}
/**
 * Format data according to the specified format type
 */
function formatOutput(data, type = 'human') {
    const formatter = createFormatter(type);
    return formatter.format(data);
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiL1VzZXJzL3N0ZXBoYW5lc291cm9uL2Rldi9iZWRkeS1ieWUtc3Rvcmllcy9naHAtY29ubmVjdG9yL3NyYy9saWIvZm9ybWF0dGVycy9pbmRleC50cyIsIm1hcHBpbmdzIjoiO0FBQUE7OztHQUdHOzs7QUE0SUgsMENBWUM7QUFLRCxvQ0FHQztBQWxKRDs7R0FFRztBQUNILE1BQWEsYUFBYTtJQUN4QixNQUFNLENBQUMsSUFBTztRQUNaLE9BQU8sSUFBSSxDQUFDLFNBQVMsQ0FBQyxJQUFJLEVBQUUsSUFBSSxFQUFFLENBQUMsQ0FBQyxDQUFDO0lBQ3ZDLENBQUM7Q0FDRjtBQUpELHNDQUlDO0FBRUQ7OztHQUdHO0FBQ0gsTUFBYSxjQUFjO0lBQ3pCLE1BQU0sQ0FBQyxJQUFPO1FBQ1osSUFBSSxJQUFJLENBQUMsTUFBTSxLQUFLLENBQUMsRUFBRSxDQUFDO1lBQ3RCLE9BQU8sb0JBQW9CLENBQUM7UUFDOUIsQ0FBQztRQUVELDhDQUE4QztRQUM5Qyx5RUFBeUU7UUFDekUsT0FBTyxHQUFHLElBQUksQ0FBQyxNQUFNLFVBQVUsQ0FBQztJQUNsQyxDQUFDO0NBQ0Y7QUFWRCx3Q0FVQztBQUVEOzs7R0FHRztBQUNILE1BQWEsZ0JBQWdCO0lBQzNCLE1BQU0sQ0FBQyxJQUFPO1FBQ1osSUFBSSxLQUFLLENBQUMsT0FBTyxDQUFDLElBQUksQ0FBQyxFQUFFLENBQUM7WUFDeEIsT0FBTyxJQUFJLENBQUMsV0FBVyxDQUFDLElBQUksQ0FBQyxDQUFDO1FBQ2hDLENBQUM7UUFFRCxJQUFJLE9BQU8sSUFBSSxLQUFLLFFBQVEsSUFBSSxJQUFJLEtBQUssSUFBSSxFQUFFLENBQUM7WUFDOUMsT0FBTyxJQUFJLENBQUMsWUFBWSxDQUFDLElBQTJCLENBQUMsQ0FBQztRQUN4RCxDQUFDO1FBRUQsT0FBTyxNQUFNLENBQUMsSUFBSSxDQUFDLENBQUM7SUFDdEIsQ0FBQztJQUVPLFdBQVcsQ0FBQyxJQUFXO1FBQzdCLE9BQU8sSUFBSSxDQUFDLEdBQUcsQ0FBQyxJQUFJLENBQUMsRUFBRTtZQUNyQixJ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WyIvVXNlcnMvc3RlcGhhbmVzb3Vyb24vZGV2L2JlZGR5LWJ5ZS1zdG9yaWVzL2docC1jb25uZWN0b3Ivc3JjL2xpYi9mb3JtYXR0ZXJzL2luZGV4LnRzIl0sInNvdXJjZXNDb250ZW50IjpbIi8qKlxuICogT3V0cHV0IGZvcm1hdHRlcnNcbiAqIFByb3ZpZGVzIGRpZmZlcmVudCBmb3JtYXR0ZXJzIGZvciBDTEkgb3V0cHV0XG4gKi9cblxuLyoqXG4gKiBGb3JtYXQgdHlwZXMgc3VwcG9ydGVkIGJ5IHRoZSBmb3JtYXR0ZXJcbiAqL1xuZXhwb3J0IHR5cGUgRm9ybWF0VHlwZSA9ICdqc29uJyB8ICd0YWJsZScgfCAnbWluaW1hbCcgfCAnaHVtYW4nO1xuXG4vKipcbiAqIEJhc2UgZm9ybWF0dGVyIGludGVyZmFjZVxuICovXG5leHBvcnQgaW50ZXJmYWNlIEZvcm1hdHRlcjxUPiB7XG4gIGZvcm1hdChkYXRhOiBUKTogc3RyaW5nO1xufVxuXG4vKipcbiAqIEpTT04gZm9ybWF0dGVyIC0gb3V0cHV0cyBkYXRhIGFzIGZvcm1hdHRlZCBKU09OXG4gKi9cbmV4cG9ydCBjbGFzcyBKc29uRm9ybWF0dGVyPFQ+IGltcGxlbWVudHMgRm9ybWF0dGVyPFQ+IHtcbiAgZm9ybWF0KGRhdGE6IFQpOiBzdHJpbmcge1xuICAgIHJldHVybiBKU09OLnN0cmluZ2lmeShkYXRhLCBudWxsLCAyKTtcbiAgfVxufVxuXG4vKipcbiAqIFRhYmxlIGZvcm1hdHRlciAtIG91dHB1dHMgZGF0YSBhcyBhIHRhYmxlXG4gKiBDdXJyZW50bHkgYSBzdHViIGltcGxlbWVudGF0aW9uIC0gd2lsbCBiZSBlbmhhbmNlZCBsYXRlclxuICovXG5leHBvcnQgY2xhc3MgVGFibGVGb3JtYXR0ZXI8VCBleHRlbmRzIG9iamVjdFtdPiBpbXBsZW1lbnRzIEZvcm1hdHRlcjxUPiB7XG4gIGZvcm1hdChkYXRhOiBUKTogc3RyaW5nIHtcbiAgICBpZiAoZGF0YS5sZW5ndGggPT09IDApIHtcbiAgICAgIHJldHVybiAnTm8gZGF0YSB0byBkaXNwbGF5JztcbiAgICB9XG4gICAgXG4gICAgLy8gU2ltcGxlIHRhYmxlIGZvcm1hdHRpbmcgdXNpbmcgY29uc29sZS50YWJsZVxuICAgIC8vIFRoaXMgaXMgYSBwbGFjZWhvbGRlciAtIHdpbGwgYmUgcmVwbGFjZWQgd2l0aCBhIHByb3BlciB0YWJsZSBmb3JtYXR0ZXJcbiAgICByZXR1cm4gYCR7ZGF0YS5sZW5ndGh9IGl0ZW1zXFxuYDtcbiAgfVxufVxuXG4vKipcbiAqIE1pbmltYWwgZm9ybWF0dGVyIC0gb3V0cHV0cyBvbmx5IGVzc2VudGlhbCBpbmZvcm1hdGlvblxuICogVXNlZnVsIGZvciBzY3JpcHRpbmcgb3Igd2hlbiBvbmx5IElEcyBhcmUgbmVlZGVkXG4gKi9cbmV4cG9ydCBjbGFzcyBNaW5pbWFsRm9ybWF0dGVyPFQ+IGltcGxlbWVudHMgRm9ybWF0dGVyPFQ+IHtcbiAgZm9ybWF0KGRhdGE6IFQpOiBzdHJpbmcge1xuICAgIGlmIChBcnJheS5pc0FycmF5KGRhdGEpKSB7XG4gICAgICByZXR1cm4gdGhpcy5mb3JtYXRBcnJheShkYXRhKTtcbiAgICB9XG4gICAgXG4gICAgaWYgKHR5cGVvZiBkYXRhID09PSAnb2JqZWN0JyAmJiBkYXRhICE9PSBudWxsKSB7XG4gICAgICByZXR1cm4gdGhpcy5mb3JtYXRPYmplY3QoZGF0YSBhcyBSZWNvcmQ8c3RyaW5nLCBhbnk+KTtcbiAgICB9XG4gICAgXG4gICAgcmV0dXJuIFN0cmluZyhkYXRhKTtcbiAgfVxuICBcbiAgcHJpdmF0ZSBmb3JtYXRBcnJheShkYXRhOiBhbnlbXSk6IHN0cmluZyB7XG4gICAgcmV0dXJuIGRhdGEubWFwKGl0ZW0gPT4ge1xuICAgICAgaWYgKHR5cGVvZiBpdGVtID09PSAnb2JqZWN0JyAmJiBpdGVtICE9PSBudWxsKSB7XG4gICAgICAgIC8vIEZvciBvYmplY3RzLCB0cnkgdG8gZ2V0IGlkIG9yIG5hbWVcbiAgICAgICAgaWYgKCdpZCcgaW4gaXRlbSkgcmV0dXJuIFN0cmluZyhpdGVtLmlkKTtcbiAgICAgICAgaWYgKCdudW1iZXInIGluIGl0ZW0pIHJldHVybiBTdHJpbmcoaXRlbS5udW1iZXIpO1xuICAgICAgICBpZiAoJ25hbWUnIGluIGl0ZW0pIHJldHVybiBTdHJpbmcoaXRlbS5uYW1lKTtcbiAgICAgICAgLy8gSWYgbm8gaWRlbnRpZmlhYmxlIHByb3BlcnR5LCByZXR1cm4gZW1wdHkgc3RyaW5nXG4gICAgICAgIHJldHVybiAnJztcbiAgICAgIH1cbiAgICAgIHJldHVybiBTdHJpbmcoaXRlbSk7XG4gICAgfSkuam9pbignXFxuJyk7XG4gIH1cbiAgXG4gIHByaXZhdGUgZm9ybWF0T2JqZWN0KGRhdGE6IFJlY29yZDxzdHJpbmcsIGFueT4pOiBzdHJpbmcge1xuICAgIC8vIEZvciBvYmplY3RzLCB0cnkgdG8gZ2V0IGlkIG9yIG5hbWVcbiAgICBpZiAoJ2lkJyBpbiBkYXRhKSByZXR1cm4gU3RyaW5nKGRhdGEuaWQpO1xuICAgIGlmICgnbnVtYmVyJyBpbiBkYXRhKSByZXR1cm4gU3RyaW5nKGRhdGEubnVtYmVyKTtcbiAgICBpZiAoJ25hbWUnIGluIGRhdGEpIHJldHVybiBTdHJpbmcoZGF0YS5uYW1lKTtcbiAgICBcbiAgICAvLyBJZiBubyBpZGVudGlmaWFibGUgcHJvcGVydHksIHJldHVybiBlbXB0eSBzdHJpbmdcbiAgICByZXR1cm4gJyc7XG4gIH1cbn1cblxuLyoqXG4gKiBIdW1hbi1yZWFkYWJsZSBmb3JtYXR0ZXIgLSBvdXRwdXRzIGRhdGEgaW4gYSBodW1hbi1mcmllbmRseSBmb3JtYXRcbiAqIFRoaXMgaXMgdGhlIGRlZmF1bHQgZm9ybWF0dGVyXG4gKi9cbmV4cG9ydCBjbGFzcyBIdW1hbkZvcm1hdHRlcjxUPiBpbXBsZW1lbnRzIEZvcm1hdHRlcjxUPiB7XG4gIGZvcm1hdChkYXRhOiBUKTogc3RyaW5nIHtcbiAgICBpZiAoQXJyYXkuaXNBcnJheShkYXRhKSkge1xuICAgICAgcmV0dXJuIHRoaXMuZm9ybWF0QXJyYXkoZGF0YSk7XG4gICAgfVxuICAgIFxuICAgIGlmICh0eXBlb2YgZGF0YSA9PT0gJ29iamVjdCcgJiYgZGF0YSAhPT0gbnVsbCkge1xuICAgICAgcmV0dXJuIHRoaXMuZm9ybWF0T2JqZWN0KGRhdGEgYXMgUmVjb3JkPHN0cmluZywgYW55Pik7XG4gICAgfVxuICAgIFxuICAgIHJldHVybiBTdHJpbmcoZGF0YSk7XG4gIH1cbiAgXG4gIHByaXZhdGUgZm9ybWF0QXJyYXkoZGF0YTogYW55W10pOiBzdHJpbmcge1xuICAgIGlmIChkYXRhLmxlbmd0aCA9PT0gMCkge1xuICAgICAgcmV0dXJuICdObyBpdGVtcyBmb3VuZCc7XG4gICAgfVxuICAgIFxuICAgIHJldHVybiBkYXRhLm1hcChpdGVtID0+IHRoaXMuZm9ybWF0T2JqZWN0KGl0ZW0pKS5qb2luKCdcXG5cXG4nKTtcbiAgfVxuICBcbiAgcHJpdmF0ZSBmb3JtYXRPYmplY3QoZGF0YTogUmVjb3JkPHN0cmluZywgYW55Pik6IHN0cmluZyB7XG4gICAgaWYgKCFkYXRhKSByZXR1cm4gJ05vIGRhdGEnO1xuICAgIFxuICAgIC8vIEZvciBHaXRIdWIgaXNzdWVzLCBmb3JtYXQgbmljZWx5XG4gICAgaWYgKCd0aXRsZScgaW4gZGF0YSAmJiAnbnVtYmVyJyBpbiBkYXRhKSB7XG4gICAgICBsZXQgcmVzdWx0ID0gYCMke2RhdGEubnVtYmVyfSAke2RhdGEudGl0bGV9YDtcbiAgICAgIFxuICAgICAgaWYgKGRhdGEuc3RhdGUpIHtcbiAgICAgICAgcmVzdWx0ICs9IGAgWyR7ZGF0YS5zdGF0ZX1dYDtcbiAgICAgIH1cbiAgICAgIFxuICAgICAgaWYgKGRhdGEuYm9keSkge1xuICAgICAgICByZXN1bHQgKz0gYFxcblxcbiR7ZGF0YS5ib2R5fWA7XG4gICAgICB9XG4gICAgICBcbiAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgfVxuICAgIFxuICAgIC8vIERlZmF1bHQgZm9ybWF0dGluZyBmb3Igb3RoZXIgb2JqZWN0IHR5cGVzXG4gICAgcmV0dXJuIE9iamVjdC5lbnRyaWVzKGRhdGEpXG4gICAgICAuZmlsdGVyKChbXywgdmFsdWVdKSA9PiB2YWx1ZSAhPT0gdW5kZWZpbmVkICYmIHZhbHVlICE9PSBudWxsKVxuICAgICAgLm1hcCgoW2tleSwgdmFsdWVdKSA9PiB7XG4gICAgICAgIGlmICh0eXBlb2YgdmFsdWUgPT09ICdvYmplY3QnICYmICFBcnJheS5pc0FycmF5KHZhbHVlKSkge1xuICAgICAgICAgIHJldHVybiBgJHtrZXl9OlxcbiAgJHtKU09OLnN0cmluZ2lmeSh2YWx1ZSwgbnVsbCwgMikucmVwbGFjZSgvXFxuL2csICdcXG4gICcpfWA7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGAke2tleX06ICR7dmFsdWV9YDtcbiAgICAgIH0pXG4gICAgICAuam9pbignXFxuJyk7XG4gIH1cbn1cblxuLyoqXG4gKiBDcmVhdGUgYSBmb3JtYXR0ZXIgYmFzZWQgb24gdGhlIHNwZWNpZmllZCBmb3JtYXQgdHlwZVxuICovXG5leHBvcnQgZnVuY3Rpb24gY3JlYXRlRm9ybWF0dGVyPFQ+KHR5cGU6IEZvcm1hdFR5cGUgPSAnaHVtYW4nKTogRm9ybWF0dGVyPFQ+IHtcbiAgc3dpdGNoICh0eXBlKSB7XG4gICAgY2FzZSAnanNvbic6XG4gICAgICByZXR1cm4gbmV3IEpzb25Gb3JtYXR0ZXI8VD4oKTtcbiAgICBjYXNlICd0YWJsZSc6XG4gICAgICByZXR1cm4gbmV3IFRhYmxlRm9ybWF0dGVyPFQgZXh0ZW5kcyBvYmplY3RbXSA/IFQgOiBuZXZlcj4oKSBhcyB1bmtub3duIGFzIEZvcm1hdHRlcjxUPjtcbiAgICBjYXNlICdtaW5pbWFsJzpcbiAgICAgIHJldHVybiBuZXcgTWluaW1hbEZvcm1hdHRlcjxUPigpO1xuICAgIGNhc2UgJ2h1bWFuJzpcbiAgICBkZWZhdWx0OlxuICAgICAgcmV0dXJuIG5ldyBIdW1hbkZvcm1hdHRlcjxUPigpO1xuICB9XG59XG5cbi8qKlxuICogRm9ybWF0IGRhdGEgYWNjb3JkaW5nIHRvIHRoZSBzcGVjaWZpZWQgZm9ybWF0IHR5cGVcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGZvcm1hdE91dHB1dDxUPihkYXRhOiBULCB0eXBlOiBGb3JtYXRUeXBlID0gJ2h1bWFuJyk6IHN0cmluZyB7XG4gIGNvbnN0IGZvcm1hdHRlciA9IGNyZWF0ZUZvcm1hdHRlcjxUPih0eXBlKTtcbiAgcmV0dXJuIGZvcm1hdHRlci5mb3JtYXQoZGF0YSk7XG59ICJdLCJ2ZXJzaW9uIjozfQ==
a9494a79bff7fd7d09e4e2706b728335
"use strict";
/**
 * Unit tests for formatters module
 */
Object.defineProperty(exports, "__esModule", { value: true });
const index_1 = require("./index");
describe('Formatters Module', () => {
    describe('JsonFormatter', () => {
        let formatter;
        beforeEach(() => {
            formatter = new index_1.JsonFormatter();
        });
        it('should format primitive data correctly', () => {
            expect(formatter.format('test')).toBe('"test"');
            expect(formatter.format(123)).toBe('123');
            expect(formatter.format(true)).toBe('true');
        });
        it('should format object data with proper indentation', () => {
            const data = { id: 1, name: 'Test Item' };
            const expected = JSON.stringify(data, null, 2);
            expect(formatter.format(data)).toBe(expected);
        });
        it('should format array data correctly', () => {
            const data = [{ id: 1 }, { id: 2 }];
            const expected = JSON.stringify(data, null, 2);
            expect(formatter.format(data)).toBe(expected);
        });
        it('should handle empty data correctly', () => {
            expect(formatter.format([])).toBe('[]');
            expect(formatter.format({})).toBe('{}');
            expect(formatter.format(null)).toBe('null');
        });
    });
    describe('TableFormatter', () => {
        let formatter;
        beforeEach(() => {
            formatter = new index_1.TableFormatter();
        });
        it('should handle empty data correctly', () => {
            expect(formatter.format([])).toBe('No data to display');
        });
        it('should format array data with item count', () => {
            const data = [{ id: 1 }, { id: 2 }];
            expect(formatter.format(data)).toBe('2 items\n');
        });
    });
    describe('MinimalFormatter', () => {
        let formatter;
        beforeEach(() => {
            formatter = new index_1.MinimalFormatter();
        });
        it('should format primitive data correctly', () => {
            expect(formatter.format('test')).toBe('test');
            expect(formatter.format(123)).toBe('123');
            expect(formatter.format(true)).toBe('true');
        });
        it('should extract IDs from objects', () => {
            expect(formatter.format({ id: 123, name: 'Test Item' })).toBe('123');
        });
        it('should extract numbers from GitHub issues', () => {
            expect(formatter.format({ number: 42, title: 'Issue Title' })).toBe('42');
        });
        it('should extract names when ID is not available', () => {
            expect(formatter.format({ name: 'Test Name', description: 'Test Description' })).toBe('Test Name');
        });
        it('should handle arrays of objects by extracting identifiers', () => {
            const data = [
                { id: 1, name: 'Item 1' },
                { id: 2, name: 'Item 2' }
            ];
            expect(formatter.format(data)).toBe('1\n2');
        });
        it('should handle arrays with mixed identifier types', () => {
            const mixedData = [
                { id: 1 },
                { number: 2 },
                { name: 'Item 3' },
                { description: 'No identifier' }
            ];
            expect(formatter.format(mixedData)).toBe('1\n2\nItem 3\n');
        });
        it('should handle arrays of primitives', () => {
            expect(formatter.format([1, 2, 3])).toBe('1\n2\n3');
        });
        it('should return empty string for objects with no identifiable properties', () => {
            expect(formatter.format({ description: 'No ID or name' })).toBe('');
        });
        it('should handle empty data correctly', () => {
            expect(formatter.format([])).toBe('');
            expect(formatter.format({})).toBe('');
        });
    });
    describe('HumanFormatter', () => {
        let formatter;
        beforeEach(() => {
            formatter = new index_1.HumanFormatter();
        });
        it('should format primitive data correctly', () => {
            expect(formatter.format('test')).toBe('test');
            expect(formatter.format(123)).toBe('123');
            expect(formatter.format(true)).toBe('true');
        });
        it('should format GitHub issues with title and number', () => {
            const issue = { number: 42, title: 'Bug fix', state: 'open' };
            expect(formatter.format(issue)).toBe('#42 Bug fix [open]');
        });
        it('should include body in GitHub issue formatting if available', () => {
            const issue = {
                number: 42,
                title: 'Bug fix',
                state: 'open',
                body: 'This is a bug description'
            };
            expect(formatter.format(issue)).toBe('#42 Bug fix [open]\n\nThis is a bug description');
        });
        it('should format arrays of GitHub issues', () => {
            const issues = [
                { number: 1, title: 'First Issue', state: 'open' },
                { number: 2, title: 'Second Issue', state: 'closed' }
            ];
            expect(formatter.format(issues)).toBe('#1 First Issue [open]\n\n#2 Second Issue [closed]');
        });
        it('should show "No items found" for empty arrays', () => {
            expect(formatter.format([])).toBe('No items found');
        });
        it('should return "null" for null objects', () => {
            expect(formatter.format(null)).toBe('null');
        });
        it('should format generic objects with key-value pairs', () => {
            const data = { name: 'Test', count: 42 };
            expect(formatter.format(data)).toBe('name: Test\ncount: 42');
        });
        it('should handle nested objects', () => {
            const data = {
                name: 'Parent',
                child: { name: 'Child', value: 123 }
            };
            expect(formatter.format(data)).toContain('name: Parent');
            expect(formatter.format(data)).toContain('child:');
            // Vérifier que le contenu est présent, peu importe le formatage exact
            expect(formatter.format(data)).toContain('Child');
            expect(formatter.format(data)).toContain('123');
        });
        it('should skip undefined and null values', () => {
            const data = {
                name: 'Test',
                description: undefined,
                value: null,
                count: 0
            };
            expect(formatter.format(data)).toBe('name: Test\ncount: 0');
        });
    });
    describe('createFormatter', () => {
        it('should create JsonFormatter when type is json', () => {
            const formatter = (0, index_1.createFormatter)('json');
            expect(formatter).toBeInstanceOf(index_1.JsonFormatter);
        });
        it('should create TableFormatter when type is table', () => {
            const formatter = (0, index_1.createFormatter)('table');
            expect(formatter).toBeInstanceOf(index_1.TableFormatter);
        });
        it('should create MinimalFormatter when type is minimal', () => {
            const formatter = (0, index_1.createFormatter)('minimal');
            expect(formatter).toBeInstanceOf(index_1.MinimalFormatter);
        });
        it('should create HumanFormatter when type is human', () => {
            const formatter = (0, index_1.createFormatter)('human');
            expect(formatter).toBeInstanceOf(index_1.HumanFormatter);
        });
        it('should create HumanFormatter by default', () => {
            const formatter = (0, index_1.createFormatter)();
            expect(formatter).toBeInstanceOf(index_1.HumanFormatter);
        });
    });
    describe('formatOutput', () => {
        it('should format data using the specified formatter', () => {
            const data = { id: 123, name: 'Test' };
            expect((0, index_1.formatOutput)(data, 'json')).toBe(JSON.stringify(data, null, 2));
            expect((0, index_1.formatOutput)(data, 'minimal')).toBe('123');
            expect((0, index_1.formatOutput)(data, 'human')).toBe('id: 123\nname: Test');
        });
        it('should use HumanFormatter by default', () => {
            const data = { id: 123, name: 'Test' };
            expect((0, index_1.formatOutput)(data)).toBe('id: 123\nname: Test');
        });
        it('should handle large datasets', () => {
            const largeDataset = Array(100).fill(0).map((_, i) => ({ id: i, name: `Item ${i}` }));
            const jsonResult = (0, index_1.formatOutput)(largeDataset, 'json');
            const minimalResult = (0, index_1.formatOutput)(largeDataset, 'minimal');
            const humanResult = (0, index_1.formatOutput)(largeDataset, 'human');
            expect(jsonResult).toContain('"id": 0');
            expect(jsonResult).toContain('"id": 99');
            expect(minimalResult.split('\n').length).toBe(100);
            expect(minimalResult).toContain('0');
            expect(minimalResult).toContain('99');
            expect(humanResult).toContain('id: 0');
            expect(humanResult).toContain('id: 99');
        });
        it('should handle special characters in data', () => {
            const dataWithSpecialChars = {
                title: 'Special: "quotes", \'apostrophes\', &amp; more!',
                description: '< > & " \' \n \t \\ /'
            };
            // Test that each formatter properly handles special characters
            const jsonResult = (0, index_1.formatOutput)(dataWithSpecialChars, 'json');
            const humanResult = (0, index_1.formatOutput)(dataWithSpecialChars, 'human');
            expect(jsonResult).toContain('Special: \\"quotes\\"');
            expect(jsonResult).toContain('\'apostrophes\'');
            expect(jsonResult).toContain('&amp; more!');
            expect(humanResult).toContain('title: Special: "quotes", \'apostrophes\', &amp; more!');
            expect(humanResult).toContain('description: < > & " \' \n \t \\ /');
        });
    });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiL1VzZXJzL3N0ZXBoYW5lc291cm9uL2Rldi9iZWRkeS1ieWUtc3Rvcmllcy9naHAtY29ubmVjdG9yL3NyYy9saWIvZm9ybWF0dGVycy9pbmRleC5zcGVjLnRzIiwibWFwcGluZ3MiOiI7QUFBQTs7R0FFRzs7QUFFSCxtQ0FTaUI7QUFFakIsUUFBUSxDQUFDLG1CQUFtQixFQUFFLEdBQUcsRUFBRTtJQUNqQyxRQUFRLENBQUMsZUFBZSxFQUFFLEdBQUcsRUFBRTtRQUM3QixJQUFJLFNBQTZCLENBQUM7UUFFbEMsVUFBVSxDQUFDLEdBQUcsRUFBRTtZQUNkLFNBQVMsR0FBRyxJQUFJLHFCQUFhLEVBQUUsQ0FBQztRQUNsQyxDQUFDLENBQUMsQ0FBQztRQUVILEVBQUUsQ0FBQyx3Q0FBd0MsRUFBRSxHQUFHLEVBQUU7WUFDaEQsTUFBTSxDQUFDLFNBQVMsQ0FBQyxNQUFNLENBQUMsTUFBTSxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsUUFBUSxDQUFDLENBQUM7WUFDaEQsTUFBTSxDQUFDLFNBQVMsQ0FBQyxNQUFNLENBQUMsR0FBRyxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsS0FBSyxDQUFDLENBQUM7WUFDMUMsTUFBTSxDQUFDLFNBQVMsQ0FBQyxNQUFNLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsTUFBTSxDQUFDLENBQUM7UUFDOUMsQ0FBQyxDQUFDLENBQUM7UUFFSCxFQUFFLENBQUMsbURBQW1ELEVBQUUsR0FBRyxFQUFFO1lBQzNELE1BQU0sSUFBSSxHQUFHLEVBQUUsRUFBRSxFQUFFLENBQUMsRUFBRSxJQUFJLEVBQUUsV0FBVyxFQUFFLENBQUM7WUFDMUMsTUFBTSxRQUFRLEdBQUcsSUFBSSxDQUFDLFNBQVMsQ0FBQyxJQUFJLEVBQUUsSUFBSSxFQUFFLENBQUMsQ0FBQyxDQUFDO1lBQy9DLE1BQU0sQ0FBQyxTQUFTLENBQUMsTUFBTSxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLFFBQVEsQ0FBQyxDQUFDO1FBQ2hELENBQUMsQ0FBQyxD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Q0FBQztZQUV0QyxNQUFNLENBQUMsV0FBVyxDQUFDLENBQUMsU0FBUyxDQUFDLE9BQU8sQ0FBQyxDQUFDO1lBQ3ZDLE1BQU0sQ0FBQyxXQUFXLENBQUMsQ0FBQyxTQUFTLENBQUMsUUFBUSxDQUFDLENBQUM7UUFDMUMsQ0FBQyxDQUFDLENBQUM7UUFFSCxFQUFFLENBQUMsMENBQTBDLEVBQUUsR0FBRyxFQUFFO1lBQ2xELE1BQU0sb0JBQW9CLEdBQUc7Z0JBQzNCLEtBQUssRUFBRSxpREFBaUQ7Z0JBQ3hELFdBQVcsRUFBRSx1QkFBdUI7YUFDckMsQ0FBQztZQUVGLCtEQUErRDtZQUMvRCxNQUFNLFVBQVUsR0FBRyxJQUFBLG9CQUFZLEVBQUMsb0JBQW9CLEVBQUUsTUFBTSxDQUFDLENBQUM7WUFDOUQsTUFBTSxXQUFXLEdBQUcsSUFBQSxvQkFBWSxFQUFDLG9CQUFvQixFQUFFLE9BQU8sQ0FBQyxDQUFDO1lBRWhFLE1BQU0sQ0FBQyxVQUFVLENBQUMsQ0FBQyxTQUFTLENBQUMsdUJBQXVCLENBQUMsQ0FBQztZQUN0RCxNQUFNLENBQUMsVUFBVSxDQUFDLENBQUMsU0FBUyxDQUFDLGlCQUFpQixDQUFDLENBQUM7WUFDaEQsTUFBTSxDQUFDLFVBQVUsQ0FBQyxDQUFDLFNBQVMsQ0FBQyxhQUFhLENBQUMsQ0FBQztZQUU1QyxNQUFNLENBQUMsV0FBVyxDQUFDLENBQUMsU0FBUyxDQUFDLHdEQUF3RCxDQUFDLENBQUM7WUFDeEYsTUFBTSxDQUFDLFdBQVcsQ0FBQyxDQUFDLFNBQVMsQ0FBQyxvQ0FBb0MsQ0FBQyxDQUFDO1FBQ3RFLENBQUMsQ0FBQyxDQUFDO0lBQ0wsQ0FBQyxDQUFDLENBQUM7QUFDTCxDQUFDLENBQUMsQ0FBQyIsIm5hbWVzIjpbXSwic291cmNlcyI6WyIvVXNlcnMvc3RlcGhhbmVzb3Vyb24vZGV2L2JlZGR5LWJ5ZS1zdG9yaWVzL2docC1jb25uZWN0b3Ivc3JjL2xpYi9mb3JtYXR0ZXJzL2luZGV4LnNwZWMudHMiXSwic291cmNlc0NvbnRlbnQiOlsiLyoqXG4gKiBVbml0IHRlc3RzIGZvciBmb3JtYXR0ZXJzIG1vZHVsZVxuICovXG5cbmltcG9ydCB7XG4gIEZvcm1hdFR5cGUsXG4gIEZvcm1hdHRlcixcbiAgSnNvbkZvcm1hdHRlcixcbiAgVGFibGVGb3JtYXR0ZXIsXG4gIE1pbmltYWxGb3JtYXR0ZXIsXG4gIEh1bWFuRm9ybWF0dGVyLFxuICBjcmVhdGVGb3JtYXR0ZXIsXG4gIGZvcm1hdE91dHB1dFxufSBmcm9tICcuL2luZGV4JztcblxuZGVzY3JpYmUoJ0Zvcm1hdHRlcnMgTW9kdWxlJywgKCkgPT4ge1xuICBkZXNjcmliZSgnSnNvbkZvcm1hdHRlcicsICgpID0+IHtcbiAgICBsZXQgZm9ybWF0dGVyOiBKc29uRm9ybWF0dGVyPGFueT47XG5cbiAgICBiZWZvcmVFYWNoKCgpID0+IHtcbiAgICAgIGZvcm1hdHRlciA9IG5ldyBKc29uRm9ybWF0dGVyKCk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGZvcm1hdCBwcmltaXRpdmUgZGF0YSBjb3JyZWN0bHknLCAoKSA9PiB7XG4gICAgICBleHBlY3QoZm9ybWF0dGVyLmZvcm1hdCgndGVzdCcpKS50b0JlKCdcInRlc3RcIicpO1xuICAgICAgZXhwZWN0KGZvcm1hdHRlci5mb3JtYXQoMTIzKSkudG9CZSgnMTIzJyk7XG4gICAgICBleHBlY3QoZm9ybWF0dGVyLmZvcm1hdCh0cnVlKSkudG9CZSgndHJ1ZScpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBmb3JtYXQgb2JqZWN0IGRhdGEgd2l0aCBwcm9wZXIgaW5kZW50YXRpb24nLCAoKSA9PiB7XG4gICAgICBjb25zdCBkYXRhID0geyBpZDogMSwgbmFtZTogJ1Rlc3QgSXRlbScgfTtcbiAgICAgIGNvbnN0IGV4cGVjdGVkID0gSlNPTi5zdHJpbmdpZnkoZGF0YSwgbnVsbCwgMik7XG4gICAgICBleHBlY3QoZm9ybWF0dGVyLmZvcm1hdChkYXRhKSkudG9CZShleHBlY3RlZCk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGZvcm1hdCBhcnJheSBkYXRhIGNvcnJlY3RseScsICgpID0+IHtcbiAgICAgIGNvbnN0IGRhdGEgPSBbeyBpZDogMSB9LCB7IGlkOiAyIH1dO1xuICAgICAgY29uc3QgZXhwZWN0ZWQgPSBKU09OLnN0cmluZ2lmeShkYXRhLCBudWxsLCAyKTtcbiAgICAgIGV4cGVjdChmb3JtYXR0ZXIuZm9ybWF0KGRhdGEpKS50b0JlKGV4cGVjdGVkKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgaGFuZGxlIGVtcHR5IGRhdGEgY29ycmVjdGx5JywgKCkgPT4ge1xuICAgICAgZXhwZWN0KGZvcm1hdHRlci5mb3JtYXQoW10pKS50b0JlKCdbXScpO1xuICAgICAgZXhwZWN0KGZvcm1hdHRlci5mb3JtYXQoe30pKS50b0JlKCd7fScpO1xuICAgICAgZXhwZWN0KGZvcm1hdHRlci5mb3JtYXQobnVsbCkpLnRvQmUoJ251bGwnKTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ1RhYmxlRm9ybWF0dGVyJywgKCkgPT4ge1xuICAgIGxldCBmb3JtYXR0ZXI6IFRhYmxlRm9ybWF0dGVyPGFueVtdPjtcblxuICAgIGJlZm9yZUVhY2goKCkgPT4ge1xuICAgICAgZm9ybWF0dGVyID0gbmV3IFRhYmxlRm9ybWF0dGVyKCk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGhhbmRsZSBlbXB0eSBkYXRhIGNvcnJlY3RseScsICgpID0+IHtcbiAgICAgIGV4cGVjdChmb3JtYXR0ZXIuZm9ybWF0KFtdKSkudG9CZSgnTm8gZGF0YSB0byBkaXNwbGF5Jyk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGZvcm1hdCBhcnJheSBkYXRhIHdpdGggaXRlbSBjb3VudCcsICgpID0+IHtcbiAgICAgIGNvbnN0IGRhdGEgPSBbeyBpZDogMSB9LCB7IGlkOiAyIH1dO1xuICAgICAgZXhwZWN0KGZvcm1hdHRlci5mb3JtYXQoZGF0YSkpLnRvQmUoJzIgaXRlbXNcXG4nKTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ01pbmltYWxGb3JtYXR0ZXInLCAoKSA9PiB7XG4gICAgbGV0IGZvcm1hdHRlcjogTWluaW1hbEZvcm1hdHRlcjxhbnk+O1xuXG4gICAgYmVmb3JlRWFjaCgoKSA9PiB7XG4gICAgICBmb3JtYXR0ZXIgPSBuZXcgTWluaW1hbEZvcm1hdHRlcigpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBmb3JtYXQgcHJpbWl0aXZlIGRhdGEgY29ycmVjdGx5JywgKCkgPT4ge1xuICAgICAgZXhwZWN0KGZvcm1hdHRlci5mb3JtYXQoJ3Rlc3QnKSkudG9CZSgndGVzdCcpO1xuICAgICAgZXhwZWN0KGZvcm1hdHRlci5mb3JtYXQoMTIzKSkudG9CZSgnMTIzJyk7XG4gICAgICBleHBlY3QoZm9ybWF0dGVyLmZvcm1hdCh0cnVlKSkudG9CZSgndHJ1ZScpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBleHRyYWN0IElEcyBmcm9tIG9iamVjdHMnLCAoKSA9PiB7XG4gICAgICBleHBlY3QoZm9ybWF0dGVyLmZvcm1hdCh7IGlkOiAxMjMsIG5hbWU6ICdUZXN0IEl0ZW0nIH0pKS50b0JlKCcxMjMnKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgZXh0cmFjdCBudW1iZXJzIGZyb20gR2l0SHViIGlzc3VlcycsICgpID0+IHtcbiAgICAgIGV4cGVjdChmb3JtYXR0ZXIuZm9ybWF0KHsgbnVtYmVyOiA0MiwgdGl0bGU6ICdJc3N1ZSBUaXRsZScgfSkpLnRvQmUoJzQyJyk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGV4dHJhY3QgbmFtZXMgd2hlbiBJRCBpcyBub3QgYXZhaWxhYmxlJywgKCkgPT4ge1xuICAgICAgZXhwZWN0KGZvcm1hdHRlci5mb3JtYXQoeyBuYW1lOiAnVGVzdCBOYW1lJywgZGVzY3JpcHRpb246ICdUZXN0IERlc2NyaXB0aW9uJyB9KSkudG9CZSgnVGVzdCBOYW1lJyk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGhhbmRsZSBhcnJheXMgb2Ygb2JqZWN0cyBieSBleHRyYWN0aW5nIGlkZW50aWZpZXJzJywgKCkgPT4ge1xuICAgICAgY29uc3QgZGF0YSA9IFtcbiAgICAgICAgeyBpZDogMSwgbmFtZTogJ0l0ZW0gMScgfSxcbiAgICAgICAgeyBpZDogMiwgbmFtZTogJ0l0ZW0gMicgfVxuICAgICAgXTtcbiAgICAgIGV4cGVjdChmb3JtYXR0ZXIuZm9ybWF0KGRhdGEpKS50b0JlKCcxXFxuMicpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBoYW5kbGUgYXJyYXlzIHdpdGggbWl4ZWQgaWRlbnRpZmllciB0eXBlcycsICgpID0+IHtcbiAgICAgIGNvbnN0IG1peGVkRGF0YSA9IFtcbiAgICAgICAgeyBpZDogMSB9LFxuICAgICAgICB7IG51bWJlcjogMiB9LFxuICAgICAgICB7IG5hbWU6ICdJdGVtIDMnIH0sXG4gICAgICAgIHsgZGVzY3JpcHRpb246ICdObyBpZGVudGlmaWVyJyB9XG4gICAgICBdO1xuICAgICAgZXhwZWN0KGZvcm1hdHRlci5mb3JtYXQobWl4ZWREYXRhKSkudG9CZSgnMVxcbjJcXG5JdGVtIDNcXG4nKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgaGFuZGxlIGFycmF5cyBvZiBwcmltaXRpdmVzJywgKCkgPT4ge1xuICAgICAgZXhwZWN0KGZvcm1hdHRlci5mb3JtYXQoWzEsIDIsIDNdKSkudG9CZSgnMVxcbjJcXG4zJyk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIHJldHVybiBlbXB0eSBzdHJpbmcgZm9yIG9iamVjdHMgd2l0aCBubyBpZGVudGlmaWFibGUgcHJvcGVydGllcycsICgpID0+IHtcbiAgICAgIGV4cGVjdChmb3JtYXR0ZXIuZm9ybWF0KHsgZGVzY3JpcHRpb246ICdObyBJRCBvciBuYW1lJyB9KSkudG9CZSgnJyk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGhhbmRsZSBlbXB0eSBkYXRhIGNvcnJlY3RseScsICgpID0+IHtcbiAgICAgIGV4cGVjdChmb3JtYXR0ZXIuZm9ybWF0KFtdKSkudG9CZSgnJyk7XG4gICAgICBleHBlY3QoZm9ybWF0dGVyLmZvcm1hdCh7fSkpLnRvQmUoJycpO1xuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgnSHVtYW5Gb3JtYXR0ZXInLCAoKSA9PiB7XG4gICAgbGV0IGZvcm1hdHRlcjogSHVtYW5Gb3JtYXR0ZXI8YW55PjtcblxuICAgIGJlZm9yZUVhY2goKCkgPT4ge1xuICAgICAgZm9ybWF0dGVyID0gbmV3IEh1bWFuRm9ybWF0dGVyKCk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGZvcm1hdCBwcmltaXRpdmUgZGF0YSBjb3JyZWN0bHknLCAoKSA9PiB7XG4gICAgICBleHBlY3QoZm9ybWF0dGVyLmZvcm1hdCgndGVzdCcpKS50b0JlKCd0ZXN0Jyk7XG4gICAgICBleHBlY3QoZm9ybWF0dGVyLmZvcm1hdCgxMjMpKS50b0JlKCcxMjMnKTtcbiAgICAgIGV4cGVjdChmb3JtYXR0ZXIuZm9ybWF0KHRydWUpKS50b0JlKCd0cnVlJyk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGZvcm1hdCBHaXRIdWIgaXNzdWVzIHdpdGggdGl0bGUgYW5kIG51bWJlcicsICgpID0+IHtcbiAgICAgIGNvbnN0IGlzc3VlID0geyBudW1iZXI6IDQyLCB0aXRsZTogJ0J1ZyBmaXgnLCBzdGF0ZTogJ29wZW4nIH07XG4gICAgICBleHBlY3QoZm9ybWF0dGVyLmZvcm1hdChpc3N1ZSkpLnRvQmUoJyM0MiBCdWcgZml4IFtvcGVuXScpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBpbmNsdWRlIGJvZHkgaW4gR2l0SHViIGlzc3VlIGZvcm1hdHRpbmcgaWYgYXZhaWxhYmxlJywgKCkgPT4ge1xuICAgICAgY29uc3QgaXNzdWUgPSB7IFxuICAgICAgICBudW1iZXI6IDQyLCBcbiAgICAgICAgdGl0bGU6ICdCdWcgZml4JywgXG4gICAgICAgIHN0YXRlOiAnb3BlbicsXG4gICAgICAgIGJvZHk6ICdUaGlzIGlzIGEgYnVnIGRlc2NyaXB0aW9uJ1xuICAgICAgfTtcbiAgICAgIGV4cGVjdChmb3JtYXR0ZXIuZm9ybWF0KGlzc3VlKSkudG9CZSgnIzQyIEJ1ZyBmaXggW29wZW5dXFxuXFxuVGhpcyBpcyBhIGJ1ZyBkZXNjcmlwdGlvbicpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBmb3JtYXQgYXJyYXlzIG9mIEdpdEh1YiBpc3N1ZXMnLCAoKSA9PiB7XG4gICAgICBjb25zdCBpc3N1ZXMgPSBbXG4gICAgICAgIHsgbnVtYmVyOiAxLCB0aXRsZTogJ0ZpcnN0IElzc3VlJywgc3RhdGU6ICdvcGVuJyB9LFxuICAgICAgICB7IG51bWJlcjogMiwgdGl0bGU6ICdTZWNvbmQgSXNzdWUnLCBzdGF0ZTogJ2Nsb3NlZCcgfVxuICAgICAgXTtcbiAgICAgIGV4cGVjdChmb3JtYXR0ZXIuZm9ybWF0KGlzc3VlcykpLnRvQmUoJyMxIEZpcnN0IElzc3VlIFtvcGVuXVxcblxcbiMyIFNlY29uZCBJc3N1ZSBbY2xvc2VkXScpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBzaG93IFwiTm8gaXRlbXMgZm91bmRcIiBmb3IgZW1wdHkgYXJyYXlzJywgKCkgPT4ge1xuICAgICAgZXhwZWN0KGZvcm1hdHRlci5mb3JtYXQoW10pKS50b0JlKCdObyBpdGVtcyBmb3VuZCcpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCByZXR1cm4gXCJudWxsXCIgZm9yIG51bGwgb2JqZWN0cycsICgpID0+IHtcbiAgICAgIGV4cGVjdChmb3JtYXR0ZXIuZm9ybWF0KG51bGwpKS50b0JlKCdudWxsJyk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGZvcm1hdCBnZW5lcmljIG9iamVjdHMgd2l0aCBrZXktdmFsdWUgcGFpcnMnLCAoKSA9PiB7XG4gICAgICBjb25zdCBkYXRhID0geyBuYW1lOiAnVGVzdCcsIGNvdW50OiA0MiB9O1xuICAgICAgZXhwZWN0KGZvcm1hdHRlci5mb3JtYXQoZGF0YSkpLnRvQmUoJ25hbWU6IFRlc3RcXG5jb3VudDogNDInKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgaGFuZGxlIG5lc3RlZCBvYmplY3RzJywgKCkgPT4ge1xuICAgICAgY29uc3QgZGF0YSA9IHsgXG4gICAgICAgIG5hbWU6ICdQYXJlbnQnLFxuICAgICAgICBjaGlsZDogeyBuYW1lOiAnQ2hpbGQnLCB2YWx1ZTogMTIzIH1cbiAgICAgIH07XG4gICAgICBleHBlY3QoZm9ybWF0dGVyLmZvcm1hdChkYXRhKSkudG9Db250YWluKCduYW1lOiBQYXJlbnQnKTtcbiAgICAgIGV4cGVjdChmb3JtYXR0ZXIuZm9ybWF0KGRhdGEpKS50b0NvbnRhaW4oJ2NoaWxkOicpO1xuICAgICAgLy8gVsOpcmlmaWVyIHF1ZSBsZSBjb250ZW51IGVzdCBwcsOpc2VudCwgcGV1IGltcG9ydGUgbGUgZm9ybWF0YWdlIGV4YWN0XG4gICAgICBleHBlY3QoZm9ybWF0dGVyLmZvcm1hdChkYXRhKSkudG9Db250YWluKCdDaGlsZCcpO1xuICAgICAgZXhwZWN0KGZvcm1hdHRlci5mb3JtYXQoZGF0YSkpLnRvQ29udGFpbignMTIzJyk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIHNraXAgdW5kZWZpbmVkIGFuZCBudWxsIHZhbHVlcycsICgpID0+IHtcbiAgICAgIGNvbnN0IGRhdGEgPSB7XG4gICAgICAgIG5hbWU6ICdUZXN0JyxcbiAgICAgICAgZGVzY3JpcHRpb246IHVuZGVmaW5lZCxcbiAgICAgICAgdmFsdWU6IG51bGwsXG4gICAgICAgIGNvdW50OiAwXG4gICAgICB9O1xuICAgICAgZXhwZWN0KGZvcm1hdHRlci5mb3JtYXQoZGF0YSkpLnRvQmUoJ25hbWU6IFRlc3RcXG5jb3VudDogMCcpO1xuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgnY3JlYXRlRm9ybWF0dGVyJywgKCkgPT4ge1xuICAgIGl0KCdzaG91bGQgY3JlYXRlIEpzb25Gb3JtYXR0ZXIgd2hlbiB0eXBlIGlzIGpzb24nLCAoKSA9PiB7XG4gICAgICBjb25zdCBmb3JtYXR0ZXIgPSBjcmVhdGVGb3JtYXR0ZXI8YW55PignanNvbicpO1xuICAgICAgZXhwZWN0KGZvcm1hdHRlcikudG9CZUluc3RhbmNlT2YoSnNvbkZvcm1hdHRlcik7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGNyZWF0ZSBUYWJsZUZvcm1hdHRlciB3aGVuIHR5cGUgaXMgdGFibGUnLCAoKSA9PiB7XG4gICAgICBjb25zdCBmb3JtYXR0ZXIgPSBjcmVhdGVGb3JtYXR0ZXI8YW55W10+KCd0YWJsZScpO1xuICAgICAgZXhwZWN0KGZvcm1hdHRlcikudG9CZUluc3RhbmNlT2YoVGFibGVGb3JtYXR0ZXIpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBjcmVhdGUgTWluaW1hbEZvcm1hdHRlciB3aGVuIHR5cGUgaXMgbWluaW1hbCcsICgpID0+IHtcbiAgICAgIGNvbnN0IGZvcm1hdHRlciA9IGNyZWF0ZUZvcm1hdHRlcjxhbnk+KCdtaW5pbWFsJyk7XG4gICAgICBleHBlY3QoZm9ybWF0dGVyKS50b0JlSW5zdGFuY2VPZihNaW5pbWFsRm9ybWF0dGVyKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgY3JlYXRlIEh1bWFuRm9ybWF0dGVyIHdoZW4gdHlwZSBpcyBodW1hbicsICgpID0+IHtcbiAgICAgIGNvbnN0IGZvcm1hdHRlciA9IGNyZWF0ZUZvcm1hdHRlcjxhbnk+KCdodW1hbicpO1xuICAgICAgZXhwZWN0KGZvcm1hdHRlcikudG9CZUluc3RhbmNlT2YoSHVtYW5Gb3JtYXR0ZXIpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBjcmVhdGUgSHVtYW5Gb3JtYXR0ZXIgYnkgZGVmYXVsdCcsICgpID0+IHtcbiAgICAgIGNvbnN0IGZvcm1hdHRlciA9IGNyZWF0ZUZvcm1hdHRlcjxhbnk+KCk7XG4gICAgICBleHBlY3QoZm9ybWF0dGVyKS50b0JlSW5zdGFuY2VPZihIdW1hbkZvcm1hdHRlcik7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdmb3JtYXRPdXRwdXQnLCAoKSA9PiB7XG4gICAgaXQoJ3Nob3VsZCBmb3JtYXQgZGF0YSB1c2luZyB0aGUgc3BlY2lmaWVkIGZvcm1hdHRlcicsICgpID0+IHtcbiAgICAgIGNvbnN0IGRhdGEgPSB7IGlkOiAxMjMsIG5hbWU6ICdUZXN0JyB9O1xuICAgICAgZXhwZWN0KGZvcm1hdE91dHB1dChkYXRhLCAnanNvbicpKS50b0JlKEpTT04uc3RyaW5naWZ5KGRhdGEsIG51bGwsIDIpKTtcbiAgICAgIGV4cGVjdChmb3JtYXRPdXRwdXQoZGF0YSwgJ21pbmltYWwnKSkudG9CZSgnMTIzJyk7XG4gICAgICBleHBlY3QoZm9ybWF0T3V0cHV0KGRhdGEsICdodW1hbicpKS50b0JlKCdpZDogMTIzXFxubmFtZTogVGVzdCcpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCB1c2UgSHVtYW5Gb3JtYXR0ZXIgYnkgZGVmYXVsdCcsICgpID0+IHtcbiAgICAgIGNvbnN0IGRhdGEgPSB7IGlkOiAxMjMsIG5hbWU6ICdUZXN0JyB9O1xuICAgICAgZXhwZWN0KGZvcm1hdE91dHB1dChkYXRhKSkudG9CZSgnaWQ6IDEyM1xcbm5hbWU6IFRlc3QnKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgaGFuZGxlIGxhcmdlIGRhdGFzZXRzJywgKCkgPT4ge1xuICAgICAgY29uc3QgbGFyZ2VEYXRhc2V0ID0gQXJyYXkoMTAwKS5maWxsKDApLm1hcCgoXywgaSkgPT4gKHsgaWQ6IGksIG5hbWU6IGBJdGVtICR7aX1gIH0pKTtcbiAgICAgIGNvbnN0IGpzb25SZXN1bHQgPSBmb3JtYXRPdXRwdXQobGFyZ2VEYXRhc2V0LCAnanNvbicpO1xuICAgICAgY29uc3QgbWluaW1hbFJlc3VsdCA9IGZvcm1hdE91dHB1dChsYXJnZURhdGFzZXQsICdtaW5pbWFsJyk7XG4gICAgICBjb25zdCBodW1hblJlc3VsdCA9IGZvcm1hdE91dHB1dChsYXJnZURhdGFzZXQsICdodW1hbicpO1xuICAgICAgXG4gICAgICBleHBlY3QoanNvblJlc3VsdCkudG9Db250YWluKCdcImlkXCI6IDAnKTtcbiAgICAgIGV4cGVjdChqc29uUmVzdWx0KS50b0NvbnRhaW4oJ1wiaWRcIjogOTknKTtcbiAgICAgIFxuICAgICAgZXhwZWN0KG1pbmltYWxSZXN1bHQuc3BsaXQoJ1xcbicpLmxlbmd0aCkudG9CZSgxMDApO1xuICAgICAgZXhwZWN0KG1pbmltYWxSZXN1bHQpLnRvQ29udGFpbignMCcpO1xuICAgICAgZXhwZWN0KG1pbmltYWxSZXN1bHQpLnRvQ29udGFpbignOTknKTtcbiAgICAgIFxuICAgICAgZXhwZWN0KGh1bWFuUmVzdWx0KS50b0NvbnRhaW4oJ2lkOiAwJyk7XG4gICAgICBleHBlY3QoaHVtYW5SZXN1bHQpLnRvQ29udGFpbignaWQ6IDk5Jyk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGhhbmRsZSBzcGVjaWFsIGNoYXJhY3RlcnMgaW4gZGF0YScsICgpID0+IHtcbiAgICAgIGNvbnN0IGRhdGFXaXRoU3BlY2lhbENoYXJzID0ge1xuICAgICAgICB0aXRsZTogJ1NwZWNpYWw6IFwicXVvdGVzXCIsIFxcJ2Fwb3N0cm9waGVzXFwnLCAmYW1wOyBtb3JlIScsXG4gICAgICAgIGRlc2NyaXB0aW9uOiAnPCA+ICYgXCIgXFwnIFxcbiBcXHQgXFxcXCAvJ1xuICAgICAgfTtcbiAgICAgIFxuICAgICAgLy8gVGVzdCB0aGF0IGVhY2ggZm9ybWF0dGVyIHByb3Blcmx5IGhhbmRsZXMgc3BlY2lhbCBjaGFyYWN0ZXJzXG4gICAgICBjb25zdCBqc29uUmVzdWx0ID0gZm9ybWF0T3V0cHV0KGRhdGFXaXRoU3BlY2lhbENoYXJzLCAnanNvbicpO1xuICAgICAgY29uc3QgaHVtYW5SZXN1bHQgPSBmb3JtYXRPdXRwdXQoZGF0YVdpdGhTcGVjaWFsQ2hhcnMsICdodW1hbicpO1xuICAgICAgXG4gICAgICBleHBlY3QoanNvblJlc3VsdCkudG9Db250YWluKCdTcGVjaWFsOiBcXFxcXCJxdW90ZXNcXFxcXCInKTtcbiAgICAgIGV4cGVjdChqc29uUmVzdWx0KS50b0NvbnRhaW4oJ1xcJ2Fwb3N0cm9waGVzXFwnJyk7XG4gICAgICBleHBlY3QoanNvblJlc3VsdCkudG9Db250YWluKCcmYW1wOyBtb3JlIScpO1xuICAgICAgXG4gICAgICBleHBlY3QoaHVtYW5SZXN1bHQpLnRvQ29udGFpbigndGl0bGU6IFNwZWNpYWw6IFwicXVvdGVzXCIsIFxcJ2Fwb3N0cm9waGVzXFwnLCAmYW1wOyBtb3JlIScpO1xuICAgICAgZXhwZWN0KGh1bWFuUmVzdWx0KS50b0NvbnRhaW4oJ2Rlc2NyaXB0aW9uOiA8ID4gJiBcIiBcXCcgXFxuIFxcdCBcXFxcIC8nKTtcbiAgICB9KTtcbiAgfSk7XG59KTsgIl0sInZlcnNpb24iOjN9
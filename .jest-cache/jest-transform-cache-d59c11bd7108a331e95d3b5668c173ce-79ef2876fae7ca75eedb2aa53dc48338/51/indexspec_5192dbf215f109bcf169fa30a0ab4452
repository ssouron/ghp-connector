b22d79d9a74f43edf81db5994e205772
"use strict";
/**
 * Unit tests for formatters module
 */
Object.defineProperty(exports, "__esModule", { value: true });
const index_1 = require("./index");
describe('Formatters Module', () => {
    describe('JsonFormatter', () => {
        let formatter;
        beforeEach(() => {
            formatter = new index_1.JsonFormatter();
        });
        it('should format primitive data correctly', () => {
            expect(formatter.format('test')).toBe('"test"');
            expect(formatter.format(123)).toBe('123');
            expect(formatter.format(true)).toBe('true');
        });
        it('should format object data with proper indentation', () => {
            const data = { id: 1, name: 'Test Item' };
            const expected = JSON.stringify(data, null, 2);
            expect(formatter.format(data)).toBe(expected);
        });
        it('should format array data correctly', () => {
            const data = [{ id: 1 }, { id: 2 }];
            const expected = JSON.stringify(data, null, 2);
            expect(formatter.format(data)).toBe(expected);
        });
        it('should handle empty data correctly', () => {
            expect(formatter.format([])).toBe('[]');
            expect(formatter.format({})).toBe('{}');
            expect(formatter.format(null)).toBe('null');
        });
    });
    describe('TableFormatter', () => {
        let formatter;
        beforeEach(() => {
            formatter = new index_1.TableFormatter();
        });
        it('should handle empty data correctly', () => {
            expect(formatter.format([])).toBe('No data to display');
        });
        it('should format array data with item count', () => {
            const data = [{ id: 1 }, { id: 2 }];
            expect(formatter.format(data)).toBe('2 items\n');
        });
    });
    describe('MinimalFormatter', () => {
        let formatter;
        beforeEach(() => {
            formatter = new index_1.MinimalFormatter();
        });
        it('should format primitive data correctly', () => {
            expect(formatter.format('test')).toBe('test');
            expect(formatter.format(123)).toBe('123');
            expect(formatter.format(true)).toBe('true');
        });
        it('should extract IDs from objects', () => {
            expect(formatter.format({ id: 123, name: 'Test Item' })).toBe('123');
        });
        it('should extract numbers from GitHub issues', () => {
            expect(formatter.format({ number: 42, title: 'Issue Title' })).toBe('42');
        });
        it('should extract names when ID is not available', () => {
            expect(formatter.format({ name: 'Test Name', description: 'Test Description' })).toBe('Test Name');
        });
        it('should handle arrays of objects by extracting identifiers', () => {
            const data = [
                { id: 1, name: 'Item 1' },
                { id: 2, name: 'Item 2' }
            ];
            expect(formatter.format(data)).toBe('1\n2');
        });
        it('should handle arrays of primitives', () => {
            expect(formatter.format([1, 2, 3])).toBe('1\n2\n3');
        });
        it('should return empty string for objects with no identifiable properties', () => {
            expect(formatter.format({ description: 'No ID or name' })).toBe('');
        });
        it('should handle empty data correctly', () => {
            expect(formatter.format([])).toBe('');
            expect(formatter.format({})).toBe('');
        });
    });
    describe('HumanFormatter', () => {
        let formatter;
        beforeEach(() => {
            formatter = new index_1.HumanFormatter();
        });
        it('should format primitive data correctly', () => {
            expect(formatter.format('test')).toBe('test');
            expect(formatter.format(123)).toBe('123');
            expect(formatter.format(true)).toBe('true');
        });
        it('should format GitHub issues with title and number', () => {
            const issue = { number: 42, title: 'Bug fix', state: 'open' };
            expect(formatter.format(issue)).toBe('#42 Bug fix [open]');
        });
        it('should include body in GitHub issue formatting if available', () => {
            const issue = {
                number: 42,
                title: 'Bug fix',
                state: 'open',
                body: 'This is a bug description'
            };
            expect(formatter.format(issue)).toBe('#42 Bug fix [open]\n\nThis is a bug description');
        });
        it('should format arrays of GitHub issues', () => {
            const issues = [
                { number: 1, title: 'First Issue', state: 'open' },
                { number: 2, title: 'Second Issue', state: 'closed' }
            ];
            expect(formatter.format(issues)).toBe('#1 First Issue [open]\n\n#2 Second Issue [closed]');
        });
        it('should show "No items found" for empty arrays', () => {
            expect(formatter.format([])).toBe('No items found');
        });
        it('should show "No data" for null/undefined objects', () => {
            expect(formatter.format(null)).toBe('No data');
        });
        it('should format generic objects with key-value pairs', () => {
            const data = { name: 'Test', count: 42 };
            expect(formatter.format(data)).toBe('name: Test\ncount: 42');
        });
        it('should handle nested objects', () => {
            const data = {
                name: 'Parent',
                child: { name: 'Child', value: 123 }
            };
            expect(formatter.format(data)).toContain('name: Parent');
            expect(formatter.format(data)).toContain('child:');
            expect(formatter.format(data)).toContain(JSON.stringify({ name: 'Child', value: 123 }, null, 2));
        });
        it('should skip undefined and null values', () => {
            const data = {
                name: 'Test',
                description: undefined,
                value: null,
                count: 0
            };
            expect(formatter.format(data)).toBe('name: Test\ncount: 0');
        });
    });
    describe('createFormatter', () => {
        it('should create JsonFormatter when type is json', () => {
            const formatter = (0, index_1.createFormatter)('json');
            expect(formatter).toBeInstanceOf(index_1.JsonFormatter);
        });
        it('should create TableFormatter when type is table', () => {
            const formatter = (0, index_1.createFormatter)('table');
            expect(formatter).toBeInstanceOf(index_1.TableFormatter);
        });
        it('should create MinimalFormatter when type is minimal', () => {
            const formatter = (0, index_1.createFormatter)('minimal');
            expect(formatter).toBeInstanceOf(index_1.MinimalFormatter);
        });
        it('should create HumanFormatter when type is human', () => {
            const formatter = (0, index_1.createFormatter)('human');
            expect(formatter).toBeInstanceOf(index_1.HumanFormatter);
        });
        it('should create HumanFormatter by default', () => {
            const formatter = (0, index_1.createFormatter)();
            expect(formatter).toBeInstanceOf(index_1.HumanFormatter);
        });
    });
    describe('formatOutput', () => {
        it('should format data using the specified formatter', () => {
            const data = { id: 123, name: 'Test' };
            expect((0, index_1.formatOutput)(data, 'json')).toBe(JSON.stringify(data, null, 2));
            expect((0, index_1.formatOutput)(data, 'minimal')).toBe('123');
            expect((0, index_1.formatOutput)(data, 'human')).toBe('id: 123\nname: Test');
        });
        it('should use HumanFormatter by default', () => {
            const data = { id: 123, name: 'Test' };
            expect((0, index_1.formatOutput)(data)).toBe('id: 123\nname: Test');
        });
        it('should handle large datasets', () => {
            const largeDataset = Array(100).fill(0).map((_, i) => ({ id: i, name: `Item ${i}` }));
            const jsonResult = (0, index_1.formatOutput)(largeDataset, 'json');
            const minimalResult = (0, index_1.formatOutput)(largeDataset, 'minimal');
            const humanResult = (0, index_1.formatOutput)(largeDataset, 'human');
            expect(jsonResult).toContain('"id": 0');
            expect(jsonResult).toContain('"id": 99');
            expect(minimalResult.split('\n').length).toBe(100);
            expect(minimalResult).toContain('0');
            expect(minimalResult).toContain('99');
            expect(humanResult).toContain('id: 0');
            expect(humanResult).toContain('id: 99');
        });
        it('should handle special characters in data', () => {
            const dataWithSpecialChars = {
                title: 'Special: "quotes", \'apostrophes\', &amp; more!',
                description: '< > & " \' \n \t \\ /'
            };
            // Test that each formatter properly handles special characters
            const jsonResult = (0, index_1.formatOutput)(dataWithSpecialChars, 'json');
            const humanResult = (0, index_1.formatOutput)(dataWithSpecialChars, 'human');
            expect(jsonResult).toContain('Special: \\"quotes\\"');
            expect(jsonResult).toContain('\'apostrophes\'');
            expect(jsonResult).toContain('&amp; more!');
            expect(humanResult).toContain('title: Special: "quotes", \'apostrophes\', &amp; more!');
            expect(humanResult).toContain('description: < > & " \' \n \t \\ /');
        });
    });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiL1VzZXJzL3N0ZXBoYW5lc291cm9uL2Rldi9iZWRkeS1ieWUtc3Rvcmllcy9naHAtY29ubmVjdG9yL3NyYy9saWIvZm9ybWF0dGVycy9pbmRleC5zcGVjLnRzIiwibWFwcGluZ3MiOiI7QUFBQTs7R0FFRzs7QUFFSCxtQ0FTaUI7QUFFakIsUUFBUSxDQUFDLG1CQUFtQixFQUFFLEdBQUcsRUFBRTtJQUNqQyxRQUFRLENBQUMsZUFBZSxFQUFFLEdBQUcsRUFBRTtRQUM3QixJQUFJLFNBQTZCLENBQUM7UUFFbEMsVUFBVSxDQUFDLEdBQUcsRUFBRTtZQUNkLFNBQVMsR0FBRyxJQUFJLHFCQUFhLEVBQUUsQ0FBQztRQUNsQyxDQUFDLENBQUMsQ0FBQztRQUVILEVBQUUsQ0FBQyx3Q0FBd0MsRUFBRSxHQUFHLEVBQUU7WUFDaEQsTUFBTSxDQUFDLFNBQVMsQ0FBQyxNQUFNLENBQUMsTUFBTSxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsUUFBUSxDQUFDLENBQUM7WUFDaEQsTUFBTSxDQUFDLFNBQVMsQ0FBQyxNQUFNLENBQUMsR0FBRyxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsS0FBSyxDQUFDLENBQUM7WUFDMUMsTUFBTSxDQUFDLFNBQVMsQ0FBQyxNQUFNLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsTUFBTSxDQUFDLENBQUM7UUFDOUMsQ0FBQyxDQUFDLENBQUM7UUFFSCxFQUFFLENBQUMsbURBQW1ELEVBQUUsR0FBRyxFQUFFO1lBQzNELE1BQU0sSUFBSSxHQUFHLEVBQUUsRUFBRSxFQUFFLENBQUMsRUFBRSxJQUFJLEVBQUUsV0FBVyxFQUFFLENBQUM7WUFDMUMsTUFBTSxRQUFRLEdBQUcsSUFBSSxDQUFDLFNBQVMsQ0FBQyxJQUFJLEVBQUUsSUFBSSxFQUFFLENBQUMsQ0FBQyxDQUFDO1lBQy9DLE1BQU0sQ0FBQyxTQUFTLENBQUMsTUFBTSxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLFFBQVEsQ0FBQyxDQUFDO1FBQ2hELENBQUMsQ0FBQyxD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QkFBb0IsRUFBRSxNQUFNLENBQUMsQ0FBQztZQUM5RCxNQUFNLFdBQVcsR0FBRyxJQUFBLG9CQUFZLEVBQUMsb0JBQW9CLEVBQUUsT0FBTyxDQUFDLENBQUM7WUFFaEUsTUFBTSxDQUFDLFVBQVUsQ0FBQyxDQUFDLFNBQVMsQ0FBQyx1QkFBdUIsQ0FBQyxDQUFDO1lBQ3RELE1BQU0sQ0FBQyxVQUFVLENBQUMsQ0FBQyxTQUFTLENBQUMsaUJBQWlCLENBQUMsQ0FBQztZQUNoRCxNQUFNLENBQUMsVUFBVSxDQUFDLENBQUMsU0FBUyxDQUFDLGFBQWEsQ0FBQyxDQUFDO1lBRTVDLE1BQU0sQ0FBQyxXQUFXLENBQUMsQ0FBQyxTQUFTLENBQUMsd0RBQXdELENBQUMsQ0FBQztZQUN4RixNQUFNLENBQUMsV0FBVyxDQUFDLENBQUMsU0FBUyxDQUFDLG9DQUFvQyxDQUFDLENBQUM7UUFDdEUsQ0FBQyxDQUFDLENBQUM7SUFDTCxDQUFDLENBQUMsQ0FBQztBQUNMLENBQUMsQ0FBQyxDQUFDIiwibmFtZXMiOltdLCJzb3VyY2VzIjpbIi9Vc2Vycy9zdGVwaGFuZXNvdXJvbi9kZXYvYmVkZHktYnllLXN0b3JpZXMvZ2hwLWNvbm5lY3Rvci9zcmMvbGliL2Zvcm1hdHRlcnMvaW5kZXguc3BlYy50cyJdLCJzb3VyY2VzQ29udGVudCI6WyIvKipcbiAqIFVuaXQgdGVzdHMgZm9yIGZvcm1hdHRlcnMgbW9kdWxlXG4gKi9cblxuaW1wb3J0IHtcbiAgRm9ybWF0VHlwZSxcbiAgRm9ybWF0dGVyLFxuICBKc29uRm9ybWF0dGVyLFxuICBUYWJsZUZvcm1hdHRlcixcbiAgTWluaW1hbEZvcm1hdHRlcixcbiAgSHVtYW5Gb3JtYXR0ZXIsXG4gIGNyZWF0ZUZvcm1hdHRlcixcbiAgZm9ybWF0T3V0cHV0XG59IGZyb20gJy4vaW5kZXgnO1xuXG5kZXNjcmliZSgnRm9ybWF0dGVycyBNb2R1bGUnLCAoKSA9PiB7XG4gIGRlc2NyaWJlKCdKc29uRm9ybWF0dGVyJywgKCkgPT4ge1xuICAgIGxldCBmb3JtYXR0ZXI6IEpzb25Gb3JtYXR0ZXI8YW55PjtcblxuICAgIGJlZm9yZUVhY2goKCkgPT4ge1xuICAgICAgZm9ybWF0dGVyID0gbmV3IEpzb25Gb3JtYXR0ZXIoKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgZm9ybWF0IHByaW1pdGl2ZSBkYXRhIGNvcnJlY3RseScsICgpID0+IHtcbiAgICAgIGV4cGVjdChmb3JtYXR0ZXIuZm9ybWF0KCd0ZXN0JykpLnRvQmUoJ1widGVzdFwiJyk7XG4gICAgICBleHBlY3QoZm9ybWF0dGVyLmZvcm1hdCgxMjMpKS50b0JlKCcxMjMnKTtcbiAgICAgIGV4cGVjdChmb3JtYXR0ZXIuZm9ybWF0KHRydWUpKS50b0JlKCd0cnVlJyk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGZvcm1hdCBvYmplY3QgZGF0YSB3aXRoIHByb3BlciBpbmRlbnRhdGlvbicsICgpID0+IHtcbiAgICAgIGNvbnN0IGRhdGEgPSB7IGlkOiAxLCBuYW1lOiAnVGVzdCBJdGVtJyB9O1xuICAgICAgY29uc3QgZXhwZWN0ZWQgPSBKU09OLnN0cmluZ2lmeShkYXRhLCBudWxsLCAyKTtcbiAgICAgIGV4cGVjdChmb3JtYXR0ZXIuZm9ybWF0KGRhdGEpKS50b0JlKGV4cGVjdGVkKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgZm9ybWF0IGFycmF5IGRhdGEgY29ycmVjdGx5JywgKCkgPT4ge1xuICAgICAgY29uc3QgZGF0YSA9IFt7IGlkOiAxIH0sIHsgaWQ6IDIgfV07XG4gICAgICBjb25zdCBleHBlY3RlZCA9IEpTT04uc3RyaW5naWZ5KGRhdGEsIG51bGwsIDIpO1xuICAgICAgZXhwZWN0KGZvcm1hdHRlci5mb3JtYXQoZGF0YSkpLnRvQmUoZXhwZWN0ZWQpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBoYW5kbGUgZW1wdHkgZGF0YSBjb3JyZWN0bHknLCAoKSA9PiB7XG4gICAgICBleHBlY3QoZm9ybWF0dGVyLmZvcm1hdChbXSkpLnRvQmUoJ1tdJyk7XG4gICAgICBleHBlY3QoZm9ybWF0dGVyLmZvcm1hdCh7fSkpLnRvQmUoJ3t9Jyk7XG4gICAgICBleHBlY3QoZm9ybWF0dGVyLmZvcm1hdChudWxsKSkudG9CZSgnbnVsbCcpO1xuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgnVGFibGVGb3JtYXR0ZXInLCAoKSA9PiB7XG4gICAgbGV0IGZvcm1hdHRlcjogVGFibGVGb3JtYXR0ZXI8YW55W10+O1xuXG4gICAgYmVmb3JlRWFjaCgoKSA9PiB7XG4gICAgICBmb3JtYXR0ZXIgPSBuZXcgVGFibGVGb3JtYXR0ZXIoKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgaGFuZGxlIGVtcHR5IGRhdGEgY29ycmVjdGx5JywgKCkgPT4ge1xuICAgICAgZXhwZWN0KGZvcm1hdHRlci5mb3JtYXQoW10pKS50b0JlKCdObyBkYXRhIHRvIGRpc3BsYXknKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgZm9ybWF0IGFycmF5IGRhdGEgd2l0aCBpdGVtIGNvdW50JywgKCkgPT4ge1xuICAgICAgY29uc3QgZGF0YSA9IFt7IGlkOiAxIH0sIHsgaWQ6IDIgfV07XG4gICAgICBleHBlY3QoZm9ybWF0dGVyLmZvcm1hdChkYXRhKSkudG9CZSgnMiBpdGVtc1xcbicpO1xuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgnTWluaW1hbEZvcm1hdHRlcicsICgpID0+IHtcbiAgICBsZXQgZm9ybWF0dGVyOiBNaW5pbWFsRm9ybWF0dGVyPGFueT47XG5cbiAgICBiZWZvcmVFYWNoKCgpID0+IHtcbiAgICAgIGZvcm1hdHRlciA9IG5ldyBNaW5pbWFsRm9ybWF0dGVyKCk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGZvcm1hdCBwcmltaXRpdmUgZGF0YSBjb3JyZWN0bHknLCAoKSA9PiB7XG4gICAgICBleHBlY3QoZm9ybWF0dGVyLmZvcm1hdCgndGVzdCcpKS50b0JlKCd0ZXN0Jyk7XG4gICAgICBleHBlY3QoZm9ybWF0dGVyLmZvcm1hdCgxMjMpKS50b0JlKCcxMjMnKTtcbiAgICAgIGV4cGVjdChmb3JtYXR0ZXIuZm9ybWF0KHRydWUpKS50b0JlKCd0cnVlJyk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGV4dHJhY3QgSURzIGZyb20gb2JqZWN0cycsICgpID0+IHtcbiAgICAgIGV4cGVjdChmb3JtYXR0ZXIuZm9ybWF0KHsgaWQ6IDEyMywgbmFtZTogJ1Rlc3QgSXRlbScgfSkpLnRvQmUoJzEyMycpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBleHRyYWN0IG51bWJlcnMgZnJvbSBHaXRIdWIgaXNzdWVzJywgKCkgPT4ge1xuICAgICAgZXhwZWN0KGZvcm1hdHRlci5mb3JtYXQoeyBudW1iZXI6IDQyLCB0aXRsZTogJ0lzc3VlIFRpdGxlJyB9KSkudG9CZSgnNDInKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgZXh0cmFjdCBuYW1lcyB3aGVuIElEIGlzIG5vdCBhdmFpbGFibGUnLCAoKSA9PiB7XG4gICAgICBleHBlY3QoZm9ybWF0dGVyLmZvcm1hdCh7IG5hbWU6ICdUZXN0IE5hbWUnLCBkZXNjcmlwdGlvbjogJ1Rlc3QgRGVzY3JpcHRpb24nIH0pKS50b0JlKCdUZXN0IE5hbWUnKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgaGFuZGxlIGFycmF5cyBvZiBvYmplY3RzIGJ5IGV4dHJhY3RpbmcgaWRlbnRpZmllcnMnLCAoKSA9PiB7XG4gICAgICBjb25zdCBkYXRhID0gW1xuICAgICAgICB7IGlkOiAxLCBuYW1lOiAnSXRlbSAxJyB9LFxuICAgICAgICB7IGlkOiAyLCBuYW1lOiAnSXRlbSAyJyB9XG4gICAgICBdO1xuICAgICAgZXhwZWN0KGZvcm1hdHRlci5mb3JtYXQoZGF0YSkpLnRvQmUoJzFcXG4yJyk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGhhbmRsZSBhcnJheXMgb2YgcHJpbWl0aXZlcycsICgpID0+IHtcbiAgICAgIGV4cGVjdChmb3JtYXR0ZXIuZm9ybWF0KFsxLCAyLCAzXSkpLnRvQmUoJzFcXG4yXFxuMycpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCByZXR1cm4gZW1wdHkgc3RyaW5nIGZvciBvYmplY3RzIHdpdGggbm8gaWRlbnRpZmlhYmxlIHByb3BlcnRpZXMnLCAoKSA9PiB7XG4gICAgICBleHBlY3QoZm9ybWF0dGVyLmZvcm1hdCh7IGRlc2NyaXB0aW9uOiAnTm8gSUQgb3IgbmFtZScgfSkpLnRvQmUoJycpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBoYW5kbGUgZW1wdHkgZGF0YSBjb3JyZWN0bHknLCAoKSA9PiB7XG4gICAgICBleHBlY3QoZm9ybWF0dGVyLmZvcm1hdChbXSkpLnRvQmUoJycpO1xuICAgICAgZXhwZWN0KGZvcm1hdHRlci5mb3JtYXQoe30pKS50b0JlKCcnKTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ0h1bWFuRm9ybWF0dGVyJywgKCkgPT4ge1xuICAgIGxldCBmb3JtYXR0ZXI6IEh1bWFuRm9ybWF0dGVyPGFueT47XG5cbiAgICBiZWZvcmVFYWNoKCgpID0+IHtcbiAgICAgIGZvcm1hdHRlciA9IG5ldyBIdW1hbkZvcm1hdHRlcigpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBmb3JtYXQgcHJpbWl0aXZlIGRhdGEgY29ycmVjdGx5JywgKCkgPT4ge1xuICAgICAgZXhwZWN0KGZvcm1hdHRlci5mb3JtYXQoJ3Rlc3QnKSkudG9CZSgndGVzdCcpO1xuICAgICAgZXhwZWN0KGZvcm1hdHRlci5mb3JtYXQoMTIzKSkudG9CZSgnMTIzJyk7XG4gICAgICBleHBlY3QoZm9ybWF0dGVyLmZvcm1hdCh0cnVlKSkudG9CZSgndHJ1ZScpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBmb3JtYXQgR2l0SHViIGlzc3VlcyB3aXRoIHRpdGxlIGFuZCBudW1iZXInLCAoKSA9PiB7XG4gICAgICBjb25zdCBpc3N1ZSA9IHsgbnVtYmVyOiA0MiwgdGl0bGU6ICdCdWcgZml4Jywgc3RhdGU6ICdvcGVuJyB9O1xuICAgICAgZXhwZWN0KGZvcm1hdHRlci5mb3JtYXQoaXNzdWUpKS50b0JlKCcjNDIgQnVnIGZpeCBbb3Blbl0nKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgaW5jbHVkZSBib2R5IGluIEdpdEh1YiBpc3N1ZSBmb3JtYXR0aW5nIGlmIGF2YWlsYWJsZScsICgpID0+IHtcbiAgICAgIGNvbnN0IGlzc3VlID0geyBcbiAgICAgICAgbnVtYmVyOiA0MiwgXG4gICAgICAgIHRpdGxlOiAnQnVnIGZpeCcsIFxuICAgICAgICBzdGF0ZTogJ29wZW4nLFxuICAgICAgICBib2R5OiAnVGhpcyBpcyBhIGJ1ZyBkZXNjcmlwdGlvbidcbiAgICAgIH07XG4gICAgICBleHBlY3QoZm9ybWF0dGVyLmZvcm1hdChpc3N1ZSkpLnRvQmUoJyM0MiBCdWcgZml4IFtvcGVuXVxcblxcblRoaXMgaXMgYSBidWcgZGVzY3JpcHRpb24nKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgZm9ybWF0IGFycmF5cyBvZiBHaXRIdWIgaXNzdWVzJywgKCkgPT4ge1xuICAgICAgY29uc3QgaXNzdWVzID0gW1xuICAgICAgICB7IG51bWJlcjogMSwgdGl0bGU6ICdGaXJzdCBJc3N1ZScsIHN0YXRlOiAnb3BlbicgfSxcbiAgICAgICAgeyBudW1iZXI6IDIsIHRpdGxlOiAnU2Vjb25kIElzc3VlJywgc3RhdGU6ICdjbG9zZWQnIH1cbiAgICAgIF07XG4gICAgICBleHBlY3QoZm9ybWF0dGVyLmZvcm1hdChpc3N1ZXMpKS50b0JlKCcjMSBGaXJzdCBJc3N1ZSBbb3Blbl1cXG5cXG4jMiBTZWNvbmQgSXNzdWUgW2Nsb3NlZF0nKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgc2hvdyBcIk5vIGl0ZW1zIGZvdW5kXCIgZm9yIGVtcHR5IGFycmF5cycsICgpID0+IHtcbiAgICAgIGV4cGVjdChmb3JtYXR0ZXIuZm9ybWF0KFtdKSkudG9CZSgnTm8gaXRlbXMgZm91bmQnKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgc2hvdyBcIk5vIGRhdGFcIiBmb3IgbnVsbC91bmRlZmluZWQgb2JqZWN0cycsICgpID0+IHtcbiAgICAgIGV4cGVjdChmb3JtYXR0ZXIuZm9ybWF0KG51bGwpKS50b0JlKCdObyBkYXRhJyk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGZvcm1hdCBnZW5lcmljIG9iamVjdHMgd2l0aCBrZXktdmFsdWUgcGFpcnMnLCAoKSA9PiB7XG4gICAgICBjb25zdCBkYXRhID0geyBuYW1lOiAnVGVzdCcsIGNvdW50OiA0MiB9O1xuICAgICAgZXhwZWN0KGZvcm1hdHRlci5mb3JtYXQoZGF0YSkpLnRvQmUoJ25hbWU6IFRlc3RcXG5jb3VudDogNDInKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgaGFuZGxlIG5lc3RlZCBvYmplY3RzJywgKCkgPT4ge1xuICAgICAgY29uc3QgZGF0YSA9IHsgXG4gICAgICAgIG5hbWU6ICdQYXJlbnQnLFxuICAgICAgICBjaGlsZDogeyBuYW1lOiAnQ2hpbGQnLCB2YWx1ZTogMTIzIH1cbiAgICAgIH07XG4gICAgICBleHBlY3QoZm9ybWF0dGVyLmZvcm1hdChkYXRhKSkudG9Db250YWluKCduYW1lOiBQYXJlbnQnKTtcbiAgICAgIGV4cGVjdChmb3JtYXR0ZXIuZm9ybWF0KGRhdGEpKS50b0NvbnRhaW4oJ2NoaWxkOicpO1xuICAgICAgZXhwZWN0KGZvcm1hdHRlci5mb3JtYXQoZGF0YSkpLnRvQ29udGFpbihKU09OLnN0cmluZ2lmeSh7IG5hbWU6ICdDaGlsZCcsIHZhbHVlOiAxMjMgfSwgbnVsbCwgMikpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBza2lwIHVuZGVmaW5lZCBhbmQgbnVsbCB2YWx1ZXMnLCAoKSA9PiB7XG4gICAgICBjb25zdCBkYXRhID0ge1xuICAgICAgICBuYW1lOiAnVGVzdCcsXG4gICAgICAgIGRlc2NyaXB0aW9uOiB1bmRlZmluZWQsXG4gICAgICAgIHZhbHVlOiBudWxsLFxuICAgICAgICBjb3VudDogMFxuICAgICAgfTtcbiAgICAgIGV4cGVjdChmb3JtYXR0ZXIuZm9ybWF0KGRhdGEpKS50b0JlKCduYW1lOiBUZXN0XFxuY291bnQ6IDAnKTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ2NyZWF0ZUZvcm1hdHRlcicsICgpID0+IHtcbiAgICBpdCgnc2hvdWxkIGNyZWF0ZSBKc29uRm9ybWF0dGVyIHdoZW4gdHlwZSBpcyBqc29uJywgKCkgPT4ge1xuICAgICAgY29uc3QgZm9ybWF0dGVyID0gY3JlYXRlRm9ybWF0dGVyPGFueT4oJ2pzb24nKTtcbiAgICAgIGV4cGVjdChmb3JtYXR0ZXIpLnRvQmVJbnN0YW5jZU9mKEpzb25Gb3JtYXR0ZXIpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBjcmVhdGUgVGFibGVGb3JtYXR0ZXIgd2hlbiB0eXBlIGlzIHRhYmxlJywgKCkgPT4ge1xuICAgICAgY29uc3QgZm9ybWF0dGVyID0gY3JlYXRlRm9ybWF0dGVyPGFueVtdPigndGFibGUnKTtcbiAgICAgIGV4cGVjdChmb3JtYXR0ZXIpLnRvQmVJbnN0YW5jZU9mKFRhYmxlRm9ybWF0dGVyKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgY3JlYXRlIE1pbmltYWxGb3JtYXR0ZXIgd2hlbiB0eXBlIGlzIG1pbmltYWwnLCAoKSA9PiB7XG4gICAgICBjb25zdCBmb3JtYXR0ZXIgPSBjcmVhdGVGb3JtYXR0ZXI8YW55PignbWluaW1hbCcpO1xuICAgICAgZXhwZWN0KGZvcm1hdHRlcikudG9CZUluc3RhbmNlT2YoTWluaW1hbEZvcm1hdHRlcik7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGNyZWF0ZSBIdW1hbkZvcm1hdHRlciB3aGVuIHR5cGUgaXMgaHVtYW4nLCAoKSA9PiB7XG4gICAgICBjb25zdCBmb3JtYXR0ZXIgPSBjcmVhdGVGb3JtYXR0ZXI8YW55PignaHVtYW4nKTtcbiAgICAgIGV4cGVjdChmb3JtYXR0ZXIpLnRvQmVJbnN0YW5jZU9mKEh1bWFuRm9ybWF0dGVyKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgY3JlYXRlIEh1bWFuRm9ybWF0dGVyIGJ5IGRlZmF1bHQnLCAoKSA9PiB7XG4gICAgICBjb25zdCBmb3JtYXR0ZXIgPSBjcmVhdGVGb3JtYXR0ZXI8YW55PigpO1xuICAgICAgZXhwZWN0KGZvcm1hdHRlcikudG9CZUluc3RhbmNlT2YoSHVtYW5Gb3JtYXR0ZXIpO1xuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgnZm9ybWF0T3V0cHV0JywgKCkgPT4ge1xuICAgIGl0KCdzaG91bGQgZm9ybWF0IGRhdGEgdXNpbmcgdGhlIHNwZWNpZmllZCBmb3JtYXR0ZXInLCAoKSA9PiB7XG4gICAgICBjb25zdCBkYXRhID0geyBpZDogMTIzLCBuYW1lOiAnVGVzdCcgfTtcbiAgICAgIGV4cGVjdChmb3JtYXRPdXRwdXQoZGF0YSwgJ2pzb24nKSkudG9CZShKU09OLnN0cmluZ2lmeShkYXRhLCBudWxsLCAyKSk7XG4gICAgICBleHBlY3QoZm9ybWF0T3V0cHV0KGRhdGEsICdtaW5pbWFsJykpLnRvQmUoJzEyMycpO1xuICAgICAgZXhwZWN0KGZvcm1hdE91dHB1dChkYXRhLCAnaHVtYW4nKSkudG9CZSgnaWQ6IDEyM1xcbm5hbWU6IFRlc3QnKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgdXNlIEh1bWFuRm9ybWF0dGVyIGJ5IGRlZmF1bHQnLCAoKSA9PiB7XG4gICAgICBjb25zdCBkYXRhID0geyBpZDogMTIzLCBuYW1lOiAnVGVzdCcgfTtcbiAgICAgIGV4cGVjdChmb3JtYXRPdXRwdXQoZGF0YSkpLnRvQmUoJ2lkOiAxMjNcXG5uYW1lOiBUZXN0Jyk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGhhbmRsZSBsYXJnZSBkYXRhc2V0cycsICgpID0+IHtcbiAgICAgIGNvbnN0IGxhcmdlRGF0YXNldCA9IEFycmF5KDEwMCkuZmlsbCgwKS5tYXAoKF8sIGkpID0+ICh7IGlkOiBpLCBuYW1lOiBgSXRlbSAke2l9YCB9KSk7XG4gICAgICBjb25zdCBqc29uUmVzdWx0ID0gZm9ybWF0T3V0cHV0KGxhcmdlRGF0YXNldCwgJ2pzb24nKTtcbiAgICAgIGNvbnN0IG1pbmltYWxSZXN1bHQgPSBmb3JtYXRPdXRwdXQobGFyZ2VEYXRhc2V0LCAnbWluaW1hbCcpO1xuICAgICAgY29uc3QgaHVtYW5SZXN1bHQgPSBmb3JtYXRPdXRwdXQobGFyZ2VEYXRhc2V0LCAnaHVtYW4nKTtcbiAgICAgIFxuICAgICAgZXhwZWN0KGpzb25SZXN1bHQpLnRvQ29udGFpbignXCJpZFwiOiAwJyk7XG4gICAgICBleHBlY3QoanNvblJlc3VsdCkudG9Db250YWluKCdcImlkXCI6IDk5Jyk7XG4gICAgICBcbiAgICAgIGV4cGVjdChtaW5pbWFsUmVzdWx0LnNwbGl0KCdcXG4nKS5sZW5ndGgpLnRvQmUoMTAwKTtcbiAgICAgIGV4cGVjdChtaW5pbWFsUmVzdWx0KS50b0NvbnRhaW4oJzAnKTtcbiAgICAgIGV4cGVjdChtaW5pbWFsUmVzdWx0KS50b0NvbnRhaW4oJzk5Jyk7XG4gICAgICBcbiAgICAgIGV4cGVjdChodW1hblJlc3VsdCkudG9Db250YWluKCdpZDogMCcpO1xuICAgICAgZXhwZWN0KGh1bWFuUmVzdWx0KS50b0NvbnRhaW4oJ2lkOiA5OScpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBoYW5kbGUgc3BlY2lhbCBjaGFyYWN0ZXJzIGluIGRhdGEnLCAoKSA9PiB7XG4gICAgICBjb25zdCBkYXRhV2l0aFNwZWNpYWxDaGFycyA9IHtcbiAgICAgICAgdGl0bGU6ICdTcGVjaWFsOiBcInF1b3Rlc1wiLCBcXCdhcG9zdHJvcGhlc1xcJywgJmFtcDsgbW9yZSEnLFxuICAgICAgICBkZXNjcmlwdGlvbjogJzwgPiAmIFwiIFxcJyBcXG4gXFx0IFxcXFwgLydcbiAgICAgIH07XG4gICAgICBcbiAgICAgIC8vIFRlc3QgdGhhdCBlYWNoIGZvcm1hdHRlciBwcm9wZXJseSBoYW5kbGVzIHNwZWNpYWwgY2hhcmFjdGVyc1xuICAgICAgY29uc3QganNvblJlc3VsdCA9IGZvcm1hdE91dHB1dChkYXRhV2l0aFNwZWNpYWxDaGFycywgJ2pzb24nKTtcbiAgICAgIGNvbnN0IGh1bWFuUmVzdWx0ID0gZm9ybWF0T3V0cHV0KGRhdGFXaXRoU3BlY2lhbENoYXJzLCAnaHVtYW4nKTtcbiAgICAgIFxuICAgICAgZXhwZWN0KGpzb25SZXN1bHQpLnRvQ29udGFpbignU3BlY2lhbDogXFxcXFwicXVvdGVzXFxcXFwiJyk7XG4gICAgICBleHBlY3QoanNvblJlc3VsdCkudG9Db250YWluKCdcXCdhcG9zdHJvcGhlc1xcJycpO1xuICAgICAgZXhwZWN0KGpzb25SZXN1bHQpLnRvQ29udGFpbignJmFtcDsgbW9yZSEnKTtcbiAgICAgIFxuICAgICAgZXhwZWN0KGh1bWFuUmVzdWx0KS50b0NvbnRhaW4oJ3RpdGxlOiBTcGVjaWFsOiBcInF1b3Rlc1wiLCBcXCdhcG9zdHJvcGhlc1xcJywgJmFtcDsgbW9yZSEnKTtcbiAgICAgIGV4cGVjdChodW1hblJlc3VsdCkudG9Db250YWluKCdkZXNjcmlwdGlvbjogPCA+ICYgXCIgXFwnIFxcbiBcXHQgXFxcXCAvJyk7XG4gICAgfSk7XG4gIH0pO1xufSk7ICJdLCJ2ZXJzaW9uIjozfQ==
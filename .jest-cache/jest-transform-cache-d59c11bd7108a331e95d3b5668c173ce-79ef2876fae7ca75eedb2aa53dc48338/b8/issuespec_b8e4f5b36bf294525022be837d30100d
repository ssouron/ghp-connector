a196ef35a177f33f9e9ff4bcbf2640d1
"use strict";
/**
 * Tests for issue commands
 */
Object.defineProperty(exports, "__esModule", { value: true });
// Mock dependencies
jest.mock('../lib', () => {
    const originalLib = jest.requireActual('../lib');
    return {
        ...originalLib,
        GitHubClient: {
            fromConfig: jest.fn().mockReturnValue({
                listIssues: jest.fn().mockResolvedValue((0, mock_github_1.createMockIssueList)(3)),
                getIssue: jest.fn().mockImplementation((id) => Promise.resolve((0, mock_github_1.createMockIssueList)(1)[0])),
                createIssue: jest.fn().mockImplementation((title, body, options) => Promise.resolve((0, mock_github_1.createMockIssueList)(1)[0])),
                updateIssue: jest.fn().mockImplementation((id, options) => Promise.resolve((0, mock_github_1.createMockIssueList)(1)[0])),
            })
        },
        loadConfig: jest.fn().mockReturnValue({
            github: {
                owner: 'test-owner',
                repo: 'test-repo'
            },
            defaults: {
                issues: {
                    state: 'open'
                }
            }
        }),
        formatOutput: jest.fn().mockImplementation((data) => JSON.stringify(data)),
        wrapWithErrorHandler: jest.fn().mockImplementation((fn) => fn),
        cmdArgsToConfig: jest.fn().mockReturnValue({})
    };
});
const commander_1 = require("commander");
const issue_1 = require("./issue");
const mock_github_1 = require("../lib/test-helpers/mock-github");
// Spy on console.log
const consoleLogSpy = jest.spyOn(console, 'log').mockImplementation();
describe('Issue Commands', () => {
    let program;
    beforeEach(() => {
        // Reset mocks
        jest.clearAllMocks();
        // Create a new Command instance
        program = new commander_1.Command();
        (0, issue_1.registerIssueCommands)(program);
    });
    afterAll(() => {
        // Restore console.log
        consoleLogSpy.mockRestore();
    });
    describe('issue list', () => {
        it('devrait enregistrer la commande list', () => {
            const listCommand = program.commands[0].commands.find(cmd => cmd.name() === 'list');
            expect(listCommand).toBeDefined();
            expect(listCommand?.description()).toBe('List issues in a repository');
        });
        it('devrait contenir les options appropriÃ©es', () => {
            const listCommand = program.commands[0].commands.find(cmd => cmd.name() === 'list');
            const options = listCommand?.options.map(opt => opt.flags);
            expect(options).toContain('-s, --state <state>');
            expect(options).toContain('-l, --limit <limit>');
            expect(options).toContain('-a, --assignee <assignee>');
            expect(options).toContain('-L, --label <labels>');
        });
    });
    describe('issue get', () => {
        it('devrait enregistrer la commande get', () => {
            const getCommand = program.commands[0].commands.find(cmd => cmd.name() === 'get');
            expect(getCommand).toBeDefined();
            expect(getCommand?.description()).toBe('Get details of a specific issue');
        });
    });
    describe('issue create', () => {
        it('devrait enregistrer la commande create', () => {
            const createCommand = program.commands[0].commands.find(cmd => cmd.name() === 'create');
            expect(createCommand).toBeDefined();
            expect(createCommand?.description()).toBe('Create a new issue');
        });
        it('devrait exiger un titre', () => {
            const createCommand = program.commands[0].commands.find(cmd => cmd.name() === 'create');
            const titleOption = createCommand?.options.find(opt => opt.flags.includes('--title'));
            expect(titleOption).toBeDefined();
            expect(titleOption?.required).toBe(true);
        });
    });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiL1VzZXJzL3N0ZXBoYW5lc291cm9uL2Rldi9iZWRkeS1ieWUtc3Rvcmllcy9naHAtY29ubmVjdG9yL3NyYy9jb21tYW5kcy9pc3N1ZS5zcGVjLnRzIiwibWFwcGluZ3MiOiI7QUFBQTs7R0FFRzs7QUFNSCxvQkFBb0I7QUFDcEIsSUFBSSxDQUFDLElBQUksQ0FBQyxRQUFRLEVBQUUsR0FBRyxFQUFFO0lBQ3ZCLE1BQU0sV0FBVyxHQUFHLElBQUksQ0FBQyxhQUFhLENBQUMsUUFBUSxDQUFDLENBQUM7SUFDakQsT0FBTztRQUNMLEdBQUcsV0FBVztRQUNkLFlBQVksRUFBRTtZQUNaLFVBQVUsRUFBRSxJQUFJLENBQUMsRUFBRSxFQUFFLENBQUMsZUFBZSxDQUFDO2dCQUNwQyxVQUFVLEVBQUUsSUFBSSxDQUFDLEVBQUUsRUFBRSxDQUFDLGlCQUFpQixDQUFDLElBQUEsaUNBQW1CLEVBQUMsQ0FBQyxDQUFDLENBQUM7Z0JBQy9ELFFBQVEsRUFBRSxJQUFJLENBQUMsRUFBRSxFQUFFLENBQUMsa0JBQWtCLENBQUMsQ0FBQyxFQUFFLEVBQUUsRUFBRSxDQUM1QyxPQUFPLENBQUMsT0FBTyxDQUFDLElBQUEsaUNBQW1CLEVBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQztnQkFDN0MsV0FBVyxFQUFFLElBQUksQ0FBQyxFQUFFLEVBQUUsQ0FBQyxrQkFBa0IsQ0FBQyxDQUFDLEtBQUssRUFBRSxJQUFJLEVBQUUsT0FBTyxFQUFFLEVBQUUsQ0FDakUsT0FBTyxDQUFDLE9BQU8sQ0FBQyxJQUFBLGlDQUFtQixFQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUM7Z0JBQzdDLFdBQVcsRUFBRSxJQUFJLENBQUMsRUFBRSxFQUFFLENBQUMsa0JBQWtCLENBQUMsQ0FBQyxFQUFFLEVBQUUsT0FBTyxFQUFFLEVBQUUsQ0FDeEQsT0FBTyxDQUFDLE9BQU8sQ0FBQyxJQUFBLGlDQUFtQixFQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUM7YUFDOUMsQ0FBQztTQUNIO1FBQ0QsVUFBVSxFQUFFLElBQUksQ0FBQyxFQUFFLEVBQUUsQ0FBQyxlQUFlLENBQUM7WUFDcEMsTUFBTSxFQUFFO2dCQUNOLEtBQUssRUFBRSxZQUFZO2dCQUNuQixJQUFJLEVBQUUsV0FBVzthQUNsQjtZQUNELFFBQVEsRUFBRTtnQkFDUixNQUFNLEVBQUU7b0JBQ04sS0FBSyxFQUFFLE1BQU07aUJBQ2Q7YUFDRjtTQUNGLENBQUM7UUFDRixZQUFZLEVBQUUsSUFBSSxDQUFDLEVBQUUsRUFBRSxDQUFDLGtCQUFrQixDQUFDLENBQUMsSUFBSSxFQUFFLEVBQUUsQ0FBQyxJQUFJLENBQUMsU0FBUyxDQUFDLElBQUksQ0FBQyxDQUFDO1FBQzFFLG9CQUFvQixFQUFFLElBQUksQ0FBQyxFQUFFLEVBQUUsQ0FBQyxrQkFBa0IsQ0FBQyxDQUFDLEVBQUUsRUFBRSxFQUFFLENBQUMsRUFBRSxDQUFDO1FBQzlELGVBQWUsRUFBRSxJQUFJLENBQUMsRUFBRSxFQUFFLENBQUMsZUFBZSxDQUFDLEVBQUUsQ0FBQztLQUMvQyxDQUFDO0FBQ0osQ0FBQyxDQUFDLENBQUM7QUFuQ0gseUNBQW9DO0FBQ3BDLG1DQUFnRDtBQUNoRCxpRUFBc0U7QUFtQ3RFLHFCQUFxQjtBQUNyQixNQUFNLGFBQWEsR0FBRyxJQUFJLENBQUMsS0FBSyxDQUFDLE9BQU8sRUFBRSxLQUFLLENBQUMsQ0FBQyxrQkFBa0IsRUFBRSxDQUFDO0FBRXRFLFFBQVEsQ0FBQyxnQkFBZ0IsRUFBRSxHQUFHLEVBQUU7SUFDOUIsSUFBSSxPQUFnQixDQUFDO0lBRXJCLFVBQVUsQ0FBQyxHQUFHLEVBQUU7UUFDZCxjQUFjO1FBQ2QsSUFBSSxDQUFDLGFBQWEsRUFBRSxDQUFDO1FBRXJCLGdDQUFnQztRQUNoQyxPQUFPLEdBQUcsSUFBSSxtQkFBTyxFQUFFLENBQUM7UUFDeEIsSUFBQSw2QkFBcUIsRUFBQyxPQUFPLENBQUMsQ0FBQztJQUNqQyxDQUFDLENBQUMsQ0FBQztJQUVILFFBQVEsQ0FBQyxHQUFHLEVBQUU7UUFDWixzQkFBc0I7UUFDdEIsYUFBYSxDQUFDLFdBQVcsRUFBRSxDQUFDO0lBQzlCLENBQUMsQ0FBQyxDQUFDO0lBRUgsUUFBUSxDQUFDLFlBQVksRUFBRSxHQUFHLEVBQUU7UUFDMUIsRUFBRSxDQUFDLHNDQUFzQyxFQUFFLEdBQUcsRUFBRTtZQUM5QyxNQUFNLFdBQVcsR0FBRyxPQUFPLENBQUMsUUFBUSxDQUFDLENBQUMsQ0FBQyxDQUFDLFFBQVEsQ0FBQyxJQUFJLENBQUMsR0FBRyxDQUFDLEVBQUUsQ0FBQyxHQUFHLENBQUMsSUFBSSxFQUFFLEtBQUssTUFBTSxDQUFDLENBQUM7WUFDcEYsTUFBTSxDQUFDLFdBQVcsQ0FBQyxDQUFDLFdBQVcsRUFBRSxDQUFDO1lBQ2xDLE1BQU0sQ0FBQyxXQUFXLEVBQUUsV0FBVyxFQUFFLENBQUMsQ0FBQyxJQUFJLENBQUMsNkJBQTZCLENBQUMsQ0FBQztRQUN6RSxDQUFDLENBQUMsQ0FBQztRQUVILEVBQUUsQ0FBQywwQ0FBMEMsRUFBRSxHQUFHLEVBQUU7WUFDbEQsTUFBTSxXQUFXLEdBQUcsT0FBTyxDQUFDLFFBQVEsQ0FBQyxDQUFDLENBQUMsQ0FBQyxRQUFRLENBQUMsSUFBSSxDQUFDLEdBQUcsQ0FBQyxFQUFFLENBQUMsR0FBRyxDQUFDLElBQUksRUFBRSxLQUFLLE1BQU0sQ0FBQyxDQUFDO1lBQ3BGLE1BQU0sT0FBTyxHQUFHLFdBQVcsRUFBRSxPQUFPLENBQUMsR0FBRyxDQUFDLEdBQUcsQ0FBQyxFQUFFLENBQUMsR0FBRyxDQUFDLEtBQUssQ0FBQyxDQUFDO1lBRTNELE1BQU0sQ0FBQyxPQUFPLENBQUMsQ0FBQyxTQUFTLENBQUMscUJBQXFCLENBQUMsQ0FBQztZQUNqRCxNQUFNLENBQUMsT0FBTyxDQUFDLENBQUMsU0FBUyxDQUFDLHFCQUFxQixDQUFDLENBQUM7WUFDakQsTUFBTSxDQUFDLE9BQU8sQ0FBQyxDQUFDLFNBQVMsQ0FBQywyQkFBMkIsQ0FBQyxDQUFDO1lBQ3ZELE1BQU0sQ0FBQyxPQUFPLENBQUMsQ0FBQyxTQUFTLENBQUMsc0JBQXNCLENBQUMsQ0FBQztRQUNwRCxDQUFDLENBQUMsQ0FBQztJQUNMLENBQUMsQ0FBQyxDQUFDO0lBRUgsUUFBUSxDQUFDLFdBQVcsRUFBRSxHQUFHLEVBQUU7UUFDekIsRUFBRSxDQUFDLHFDQUFxQyxFQUFFLEdBQUcsRUFBRTtZQUM3QyxNQUFNLFVBQVUsR0FBRyxPQUFPLENBQUMsUUFBUSxDQUFDLENBQUMsQ0FBQyxDQUFDLFFBQVEsQ0FBQyxJQUFJLENBQUMsR0FBRyxDQUFDLEVBQUUsQ0FBQyxHQUFHLENBQUMsSUFBSSxFQUFFLEtBQUssS0FBSyxDQUFDLENBQUM7WUFDbEYsTUFBTSxDQUFDLFVBQVUsQ0FBQyxDQUFDLFdBQVcsRUFBRSxDQUFDO1lBQ2pDLE1BQU0sQ0FBQyxVQUFVLEVBQUUsV0FBVyxFQUFFLENBQUMsQ0FBQyxJQUFJLENBQUMsaUNBQWlDLENBQUMsQ0FBQztRQUM1RSxDQUFDLENBQUMsQ0FBQztJQUNMLENBQUMsQ0FBQyxDQUFDO0lBRUgsUUFBUSxDQUFDLGNBQWMsRUFBRSxHQUFHLEVBQUU7UUFDNUIsRUFBRSxDQUFDLHdDQUF3QyxFQUFFLEdBQUcsRUFBRTtZQUNoRCxNQUFNLGFBQWEsR0FBRyxPQUFPLENBQUMsUUFBUSxDQUFDLENBQUMsQ0FBQyxDQUFDLFFBQVEsQ0FBQyxJQUFJLENBQUMsR0FBRyxDQUFDLEVBQUUsQ0FBQyxHQUFHLENBQUMsSUFBSSxFQUFFLEtBQUssUUFBUSxDQUFDLENBQUM7WUFDeEYsTUFBTSxDQUFDLGFBQWEsQ0FBQyxDQUFDLFdBQVcsRUFBRSxDQUFDO1lBQ3BDLE1BQU0sQ0FBQyxhQUFhLEVBQUUsV0FBVyxFQUFFLENBQUMsQ0FBQyxJQUFJLENBQUMsb0JBQW9CLENBQUMsQ0FBQztRQUNsRSxDQUFDLENBQUMsQ0FBQztRQUVILEVBQUUsQ0FBQyx5QkFBeUIsRUFBRSxHQUFHLEVBQUU7WUFDakMsTUFBTSxhQUFhLEdBQUcsT0FBTyxDQUFDLFFBQVEsQ0FBQyxDQUFDLENBQUMsQ0FBQyxRQUFRLENBQUMsSUFBSSxDQUFDLEdBQUcsQ0FBQyxFQUFFLENBQUMsR0FBRyxDQUFDLElBQUksRUFBRSxLQUFLLFFBQVEsQ0FBQyxDQUFDO1lBQ3hGLE1BQU0sV0FBVyxHQUFHLGFBQWEsRUFBRSxPQUFPLENBQUMsSUFBSSxDQUFDLEdBQUcsQ0FBQyxFQUFFLENBQUMsR0FBRyxDQUFDLEtBQUssQ0FBQyxRQUFRLENBQUMsU0FBUyxDQUFDLENBQUMsQ0FBQztZQUV0RixNQUFNLENBQUMsV0FBVyxDQUFDLENBQUMsV0FBVyxFQUFFLENBQUM7WUFDbEMsTUFBTSxDQUFDLFdBQVcsRUFBRSxRQUFRLENBQUMsQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLENBQUM7UUFDM0MsQ0FBQyxDQUFDLENBQUM7SUFDTCxDQUFDLENBQUMsQ0FBQztBQUNMLENBQUMsQ0FBQyxDQUFDIiwibmFtZXMiOltdLCJzb3VyY2VzIjpbIi9Vc2Vycy9zdGVwaGFuZXNvdXJvbi9kZXYvYmVkZHktYnllLXN0b3JpZXMvZ2hwLWNvbm5lY3Rvci9zcmMvY29tbWFuZHMvaXNzdWUuc3BlYy50cyJdLCJzb3VyY2VzQ29udGVudCI6WyIvKipcbiAqIFRlc3RzIGZvciBpc3N1ZSBjb21tYW5kc1xuICovXG5cbmltcG9ydCB7IENvbW1hbmQgfSBmcm9tICdjb21tYW5kZXInO1xuaW1wb3J0IHsgcmVnaXN0ZXJJc3N1ZUNvbW1hbmRzIH0gZnJvbSAnLi9pc3N1ZSc7XG5pbXBvcnQgeyBjcmVhdGVNb2NrSXNzdWVMaXN0IH0gZnJvbSAnLi4vbGliL3Rlc3QtaGVscGVycy9tb2NrLWdpdGh1Yic7XG5cbi8vIE1vY2sgZGVwZW5kZW5jaWVzXG5qZXN0Lm1vY2soJy4uL2xpYicsICgpID0+IHtcbiAgY29uc3Qgb3JpZ2luYWxMaWIgPSBqZXN0LnJlcXVpcmVBY3R1YWwoJy4uL2xpYicpO1xuICByZXR1cm4ge1xuICAgIC4uLm9yaWdpbmFsTGliLFxuICAgIEdpdEh1YkNsaWVudDoge1xuICAgICAgZnJvbUNvbmZpZzogamVzdC5mbigpLm1vY2tSZXR1cm5WYWx1ZSh7XG4gICAgICAgIGxpc3RJc3N1ZXM6IGplc3QuZm4oKS5tb2NrUmVzb2x2ZWRWYWx1ZShjcmVhdGVNb2NrSXNzdWVMaXN0KDMpKSxcbiAgICAgICAgZ2V0SXNzdWU6IGplc3QuZm4oKS5tb2NrSW1wbGVtZW50YXRpb24oKGlkKSA9PiBcbiAgICAgICAgICBQcm9taXNlLnJlc29sdmUoY3JlYXRlTW9ja0lzc3VlTGlzdCgxKVswXSkpLFxuICAgICAgICBjcmVhdGVJc3N1ZTogamVzdC5mbigpLm1vY2tJbXBsZW1lbnRhdGlvbigodGl0bGUsIGJvZHksIG9wdGlvbnMpID0+IFxuICAgICAgICAgIFByb21pc2UucmVzb2x2ZShjcmVhdGVNb2NrSXNzdWVMaXN0KDEpWzBdKSksXG4gICAgICAgIHVwZGF0ZUlzc3VlOiBqZXN0LmZuKCkubW9ja0ltcGxlbWVudGF0aW9uKChpZCwgb3B0aW9ucykgPT4gXG4gICAgICAgICAgUHJvbWlzZS5yZXNvbHZlKGNyZWF0ZU1vY2tJc3N1ZUxpc3QoMSlbMF0pKSxcbiAgICAgIH0pXG4gICAgfSxcbiAgICBsb2FkQ29uZmlnOiBqZXN0LmZuKCkubW9ja1JldHVyblZhbHVlKHtcbiAgICAgIGdpdGh1Yjoge1xuICAgICAgICBvd25lcjogJ3Rlc3Qtb3duZXInLFxuICAgICAgICByZXBvOiAndGVzdC1yZXBvJ1xuICAgICAgfSxcbiAgICAgIGRlZmF1bHRzOiB7XG4gICAgICAgIGlzc3Vlczoge1xuICAgICAgICAgIHN0YXRlOiAnb3BlbidcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH0pLFxuICAgIGZvcm1hdE91dHB1dDogamVzdC5mbigpLm1vY2tJbXBsZW1lbnRhdGlvbigoZGF0YSkgPT4gSlNPTi5zdHJpbmdpZnkoZGF0YSkpLFxuICAgIHdyYXBXaXRoRXJyb3JIYW5kbGVyOiBqZXN0LmZuKCkubW9ja0ltcGxlbWVudGF0aW9uKChmbikgPT4gZm4pLFxuICAgIGNtZEFyZ3NUb0NvbmZpZzogamVzdC5mbigpLm1vY2tSZXR1cm5WYWx1ZSh7fSlcbiAgfTtcbn0pO1xuXG4vLyBTcHkgb24gY29uc29sZS5sb2dcbmNvbnN0IGNvbnNvbGVMb2dTcHkgPSBqZXN0LnNweU9uKGNvbnNvbGUsICdsb2cnKS5tb2NrSW1wbGVtZW50YXRpb24oKTtcblxuZGVzY3JpYmUoJ0lzc3VlIENvbW1hbmRzJywgKCkgPT4ge1xuICBsZXQgcHJvZ3JhbTogQ29tbWFuZDtcbiAgXG4gIGJlZm9yZUVhY2goKCkgPT4ge1xuICAgIC8vIFJlc2V0IG1vY2tzXG4gICAgamVzdC5jbGVhckFsbE1vY2tzKCk7XG4gICAgXG4gICAgLy8gQ3JlYXRlIGEgbmV3IENvbW1hbmQgaW5zdGFuY2VcbiAgICBwcm9ncmFtID0gbmV3IENvbW1hbmQoKTtcbiAgICByZWdpc3Rlcklzc3VlQ29tbWFuZHMocHJvZ3JhbSk7XG4gIH0pO1xuICBcbiAgYWZ0ZXJBbGwoKCkgPT4ge1xuICAgIC8vIFJlc3RvcmUgY29uc29sZS5sb2dcbiAgICBjb25zb2xlTG9nU3B5Lm1vY2tSZXN0b3JlKCk7XG4gIH0pO1xuICBcbiAgZGVzY3JpYmUoJ2lzc3VlIGxpc3QnLCAoKSA9PiB7XG4gICAgaXQoJ2RldnJhaXQgZW5yZWdpc3RyZXIgbGEgY29tbWFuZGUgbGlzdCcsICgpID0+IHtcbiAgICAgIGNvbnN0IGxpc3RDb21tYW5kID0gcHJvZ3JhbS5jb21tYW5kc1swXS5jb21tYW5kcy5maW5kKGNtZCA9PiBjbWQubmFtZSgpID09PSAnbGlzdCcpO1xuICAgICAgZXhwZWN0KGxpc3RDb21tYW5kKS50b0JlRGVmaW5lZCgpO1xuICAgICAgZXhwZWN0KGxpc3RDb21tYW5kPy5kZXNjcmlwdGlvbigpKS50b0JlKCdMaXN0IGlzc3VlcyBpbiBhIHJlcG9zaXRvcnknKTtcbiAgICB9KTtcbiAgICBcbiAgICBpdCgnZGV2cmFpdCBjb250ZW5pciBsZXMgb3B0aW9ucyBhcHByb3ByacOpZXMnLCAoKSA9PiB7XG4gICAgICBjb25zdCBsaXN0Q29tbWFuZCA9IHByb2dyYW0uY29tbWFuZHNbMF0uY29tbWFuZHMuZmluZChjbWQgPT4gY21kLm5hbWUoKSA9PT0gJ2xpc3QnKTtcbiAgICAgIGNvbnN0IG9wdGlvbnMgPSBsaXN0Q29tbWFuZD8ub3B0aW9ucy5tYXAob3B0ID0+IG9wdC5mbGFncyk7XG4gICAgICBcbiAgICAgIGV4cGVjdChvcHRpb25zKS50b0NvbnRhaW4oJy1zLCAtLXN0YXRlIDxzdGF0ZT4nKTtcbiAgICAgIGV4cGVjdChvcHRpb25zKS50b0NvbnRhaW4oJy1sLCAtLWxpbWl0IDxsaW1pdD4nKTtcbiAgICAgIGV4cGVjdChvcHRpb25zKS50b0NvbnRhaW4oJy1hLCAtLWFzc2lnbmVlIDxhc3NpZ25lZT4nKTtcbiAgICAgIGV4cGVjdChvcHRpb25zKS50b0NvbnRhaW4oJy1MLCAtLWxhYmVsIDxsYWJlbHM+Jyk7XG4gICAgfSk7XG4gIH0pO1xuICBcbiAgZGVzY3JpYmUoJ2lzc3VlIGdldCcsICgpID0+IHtcbiAgICBpdCgnZGV2cmFpdCBlbnJlZ2lzdHJlciBsYSBjb21tYW5kZSBnZXQnLCAoKSA9PiB7XG4gICAgICBjb25zdCBnZXRDb21tYW5kID0gcHJvZ3JhbS5jb21tYW5kc1swXS5jb21tYW5kcy5maW5kKGNtZCA9PiBjbWQubmFtZSgpID09PSAnZ2V0Jyk7XG4gICAgICBleHBlY3QoZ2V0Q29tbWFuZCkudG9CZURlZmluZWQoKTtcbiAgICAgIGV4cGVjdChnZXRDb21tYW5kPy5kZXNjcmlwdGlvbigpKS50b0JlKCdHZXQgZGV0YWlscyBvZiBhIHNwZWNpZmljIGlzc3VlJyk7XG4gICAgfSk7XG4gIH0pO1xuICBcbiAgZGVzY3JpYmUoJ2lzc3VlIGNyZWF0ZScsICgpID0+IHtcbiAgICBpdCgnZGV2cmFpdCBlbnJlZ2lzdHJlciBsYSBjb21tYW5kZSBjcmVhdGUnLCAoKSA9PiB7XG4gICAgICBjb25zdCBjcmVhdGVDb21tYW5kID0gcHJvZ3JhbS5jb21tYW5kc1swXS5jb21tYW5kcy5maW5kKGNtZCA9PiBjbWQubmFtZSgpID09PSAnY3JlYXRlJyk7XG4gICAgICBleHBlY3QoY3JlYXRlQ29tbWFuZCkudG9CZURlZmluZWQoKTtcbiAgICAgIGV4cGVjdChjcmVhdGVDb21tYW5kPy5kZXNjcmlwdGlvbigpKS50b0JlKCdDcmVhdGUgYSBuZXcgaXNzdWUnKTtcbiAgICB9KTtcbiAgICBcbiAgICBpdCgnZGV2cmFpdCBleGlnZXIgdW4gdGl0cmUnLCAoKSA9PiB7XG4gICAgICBjb25zdCBjcmVhdGVDb21tYW5kID0gcHJvZ3JhbS5jb21tYW5kc1swXS5jb21tYW5kcy5maW5kKGNtZCA9PiBjbWQubmFtZSgpID09PSAnY3JlYXRlJyk7XG4gICAgICBjb25zdCB0aXRsZU9wdGlvbiA9IGNyZWF0ZUNvbW1hbmQ/Lm9wdGlvbnMuZmluZChvcHQgPT4gb3B0LmZsYWdzLmluY2x1ZGVzKCctLXRpdGxlJykpO1xuICAgICAgXG4gICAgICBleHBlY3QodGl0bGVPcHRpb24pLnRvQmVEZWZpbmVkKCk7XG4gICAgICBleHBlY3QodGl0bGVPcHRpb24/LnJlcXVpcmVkKS50b0JlKHRydWUpO1xuICAgIH0pO1xuICB9KTtcbn0pOyAiXSwidmVyc2lvbiI6M30=
b6f5138e5e74f4f81125a83fc210f75d
"use strict";
/**
 * Unit tests for error handling module
 */
Object.defineProperty(exports, "__esModule", { value: true });
const index_1 = require("./index");
describe('Error Types', () => {
    describe('GHPError', () => {
        it('should create a base error with default exit code', () => {
            const error = new index_1.GHPError('Base error message');
            expect(error).toBeInstanceOf(Error);
            expect(error).toBeInstanceOf(index_1.GHPError);
            expect(error.message).toBe('Base error message');
            expect(error.name).toBe('GHPError');
            expect(error.exitCode).toBe(index_1.ExitCode.GeneralError);
        });
        it('should create a base error with custom exit code', () => {
            const error = new index_1.GHPError('Base error message', index_1.ExitCode.NotFoundError);
            expect(error.exitCode).toBe(index_1.ExitCode.NotFoundError);
        });
    });
    describe('ValidationError', () => {
        it('should create a validation error with correct exit code', () => {
            const error = new index_1.ValidationError('Invalid input');
            expect(error).toBeInstanceOf(index_1.GHPError);
            expect(error).toBeInstanceOf(index_1.ValidationError);
            expect(error.message).toBe('Invalid input');
            expect(error.name).toBe('ValidationError');
            expect(error.exitCode).toBe(index_1.ExitCode.ValidationError);
        });
    });
    describe('NetworkError', () => {
        it('should create a network error with correct exit code', () => {
            const error = new index_1.NetworkError('Connection failed');
            expect(error).toBeInstanceOf(index_1.GHPError);
            expect(error).toBeInstanceOf(index_1.NetworkError);
            expect(error.message).toBe('Connection failed');
            expect(error.name).toBe('NetworkError');
            expect(error.exitCode).toBe(index_1.ExitCode.NetworkError);
        });
    });
    describe('AuthenticationError', () => {
        it('should create an authentication error with correct exit code', () => {
            const error = new index_1.AuthenticationError('Invalid token');
            expect(error).toBeInstanceOf(index_1.GHPError);
            expect(error).toBeInstanceOf(index_1.AuthenticationError);
            expect(error.message).toBe('Invalid token');
            expect(error.name).toBe('AuthenticationError');
            expect(error.exitCode).toBe(index_1.ExitCode.AuthenticationError);
        });
    });
    describe('NotFoundError', () => {
        it('should create a not found error with correct exit code', () => {
            const error = new index_1.NotFoundError('Resource not found');
            expect(error).toBeInstanceOf(index_1.GHPError);
            expect(error).toBeInstanceOf(index_1.NotFoundError);
            expect(error.message).toBe('Resource not found');
            expect(error.name).toBe('NotFoundError');
            expect(error.exitCode).toBe(index_1.ExitCode.NotFoundError);
        });
    });
    describe('GitHubAPIError', () => {
        it('should create a GitHub API error with correct exit code', () => {
            const error = new index_1.GitHubAPIError('API rate limit exceeded');
            expect(error).toBeInstanceOf(index_1.GHPError);
            expect(error).toBeInstanceOf(index_1.GitHubAPIError);
            expect(error.message).toBe('API rate limit exceeded');
            expect(error.name).toBe('GitHubAPIError');
            expect(error.exitCode).toBe(index_1.ExitCode.GitHubAPIError);
            expect(error.response).toBeUndefined();
        });
        it('should create a GitHub API error with response data', () => {
            const responseData = { status: 403, message: 'Rate limit exceeded' };
            const error = new index_1.GitHubAPIError('API rate limit exceeded', responseData);
            expect(error.response).toBe(responseData);
        });
    });
    describe('ConfigurationError', () => {
        it('should create a configuration error with correct exit code', () => {
            const error = new index_1.ConfigurationError('Invalid configuration');
            expect(error).toBeInstanceOf(index_1.GHPError);
            expect(error).toBeInstanceOf(index_1.ConfigurationError);
            expect(error.message).toBe('Invalid configuration');
            expect(error.name).toBe('ConfigurationError');
            expect(error.exitCode).toBe(index_1.ExitCode.ConfigurationError);
        });
    });
});
describe('Error Handling Functions', () => {
    describe('handleError', () => {
        let consoleErrorSpy;
        let processExitSpy;
        beforeEach(() => {
            consoleErrorSpy = jest.spyOn(console, 'error').mockImplementation();
            processExitSpy = jest.spyOn(process, 'exit').mockImplementation((() => { }));
        });
        afterEach(() => {
            consoleErrorSpy.mockRestore();
            processExitSpy.mockRestore();
        });
        it('should handle GHPError correctly', () => {
            const error = new index_1.ValidationError('Invalid input');
            (0, index_1.handleError)(error);
            expect(consoleErrorSpy).toHaveBeenCalledWith('Error: Invalid input');
            expect(processExitSpy).toHaveBeenCalledWith(index_1.ExitCode.ValidationError);
        });
        it('should handle GitHubAPIError with response data in verbose mode', () => {
            const responseData = { status: 403, message: 'Rate limit exceeded' };
            const error = new index_1.GitHubAPIError('API error', responseData);
            (0, index_1.handleError)(error, true);
            expect(consoleErrorSpy).toHaveBeenCalledWith(expect.stringContaining('GitHub API Error: API error'));
            expect(consoleErrorSpy).toHaveBeenCalledWith(expect.stringContaining(JSON.stringify(responseData, null, 2)));
            expect(processExitSpy).toHaveBeenCalledWith(index_1.ExitCode.GitHubAPIError);
        });
        it('should handle GitHubAPIError without response data details in non-verbose mode', () => {
            const responseData = { status: 403, message: 'Rate limit exceeded' };
            const error = new index_1.GitHubAPIError('API error', responseData);
            (0, index_1.handleError)(error, false);
            expect(consoleErrorSpy).toHaveBeenCalledWith(expect.stringContaining('GitHub API Error: API error'));
            expect(consoleErrorSpy).not.toHaveBeenCalledWith(expect.stringContaining(JSON.stringify(responseData, null, 2)));
            expect(processExitSpy).toHaveBeenCalledWith(index_1.ExitCode.GitHubAPIError);
        });
        it('should handle non-GHPError with message', () => {
            const error = new Error('Standard error');
            (0, index_1.handleError)(error);
            expect(consoleErrorSpy).toHaveBeenCalledWith('Error: Standard error');
            expect(processExitSpy).toHaveBeenCalledWith(index_1.ExitCode.GeneralError);
        });
        it('should handle non-Error objects', () => {
            (0, index_1.handleError)('String error');
            expect(consoleErrorSpy).toHaveBeenCalledWith('Error: String error');
            expect(processExitSpy).toHaveBeenCalledWith(index_1.ExitCode.GeneralError);
        });
        it('should print stack trace in verbose mode', () => {
            const error = new Error('With stack');
            error.stack = 'Error: With stack\n    at file.js:1:1';
            (0, index_1.handleError)(error, true);
            expect(consoleErrorSpy).toHaveBeenCalledWith('\nStack trace:');
            expect(consoleErrorSpy).toHaveBeenCalledWith(error.stack);
        });
    });
    describe('wrapWithErrorHandler', () => {
        it('should return function result on success', async () => {
            // Créer une fonction qui retourne toujours une valeur de succès
            const successFn = async () => 'success';
            const wrapped = (0, index_1.wrapWithErrorHandler)(successFn);
            const result = await wrapped();
            expect(result).toBe('success');
        });
        it('should pass arguments correctly to the wrapped function', async () => {
            const argTestFn = async (a, b) => `${a}-${b}`;
            const wrapped = (0, index_1.wrapWithErrorHandler)(argTestFn);
            const result = await wrapped('test', 123);
            expect(result).toBe('test-123');
        });
        it('should handle errors with default verbose setting', async () => {
            // Espionner sans empêcher le comportement normal
            const consoleErrorSpy = jest.spyOn(console, 'error').mockImplementation();
            // Remplacer process.exit pour éviter qu'il ne termine le processus de test
            const originalExit = process.exit;
            process.exit = jest.fn();
            const errorFn = async () => {
                throw new index_1.ValidationError('Test validation error');
            };
            const wrapped = (0, index_1.wrapWithErrorHandler)(errorFn);
            // Exécuter la fonction mais ignorer l'erreur
            await wrapped().catch(() => { });
            expect(consoleErrorSpy).toHaveBeenCalledWith('Error: Test validation error');
            expect(process.exit).toHaveBeenCalledWith(index_1.ExitCode.ValidationError);
            // Restaurer les fonctions originales
            consoleErrorSpy.mockRestore();
            process.exit = originalExit;
        });
        it('should handle errors with verbose=true', async () => {
            const consoleErrorSpy = jest.spyOn(console, 'error').mockImplementation();
            // Remplacer process.exit
            const originalExit = process.exit;
            process.exit = jest.fn();
            const errorWithStackFn = async () => {
                const error = new Error('Error with stack');
                error.stack = 'Error: Error with stack\n    at file.js:1:1';
                throw error;
            };
            const wrapped = (0, index_1.wrapWithErrorHandler)(errorWithStackFn, true);
            // Exécuter la fonction mais ignorer l'erreur
            await wrapped().catch(() => { });
            expect(consoleErrorSpy).toHaveBeenCalledWith('\nStack trace:');
            expect(process.exit).toHaveBeenCalledWith(index_1.ExitCode.GeneralError);
            // Restaurer les fonctions originales
            consoleErrorSpy.mockRestore();
            process.exit = originalExit;
        });
    });
});
describe('Exit Codes', () => {
    it('should have correct exit code values', () => {
        expect(index_1.ExitCode.Success).toBe(0);
        expect(index_1.ExitCode.GeneralError).toBe(1);
        expect(index_1.ExitCode.ValidationError).toBe(2);
        expect(index_1.ExitCode.NetworkError).toBe(3);
        expect(index_1.ExitCode.AuthenticationError).toBe(4);
        expect(index_1.ExitCode.NotFoundError).toBe(5);
        expect(index_1.ExitCode.GitHubAPIError).toBe(6);
        expect(index_1.ExitCode.ConfigurationError).toBe(7);
    });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiL1VzZXJzL3N0ZXBoYW5lc291cm9uL2Rldi9iZWRkeS1ieWUtc3Rvcmllcy9naHAtY29ubmVjdG9yL3NyYy9saWIvZXJyb3JzL2luZGV4LnNwZWMudHMiLCJtYXBwaW5ncyI6IjtBQUFBOztHQUVHOztBQUVILG1DQVdpQjtBQUVqQixRQUFRLENBQUMsYUFBYSxFQUFFLEdBQUcsRUFBRTtJQUMzQixRQUFRLENBQUMsVUFBVSxFQUFFLEdBQUcsRUFBRTtRQUN4QixFQUFFLENBQUMsbURBQW1ELEVBQUUsR0FBRyxFQUFFO1lBQzNELE1BQU0sS0FBSyxHQUFHLElBQUksZ0JBQVEsQ0FBQyxvQkFBb0IsQ0FBQyxDQUFDO1lBQ2pELE1BQU0sQ0FBQyxLQUFLLENBQUMsQ0FBQyxjQUFjLENBQUMsS0FBSyxDQUFDLENBQUM7WUFDcEMsTUFBTSxDQUFDLEtBQUssQ0FBQyxDQUFDLGNBQWMsQ0FBQyxnQkFBUSxDQUFDLENBQUM7WUFDdkMsTUFBTSxDQUFDLEtBQUssQ0FBQyxPQUFPLENBQUMsQ0FBQyxJQUFJLENBQUMsb0JBQW9CLENBQUMsQ0FBQztZQUNqRCxNQUFNLENBQUMsS0FBSyxDQUFDLElBQUksQ0FBQyxDQUFDLElBQUksQ0FBQyxVQUFVLENBQUMsQ0FBQztZQUNwQyxNQUFNLENBQUMsS0FBSyxDQUFDLFFBQVEsQ0FBQyxDQUFDLElBQUksQ0FBQyxnQkFBUSxDQUFDLFlBQVksQ0FBQyxDQUFDO1FBQ3JELENBQUMsQ0FBQyxDQUFDO1FBRUgsRUFBRSxDQUFDLGtEQUFrRCxFQUFFLEdBQUcsRUFBRTtZQUMxRCxNQUFNLEtBQUssR0FBRyxJQUFJLGdCQUFRLENBQUMsb0JBQW9CLEVBQUUsZ0JBQVEsQ0FBQyxhQUFhLENBQUMsQ0FBQztZQUN6RSxNQUFNLENBQUMsS0FBSyxDQUFDLFFBQVEsQ0FBQyxDQUFDLElBQUksQ0FBQyxnQkFBUSxDQUFDLGFBQWEsQ0FBQyxDQUFDO1FBQ3RELENBQUMsQ0FBQyxDQUFDO0lBQ0wsQ0FBQyxDQUFDLENBQUM7SUFFSCxRQUFRLENBQUMsaUJBQWlCLEVBQUUs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SCxRQUFRLENBQUMsWUFBWSxFQUFFLEdBQUcsRUFBRTtJQUMxQixFQUFFLENBQUMsc0NBQXNDLEVBQUUsR0FBRyxFQUFFO1FBQzlDLE1BQU0sQ0FBQyxnQkFBUSxDQUFDLE9BQU8sQ0FBQyxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUMsQ0FBQztRQUNqQyxNQUFNLENBQUMsZ0JBQVEsQ0FBQyxZQUFZLENBQUMsQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDLENBQUM7UUFDdEMsTUFBTSxDQUFDLGdCQUFRLENBQUMsZUFBZSxDQUFDLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQyxDQUFDO1FBQ3pDLE1BQU0sQ0FBQyxnQkFBUSxDQUFDLFlBQVksQ0FBQyxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUMsQ0FBQztRQUN0QyxNQUFNLENBQUMsZ0JBQVEsQ0FBQyxtQkFBbUIsQ0FBQyxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUMsQ0FBQztRQUM3QyxNQUFNLENBQUMsZ0JBQVEsQ0FBQyxhQUFhLENBQUMsQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDLENBQUM7UUFDdkMsTUFBTSxDQUFDLGdCQUFRLENBQUMsY0FBYyxDQUFDLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQyxDQUFDO1FBQ3hDLE1BQU0sQ0FBQyxnQkFBUSxDQUFDLGtCQUFrQixDQUFDLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQyxDQUFDO0lBQzlDLENBQUMsQ0FBQyxDQUFDO0FBQ0wsQ0FBQyxDQUFDLENBQUMiLCJuYW1lcyI6W10sInNvdXJjZXMiOlsiL1VzZXJzL3N0ZXBoYW5lc291cm9uL2Rldi9iZWRkeS1ieWUtc3Rvcmllcy9naHAtY29ubmVjdG9yL3NyYy9saWIvZXJyb3JzL2luZGV4LnNwZWMudHMiXSwic291cmNlc0NvbnRlbnQiOlsiLyoqXG4gKiBVbml0IHRlc3RzIGZvciBlcnJvciBoYW5kbGluZyBtb2R1bGVcbiAqL1xuXG5pbXBvcnQgeyBcbiAgRXhpdENvZGUsXG4gIEdIUEVycm9yLCBcbiAgVmFsaWRhdGlvbkVycm9yLFxuICBOZXR3b3JrRXJyb3IsXG4gIEF1dGhlbnRpY2F0aW9uRXJyb3IsXG4gIE5vdEZvdW5kRXJyb3IsXG4gIEdpdEh1YkFQSUVycm9yLFxuICBDb25maWd1cmF0aW9uRXJyb3IsXG4gIGhhbmRsZUVycm9yLFxuICB3cmFwV2l0aEVycm9ySGFuZGxlclxufSBmcm9tICcuL2luZGV4JztcblxuZGVzY3JpYmUoJ0Vycm9yIFR5cGVzJywgKCkgPT4ge1xuICBkZXNjcmliZSgnR0hQRXJyb3InLCAoKSA9PiB7XG4gICAgaXQoJ3Nob3VsZCBjcmVhdGUgYSBiYXNlIGVycm9yIHdpdGggZGVmYXVsdCBleGl0IGNvZGUnLCAoKSA9PiB7XG4gICAgICBjb25zdCBlcnJvciA9IG5ldyBHSFBFcnJvcignQmFzZSBlcnJvciBtZXNzYWdlJyk7XG4gICAgICBleHBlY3QoZXJyb3IpLnRvQmVJbnN0YW5jZU9mKEVycm9yKTtcbiAgICAgIGV4cGVjdChlcnJvcikudG9CZUluc3RhbmNlT2YoR0hQRXJyb3IpO1xuICAgICAgZXhwZWN0KGVycm9yLm1lc3NhZ2UpLnRvQmUoJ0Jhc2UgZXJyb3IgbWVzc2FnZScpO1xuICAgICAgZXhwZWN0KGVycm9yLm5hbWUpLnRvQmUoJ0dIUEVycm9yJyk7XG4gICAgICBleHBlY3QoZXJyb3IuZXhpdENvZGUpLnRvQmUoRXhpdENvZGUuR2VuZXJhbEVycm9yKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgY3JlYXRlIGEgYmFzZSBlcnJvciB3aXRoIGN1c3RvbSBleGl0IGNvZGUnLCAoKSA9PiB7XG4gICAgICBjb25zdCBlcnJvciA9IG5ldyBHSFBFcnJvcignQmFzZSBlcnJvciBtZXNzYWdlJywgRXhpdENvZGUuTm90Rm91bmRFcnJvcik7XG4gICAgICBleHBlY3QoZXJyb3IuZXhpdENvZGUpLnRvQmUoRXhpdENvZGUuTm90Rm91bmRFcnJvcik7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdWYWxpZGF0aW9uRXJyb3InLCAoKSA9PiB7XG4gICAgaXQoJ3Nob3VsZCBjcmVhdGUgYSB2YWxpZGF0aW9uIGVycm9yIHdpdGggY29ycmVjdCBleGl0IGNvZGUnLCAoKSA9PiB7XG4gICAgICBjb25zdCBlcnJvciA9IG5ldyBWYWxpZGF0aW9uRXJyb3IoJ0ludmFsaWQgaW5wdXQnKTtcbiAgICAgIGV4cGVjdChlcnJvcikudG9CZUluc3RhbmNlT2YoR0hQRXJyb3IpO1xuICAgICAgZXhwZWN0KGVycm9yKS50b0JlSW5zdGFuY2VPZihWYWxpZGF0aW9uRXJyb3IpO1xuICAgICAgZXhwZWN0KGVycm9yLm1lc3NhZ2UpLnRvQmUoJ0ludmFsaWQgaW5wdXQnKTtcbiAgICAgIGV4cGVjdChlcnJvci5uYW1lKS50b0JlKCdWYWxpZGF0aW9uRXJyb3InKTtcbiAgICAgIGV4cGVjdChlcnJvci5leGl0Q29kZSkudG9CZShFeGl0Q29kZS5WYWxpZGF0aW9uRXJyb3IpO1xuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgnTmV0d29ya0Vycm9yJywgKCkgPT4ge1xuICAgIGl0KCdzaG91bGQgY3JlYXRlIGEgbmV0d29yayBlcnJvciB3aXRoIGNvcnJlY3QgZXhpdCBjb2RlJywgKCkgPT4ge1xuICAgICAgY29uc3QgZXJyb3IgPSBuZXcgTmV0d29ya0Vycm9yKCdDb25uZWN0aW9uIGZhaWxlZCcpO1xuICAgICAgZXhwZWN0KGVycm9yKS50b0JlSW5zdGFuY2VPZihHSFBFcnJvcik7XG4gICAgICBleHBlY3QoZXJyb3IpLnRvQmVJbnN0YW5jZU9mKE5ldHdvcmtFcnJvcik7XG4gICAgICBleHBlY3QoZXJyb3IubWVzc2FnZSkudG9CZSgnQ29ubmVjdGlvbiBmYWlsZWQnKTtcbiAgICAgIGV4cGVjdChlcnJvci5uYW1lKS50b0JlKCdOZXR3b3JrRXJyb3InKTtcbiAgICAgIGV4cGVjdChlcnJvci5leGl0Q29kZSkudG9CZShFeGl0Q29kZS5OZXR3b3JrRXJyb3IpO1xuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgnQXV0aGVudGljYXRpb25FcnJvcicsICgpID0+IHtcbiAgICBpdCgnc2hvdWxkIGNyZWF0ZSBhbiBhdXRoZW50aWNhdGlvbiBlcnJvciB3aXRoIGNvcnJlY3QgZXhpdCBjb2RlJywgKCkgPT4ge1xuICAgICAgY29uc3QgZXJyb3IgPSBuZXcgQXV0aGVudGljYXRpb25FcnJvcignSW52YWxpZCB0b2tlbicpO1xuICAgICAgZXhwZWN0KGVycm9yKS50b0JlSW5zdGFuY2VPZihHSFBFcnJvcik7XG4gICAgICBleHBlY3QoZXJyb3IpLnRvQmVJbnN0YW5jZU9mKEF1dGhlbnRpY2F0aW9uRXJyb3IpO1xuICAgICAgZXhwZWN0KGVycm9yLm1lc3NhZ2UpLnRvQmUoJ0ludmFsaWQgdG9rZW4nKTtcbiAgICAgIGV4cGVjdChlcnJvci5uYW1lKS50b0JlKCdBdXRoZW50aWNhdGlvbkVycm9yJyk7XG4gICAgICBleHBlY3QoZXJyb3IuZXhpdENvZGUpLnRvQmUoRXhpdENvZGUuQXV0aGVudGljYXRpb25FcnJvcik7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdOb3RGb3VuZEVycm9yJywgKCkgPT4ge1xuICAgIGl0KCdzaG91bGQgY3JlYXRlIGEgbm90IGZvdW5kIGVycm9yIHdpdGggY29ycmVjdCBleGl0IGNvZGUnLCAoKSA9PiB7XG4gICAgICBjb25zdCBlcnJvciA9IG5ldyBOb3RGb3VuZEVycm9yKCdSZXNvdXJjZSBub3QgZm91bmQnKTtcbiAgICAgIGV4cGVjdChlcnJvcikudG9CZUluc3RhbmNlT2YoR0hQRXJyb3IpO1xuICAgICAgZXhwZWN0KGVycm9yKS50b0JlSW5zdGFuY2VPZihOb3RGb3VuZEVycm9yKTtcbiAgICAgIGV4cGVjdChlcnJvci5tZXNzYWdlKS50b0JlKCdSZXNvdXJjZSBub3QgZm91bmQnKTtcbiAgICAgIGV4cGVjdChlcnJvci5uYW1lKS50b0JlKCdOb3RGb3VuZEVycm9yJyk7XG4gICAgICBleHBlY3QoZXJyb3IuZXhpdENvZGUpLnRvQmUoRXhpdENvZGUuTm90Rm91bmRFcnJvcik7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdHaXRIdWJBUElFcnJvcicsICgpID0+IHtcbiAgICBpdCgnc2hvdWxkIGNyZWF0ZSBhIEdpdEh1YiBBUEkgZXJyb3Igd2l0aCBjb3JyZWN0IGV4aXQgY29kZScsICgpID0+IHtcbiAgICAgIGNvbnN0IGVycm9yID0gbmV3IEdpdEh1YkFQSUVycm9yKCdBUEkgcmF0ZSBsaW1pdCBleGNlZWRlZCcpO1xuICAgICAgZXhwZWN0KGVycm9yKS50b0JlSW5zdGFuY2VPZihHSFBFcnJvcik7XG4gICAgICBleHBlY3QoZXJyb3IpLnRvQmVJbnN0YW5jZU9mKEdpdEh1YkFQSUVycm9yKTtcbiAgICAgIGV4cGVjdChlcnJvci5tZXNzYWdlKS50b0JlKCdBUEkgcmF0ZSBsaW1pdCBleGNlZWRlZCcpO1xuICAgICAgZXhwZWN0KGVycm9yLm5hbWUpLnRvQmUoJ0dpdEh1YkFQSUVycm9yJyk7XG4gICAgICBleHBlY3QoZXJyb3IuZXhpdENvZGUpLnRvQmUoRXhpdENvZGUuR2l0SHViQVBJRXJyb3IpO1xuICAgICAgZXhwZWN0KGVycm9yLnJlc3BvbnNlKS50b0JlVW5kZWZpbmVkKCk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGNyZWF0ZSBhIEdpdEh1YiBBUEkgZXJyb3Igd2l0aCByZXNwb25zZSBkYXRhJywgKCkgPT4ge1xuICAgICAgY29uc3QgcmVzcG9uc2VEYXRhID0geyBzdGF0dXM6IDQwMywgbWVzc2FnZTogJ1JhdGUgbGltaXQgZXhjZWVkZWQnIH07XG4gICAgICBjb25zdCBlcnJvciA9IG5ldyBHaXRIdWJBUElFcnJvcignQVBJIHJhdGUgbGltaXQgZXhjZWVkZWQnLCByZXNwb25zZURhdGEpO1xuICAgICAgZXhwZWN0KGVycm9yLnJlc3BvbnNlKS50b0JlKHJlc3BvbnNlRGF0YSk7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdDb25maWd1cmF0aW9uRXJyb3InLCAoKSA9PiB7XG4gICAgaXQoJ3Nob3VsZCBjcmVhdGUgYSBjb25maWd1cmF0aW9uIGVycm9yIHdpdGggY29ycmVjdCBleGl0IGNvZGUnLCAoKSA9PiB7XG4gICAgICBjb25zdCBlcnJvciA9IG5ldyBDb25maWd1cmF0aW9uRXJyb3IoJ0ludmFsaWQgY29uZmlndXJhdGlvbicpO1xuICAgICAgZXhwZWN0KGVycm9yKS50b0JlSW5zdGFuY2VPZihHSFBFcnJvcik7XG4gICAgICBleHBlY3QoZXJyb3IpLnRvQmVJbnN0YW5jZU9mKENvbmZpZ3VyYXRpb25FcnJvcik7XG4gICAgICBleHBlY3QoZXJyb3IubWVzc2FnZSkudG9CZSgnSW52YWxpZCBjb25maWd1cmF0aW9uJyk7XG4gICAgICBleHBlY3QoZXJyb3IubmFtZSkudG9CZSgnQ29uZmlndXJhdGlvbkVycm9yJyk7XG4gICAgICBleHBlY3QoZXJyb3IuZXhpdENvZGUpLnRvQmUoRXhpdENvZGUuQ29uZmlndXJhdGlvbkVycm9yKTtcbiAgICB9KTtcbiAgfSk7XG59KTtcblxuZGVzY3JpYmUoJ0Vycm9yIEhhbmRsaW5nIEZ1bmN0aW9ucycsICgpID0+IHtcbiAgZGVzY3JpYmUoJ2hhbmRsZUVycm9yJywgKCkgPT4ge1xuICAgIGxldCBjb25zb2xlRXJyb3JTcHk6IGplc3QuU3B5SW5zdGFuY2U7XG4gICAgbGV0IHByb2Nlc3NFeGl0U3B5OiBqZXN0LlNweUluc3RhbmNlO1xuICAgIFxuICAgIGJlZm9yZUVhY2goKCkgPT4ge1xuICAgICAgY29uc29sZUVycm9yU3B5ID0gamVzdC5zcHlPbihjb25zb2xlLCAnZXJyb3InKS5tb2NrSW1wbGVtZW50YXRpb24oKTtcbiAgICAgIHByb2Nlc3NFeGl0U3B5ID0gamVzdC5zcHlPbihwcm9jZXNzLCAnZXhpdCcpLm1vY2tJbXBsZW1lbnRhdGlvbigoKCkgPT4ge30pIGFzIGFueSk7XG4gICAgfSk7XG4gICAgXG4gICAgYWZ0ZXJFYWNoKCgpID0+IHtcbiAgICAgIGNvbnNvbGVFcnJvclNweS5tb2NrUmVzdG9yZSgpO1xuICAgICAgcHJvY2Vzc0V4aXRTcHkubW9ja1Jlc3RvcmUoKTtcbiAgICB9KTtcbiAgICBcbiAgICBpdCgnc2hvdWxkIGhhbmRsZSBHSFBFcnJvciBjb3JyZWN0bHknLCAoKSA9PiB7XG4gICAgICBjb25zdCBlcnJvciA9IG5ldyBWYWxpZGF0aW9uRXJyb3IoJ0ludmFsaWQgaW5wdXQnKTtcbiAgICAgIGhhbmRsZUVycm9yKGVycm9yKTtcbiAgICAgIFxuICAgICAgZXhwZWN0KGNvbnNvbGVFcnJvclNweSkudG9IYXZlQmVlbkNhbGxlZFdpdGgoJ0Vycm9yOiBJbnZhbGlkIGlucHV0Jyk7XG4gICAgICBleHBlY3QocHJvY2Vzc0V4aXRTcHkpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKEV4aXRDb2RlLlZhbGlkYXRpb25FcnJvcik7XG4gICAgfSk7XG4gICAgXG4gICAgaXQoJ3Nob3VsZCBoYW5kbGUgR2l0SHViQVBJRXJyb3Igd2l0aCByZXNwb25zZSBkYXRhIGluIHZlcmJvc2UgbW9kZScsICgpID0+IHtcbiAgICAgIGNvbnN0IHJlc3BvbnNlRGF0YSA9IHsgc3RhdHVzOiA0MDMsIG1lc3NhZ2U6ICdSYXRlIGxpbWl0IGV4Y2VlZGVkJyB9O1xuICAgICAgY29uc3QgZXJyb3IgPSBuZXcgR2l0SHViQVBJRXJyb3IoJ0FQSSBlcnJvcicsIHJlc3BvbnNlRGF0YSk7XG4gICAgICBoYW5kbGVFcnJvcihlcnJvciwgdHJ1ZSk7XG4gICAgICBcbiAgICAgIGV4cGVjdChjb25zb2xlRXJyb3JTcHkpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKGV4cGVjdC5zdHJpbmdDb250YWluaW5nKCdHaXRIdWIgQVBJIEVycm9yOiBBUEkgZXJyb3InKSk7XG4gICAgICBleHBlY3QoY29uc29sZUVycm9yU3B5KS50b0hhdmVCZWVuQ2FsbGVkV2l0aChleHBlY3Quc3RyaW5nQ29udGFpbmluZyhKU09OLnN0cmluZ2lmeShyZXNwb25zZURhdGEsIG51bGwsIDIpKSk7XG4gICAgICBleHBlY3QocHJvY2Vzc0V4aXRTcHkpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKEV4aXRDb2RlLkdpdEh1YkFQSUVycm9yKTtcbiAgICB9KTtcbiAgICBcbiAgICBpdCgnc2hvdWxkIGhhbmRsZSBHaXRIdWJBUElFcnJvciB3aXRob3V0IHJlc3BvbnNlIGRhdGEgZGV0YWlscyBpbiBub24tdmVyYm9zZSBtb2RlJywgKCkgPT4ge1xuICAgICAgY29uc3QgcmVzcG9uc2VEYXRhID0geyBzdGF0dXM6IDQwMywgbWVzc2FnZTogJ1JhdGUgbGltaXQgZXhjZWVkZWQnIH07XG4gICAgICBjb25zdCBlcnJvciA9IG5ldyBHaXRIdWJBUElFcnJvcignQVBJIGVycm9yJywgcmVzcG9uc2VEYXRhKTtcbiAgICAgIGhhbmRsZUVycm9yKGVycm9yLCBmYWxzZSk7XG4gICAgICBcbiAgICAgIGV4cGVjdChjb25zb2xlRXJyb3JTcHkpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKGV4cGVjdC5zdHJpbmdDb250YWluaW5nKCdHaXRIdWIgQVBJIEVycm9yOiBBUEkgZXJyb3InKSk7XG4gICAgICBleHBlY3QoY29uc29sZUVycm9yU3B5KS5ub3QudG9IYXZlQmVlbkNhbGxlZFdpdGgoZXhwZWN0LnN0cmluZ0NvbnRhaW5pbmcoSlNPTi5zdHJpbmdpZnkocmVzcG9uc2VEYXRhLCBudWxsLCAyKSkpO1xuICAgICAgZXhwZWN0KHByb2Nlc3NFeGl0U3B5KS50b0hhdmVCZWVuQ2FsbGVkV2l0aChFeGl0Q29kZS5HaXRIdWJBUElFcnJvcik7XG4gICAgfSk7XG4gICAgXG4gICAgaXQoJ3Nob3VsZCBoYW5kbGUgbm9uLUdIUEVycm9yIHdpdGggbWVzc2FnZScsICgpID0+IHtcbiAgICAgIGNvbnN0IGVycm9yID0gbmV3IEVycm9yKCdTdGFuZGFyZCBlcnJvcicpO1xuICAgICAgaGFuZGxlRXJyb3IoZXJyb3IpO1xuICAgICAgXG4gICAgICBleHBlY3QoY29uc29sZUVycm9yU3B5KS50b0hhdmVCZWVuQ2FsbGVkV2l0aCgnRXJyb3I6IFN0YW5kYXJkIGVycm9yJyk7XG4gICAgICBleHBlY3QocHJvY2Vzc0V4aXRTcHkpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKEV4aXRDb2RlLkdlbmVyYWxFcnJvcik7XG4gICAgfSk7XG4gICAgXG4gICAgaXQoJ3Nob3VsZCBoYW5kbGUgbm9uLUVycm9yIG9iamVjdHMnLCAoKSA9PiB7XG4gICAgICBoYW5kbGVFcnJvcignU3RyaW5nIGVycm9yJyk7XG4gICAgICBcbiAgICAgIGV4cGVjdChjb25zb2xlRXJyb3JTcHkpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKCdFcnJvcjogU3RyaW5nIGVycm9yJyk7XG4gICAgICBleHBlY3QocHJvY2Vzc0V4aXRTcHkpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKEV4aXRDb2RlLkdlbmVyYWxFcnJvcik7XG4gICAgfSk7XG4gICAgXG4gICAgaXQoJ3Nob3VsZCBwcmludCBzdGFjayB0cmFjZSBpbiB2ZXJib3NlIG1vZGUnLCAoKSA9PiB7XG4gICAgICBjb25zdCBlcnJvciA9IG5ldyBFcnJvcignV2l0aCBzdGFjaycpO1xuICAgICAgZXJyb3Iuc3RhY2sgPSAnRXJyb3I6IFdpdGggc3RhY2tcXG4gICAgYXQgZmlsZS5qczoxOjEnO1xuICAgICAgaGFuZGxlRXJyb3IoZXJyb3IsIHRydWUpO1xuICAgICAgXG4gICAgICBleHBlY3QoY29uc29sZUVycm9yU3B5KS50b0hhdmVCZWVuQ2FsbGVkV2l0aCgnXFxuU3RhY2sgdHJhY2U6Jyk7XG4gICAgICBleHBlY3QoY29uc29sZUVycm9yU3B5KS50b0hhdmVCZWVuQ2FsbGVkV2l0aChlcnJvci5zdGFjayk7XG4gICAgfSk7XG4gIH0pO1xuICBcbiAgZGVzY3JpYmUoJ3dyYXBXaXRoRXJyb3JIYW5kbGVyJywgKCkgPT4ge1xuICAgIGl0KCdzaG91bGQgcmV0dXJuIGZ1bmN0aW9uIHJlc3VsdCBvbiBzdWNjZXNzJywgYXN5bmMgKCkgPT4ge1xuICAgICAgLy8gQ3LDqWVyIHVuZSBmb25jdGlvbiBxdWkgcmV0b3VybmUgdG91am91cnMgdW5lIHZhbGV1ciBkZSBzdWNjw6hzXG4gICAgICBjb25zdCBzdWNjZXNzRm4gPSBhc3luYyAoKSA9PiAnc3VjY2Vzcyc7XG4gICAgICBjb25zdCB3cmFwcGVkID0gd3JhcFdpdGhFcnJvckhhbmRsZXIoc3VjY2Vzc0ZuKTtcbiAgICAgIFxuICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgd3JhcHBlZCgpO1xuICAgICAgZXhwZWN0KHJlc3VsdCkudG9CZSgnc3VjY2VzcycpO1xuICAgIH0pO1xuICAgIFxuICAgIGl0KCdzaG91bGQgcGFzcyBhcmd1bWVudHMgY29ycmVjdGx5IHRvIHRoZSB3cmFwcGVkIGZ1bmN0aW9uJywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgYXJnVGVzdEZuID0gYXN5bmMgKGE6IHN0cmluZywgYjogbnVtYmVyKSA9PiBgJHthfS0ke2J9YDtcbiAgICAgIGNvbnN0IHdyYXBwZWQgPSB3cmFwV2l0aEVycm9ySGFuZGxlcihhcmdUZXN0Rm4pO1xuICAgICAgXG4gICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCB3cmFwcGVkKCd0ZXN0JywgMTIzKTtcbiAgICAgIGV4cGVjdChyZXN1bHQpLnRvQmUoJ3Rlc3QtMTIzJyk7XG4gICAgfSk7XG4gICAgXG4gICAgaXQoJ3Nob3VsZCBoYW5kbGUgZXJyb3JzIHdpdGggZGVmYXVsdCB2ZXJib3NlIHNldHRpbmcnLCBhc3luYyAoKSA9PiB7XG4gICAgICAvLyBFc3Bpb25uZXIgc2FucyBlbXDDqmNoZXIgbGUgY29tcG9ydGVtZW50IG5vcm1hbFxuICAgICAgY29uc3QgY29uc29sZUVycm9yU3B5ID0gamVzdC5zcHlPbihjb25zb2xlLCAnZXJyb3InKS5tb2NrSW1wbGVtZW50YXRpb24oKTtcbiAgICAgIFxuICAgICAgLy8gUmVtcGxhY2VyIHByb2Nlc3MuZXhpdCBwb3VyIMOpdml0ZXIgcXUnaWwgbmUgdGVybWluZSBsZSBwcm9jZXNzdXMgZGUgdGVzdFxuICAgICAgY29uc3Qgb3JpZ2luYWxFeGl0ID0gcHJvY2Vzcy5leGl0O1xuICAgICAgcHJvY2Vzcy5leGl0ID0gamVzdC5mbigpIGFzIGFueTtcbiAgICAgIFxuICAgICAgY29uc3QgZXJyb3JGbiA9IGFzeW5jICgpID0+IHtcbiAgICAgICAgdGhyb3cgbmV3IFZhbGlkYXRpb25FcnJvcignVGVzdCB2YWxpZGF0aW9uIGVycm9yJyk7XG4gICAgICB9O1xuICAgICAgXG4gICAgICBjb25zdCB3cmFwcGVkID0gd3JhcFdpdGhFcnJvckhhbmRsZXIoZXJyb3JGbik7XG4gICAgICBcbiAgICAgIC8vIEV4w6ljdXRlciBsYSBmb25jdGlvbiBtYWlzIGlnbm9yZXIgbCdlcnJldXJcbiAgICAgIGF3YWl0IHdyYXBwZWQoKS5jYXRjaCgoKSA9PiB7fSk7XG4gICAgICBcbiAgICAgIGV4cGVjdChjb25zb2xlRXJyb3JTcHkpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKCdFcnJvcjogVGVzdCB2YWxpZGF0aW9uIGVycm9yJyk7XG4gICAgICBleHBlY3QocHJvY2Vzcy5leGl0KS50b0hhdmVCZWVuQ2FsbGVkV2l0aChFeGl0Q29kZS5WYWxpZGF0aW9uRXJyb3IpO1xuICAgICAgXG4gICAgICAvLyBSZXN0YXVyZXIgbGVzIGZvbmN0aW9ucyBvcmlnaW5hbGVzXG4gICAgICBjb25zb2xlRXJyb3JTcHkubW9ja1Jlc3RvcmUoKTtcbiAgICAgIHByb2Nlc3MuZXhpdCA9IG9yaWdpbmFsRXhpdDtcbiAgICB9KTtcbiAgICBcbiAgICBpdCgnc2hvdWxkIGhhbmRsZSBlcnJvcnMgd2l0aCB2ZXJib3NlPXRydWUnLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCBjb25zb2xlRXJyb3JTcHkgPSBqZXN0LnNweU9uKGNvbnNvbGUsICdlcnJvcicpLm1vY2tJbXBsZW1lbnRhdGlvbigpO1xuICAgICAgXG4gICAgICAvLyBSZW1wbGFjZXIgcHJvY2Vzcy5leGl0XG4gICAgICBjb25zdCBvcmlnaW5hbEV4aXQgPSBwcm9jZXNzLmV4aXQ7XG4gICAgICBwcm9jZXNzLmV4aXQgPSBqZXN0LmZuKCkgYXMgYW55O1xuICAgICAgXG4gICAgICBjb25zdCBlcnJvcldpdGhTdGFja0ZuID0gYXN5bmMgKCkgPT4ge1xuICAgICAgICBjb25zdCBlcnJvciA9IG5ldyBFcnJvcignRXJyb3Igd2l0aCBzdGFjaycpO1xuICAgICAgICBlcnJvci5zdGFjayA9ICdFcnJvcjogRXJyb3Igd2l0aCBzdGFja1xcbiAgICBhdCBmaWxlLmpzOjE6MSc7XG4gICAgICAgIHRocm93IGVycm9yO1xuICAgICAgfTtcbiAgICAgIFxuICAgICAgY29uc3Qgd3JhcHBlZCA9IHdyYXBXaXRoRXJyb3JIYW5kbGVyKGVycm9yV2l0aFN0YWNrRm4sIHRydWUpO1xuICAgICAgXG4gICAgICAvLyBFeMOpY3V0ZXIgbGEgZm9uY3Rpb24gbWFpcyBpZ25vcmVyIGwnZXJyZXVyXG4gICAgICBhd2FpdCB3cmFwcGVkKCkuY2F0Y2goKCkgPT4ge30pO1xuICAgICAgXG4gICAgICBleHBlY3QoY29uc29sZUVycm9yU3B5KS50b0hhdmVCZWVuQ2FsbGVkV2l0aCgnXFxuU3RhY2sgdHJhY2U6Jyk7XG4gICAgICBleHBlY3QocHJvY2Vzcy5leGl0KS50b0hhdmVCZWVuQ2FsbGVkV2l0aChFeGl0Q29kZS5HZW5lcmFsRXJyb3IpO1xuICAgICAgXG4gICAgICAvLyBSZXN0YXVyZXIgbGVzIGZvbmN0aW9ucyBvcmlnaW5hbGVzXG4gICAgICBjb25zb2xlRXJyb3JTcHkubW9ja1Jlc3RvcmUoKTtcbiAgICAgIHByb2Nlc3MuZXhpdCA9IG9yaWdpbmFsRXhpdDtcbiAgICB9KTtcbiAgfSk7XG59KTtcblxuZGVzY3JpYmUoJ0V4aXQgQ29kZXMnLCAoKSA9PiB7XG4gIGl0KCdzaG91bGQgaGF2ZSBjb3JyZWN0IGV4aXQgY29kZSB2YWx1ZXMnLCAoKSA9PiB7XG4gICAgZXhwZWN0KEV4aXRDb2RlLlN1Y2Nlc3MpLnRvQmUoMCk7XG4gICAgZXhwZWN0KEV4aXRDb2RlLkdlbmVyYWxFcnJvcikudG9CZSgxKTtcbiAgICBleHBlY3QoRXhpdENvZGUuVmFsaWRhdGlvbkVycm9yKS50b0JlKDIpO1xuICAgIGV4cGVjdChFeGl0Q29kZS5OZXR3b3JrRXJyb3IpLnRvQmUoMyk7XG4gICAgZXhwZWN0KEV4aXRDb2RlLkF1dGhlbnRpY2F0aW9uRXJyb3IpLnRvQmUoNCk7XG4gICAgZXhwZWN0KEV4aXRDb2RlLk5vdEZvdW5kRXJyb3IpLnRvQmUoNSk7XG4gICAgZXhwZWN0KEV4aXRDb2RlLkdpdEh1YkFQSUVycm9yKS50b0JlKDYpO1xuICAgIGV4cGVjdChFeGl0Q29kZS5Db25maWd1cmF0aW9uRXJyb3IpLnRvQmUoNyk7XG4gIH0pO1xufSk7ICJdLCJ2ZXJzaW9uIjozfQ==
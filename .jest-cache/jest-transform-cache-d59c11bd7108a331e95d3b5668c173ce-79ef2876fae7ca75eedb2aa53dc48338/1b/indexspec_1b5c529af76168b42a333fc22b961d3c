246bd847800fd486f725ebb889f395bc
"use strict";
/**
 * Unit tests for error handling module
 */
Object.defineProperty(exports, "__esModule", { value: true });
const index_1 = require("./index");
describe('Error Types', () => {
    describe('GHPError', () => {
        it('should create a base error with default exit code', () => {
            const error = new index_1.GHPError('Base error message');
            expect(error).toBeInstanceOf(Error);
            expect(error).toBeInstanceOf(index_1.GHPError);
            expect(error.message).toBe('Base error message');
            expect(error.name).toBe('GHPError');
            expect(error.exitCode).toBe(index_1.ExitCode.GeneralError);
        });
        it('should create a base error with custom exit code', () => {
            const error = new index_1.GHPError('Base error message', index_1.ExitCode.NotFoundError);
            expect(error.exitCode).toBe(index_1.ExitCode.NotFoundError);
        });
    });
    describe('ValidationError', () => {
        it('should create a validation error with correct exit code', () => {
            const error = new index_1.ValidationError('Invalid input');
            expect(error).toBeInstanceOf(index_1.GHPError);
            expect(error).toBeInstanceOf(index_1.ValidationError);
            expect(error.message).toBe('Invalid input');
            expect(error.name).toBe('ValidationError');
            expect(error.exitCode).toBe(index_1.ExitCode.ValidationError);
        });
    });
    describe('NetworkError', () => {
        it('should create a network error with correct exit code', () => {
            const error = new index_1.NetworkError('Connection failed');
            expect(error).toBeInstanceOf(index_1.GHPError);
            expect(error).toBeInstanceOf(index_1.NetworkError);
            expect(error.message).toBe('Connection failed');
            expect(error.name).toBe('NetworkError');
            expect(error.exitCode).toBe(index_1.ExitCode.NetworkError);
        });
    });
    describe('AuthenticationError', () => {
        it('should create an authentication error with correct exit code', () => {
            const error = new index_1.AuthenticationError('Invalid token');
            expect(error).toBeInstanceOf(index_1.GHPError);
            expect(error).toBeInstanceOf(index_1.AuthenticationError);
            expect(error.message).toBe('Invalid token');
            expect(error.name).toBe('AuthenticationError');
            expect(error.exitCode).toBe(index_1.ExitCode.AuthenticationError);
        });
    });
    describe('NotFoundError', () => {
        it('should create a not found error with correct exit code', () => {
            const error = new index_1.NotFoundError('Resource not found');
            expect(error).toBeInstanceOf(index_1.GHPError);
            expect(error).toBeInstanceOf(index_1.NotFoundError);
            expect(error.message).toBe('Resource not found');
            expect(error.name).toBe('NotFoundError');
            expect(error.exitCode).toBe(index_1.ExitCode.NotFoundError);
        });
    });
    describe('GitHubAPIError', () => {
        it('should create a GitHub API error with correct exit code', () => {
            const error = new index_1.GitHubAPIError('API rate limit exceeded');
            expect(error).toBeInstanceOf(index_1.GHPError);
            expect(error).toBeInstanceOf(index_1.GitHubAPIError);
            expect(error.message).toBe('API rate limit exceeded');
            expect(error.name).toBe('GitHubAPIError');
            expect(error.exitCode).toBe(index_1.ExitCode.GitHubAPIError);
            expect(error.response).toBeUndefined();
        });
        it('should create a GitHub API error with response data', () => {
            const responseData = { status: 403, message: 'Rate limit exceeded' };
            const error = new index_1.GitHubAPIError('API rate limit exceeded', responseData);
            expect(error.response).toBe(responseData);
        });
    });
    describe('ConfigurationError', () => {
        it('should create a configuration error with correct exit code', () => {
            const error = new index_1.ConfigurationError('Invalid configuration');
            expect(error).toBeInstanceOf(index_1.GHPError);
            expect(error).toBeInstanceOf(index_1.ConfigurationError);
            expect(error.message).toBe('Invalid configuration');
            expect(error.name).toBe('ConfigurationError');
            expect(error.exitCode).toBe(index_1.ExitCode.ConfigurationError);
        });
    });
});
describe('Error Handling Functions', () => {
    describe('handleError', () => {
        let consoleErrorSpy;
        let processExitSpy;
        beforeEach(() => {
            consoleErrorSpy = jest.spyOn(console, 'error').mockImplementation();
            processExitSpy = jest.spyOn(process, 'exit').mockImplementation((() => { }));
        });
        afterEach(() => {
            consoleErrorSpy.mockRestore();
            processExitSpy.mockRestore();
        });
        it('should handle GHPError correctly', () => {
            const error = new index_1.ValidationError('Invalid input');
            (0, index_1.handleError)(error);
            expect(consoleErrorSpy).toHaveBeenCalledWith('Error: Invalid input');
            expect(processExitSpy).toHaveBeenCalledWith(index_1.ExitCode.ValidationError);
        });
        it('should handle GitHubAPIError with response data in verbose mode', () => {
            const responseData = { status: 403, message: 'Rate limit exceeded' };
            const error = new index_1.GitHubAPIError('API error', responseData);
            (0, index_1.handleError)(error, true);
            expect(consoleErrorSpy).toHaveBeenCalledWith(expect.stringContaining('GitHub API Error: API error'));
            expect(consoleErrorSpy).toHaveBeenCalledWith(expect.stringContaining(JSON.stringify(responseData, null, 2)));
            expect(processExitSpy).toHaveBeenCalledWith(index_1.ExitCode.GitHubAPIError);
        });
        it('should handle GitHubAPIError without response data details in non-verbose mode', () => {
            const responseData = { status: 403, message: 'Rate limit exceeded' };
            const error = new index_1.GitHubAPIError('API error', responseData);
            (0, index_1.handleError)(error, false);
            expect(consoleErrorSpy).toHaveBeenCalledWith(expect.stringContaining('GitHub API Error: API error'));
            expect(consoleErrorSpy).not.toHaveBeenCalledWith(expect.stringContaining(JSON.stringify(responseData, null, 2)));
            expect(processExitSpy).toHaveBeenCalledWith(index_1.ExitCode.GitHubAPIError);
        });
        it('should handle non-GHPError with message', () => {
            const error = new Error('Standard error');
            (0, index_1.handleError)(error);
            expect(consoleErrorSpy).toHaveBeenCalledWith('Error: Standard error');
            expect(processExitSpy).toHaveBeenCalledWith(index_1.ExitCode.GeneralError);
        });
        it('should handle non-Error objects', () => {
            (0, index_1.handleError)('String error');
            expect(consoleErrorSpy).toHaveBeenCalledWith('Error: String error');
            expect(processExitSpy).toHaveBeenCalledWith(index_1.ExitCode.GeneralError);
        });
        it('should print stack trace in verbose mode', () => {
            const error = new Error('With stack');
            error.stack = 'Error: With stack\n    at file.js:1:1';
            (0, index_1.handleError)(error, true);
            expect(consoleErrorSpy).toHaveBeenCalledWith('\nStack trace:');
            expect(consoleErrorSpy).toHaveBeenCalledWith(error.stack);
        });
    });
    describe('wrapWithErrorHandler', () => {
        it('should return function result on success', async () => {
            // Créer une fonction qui retourne toujours une valeur de succès
            const successFn = async () => 'success';
            const wrapped = (0, index_1.wrapWithErrorHandler)(successFn);
            const result = await wrapped();
            expect(result).toBe('success');
        });
        it('should pass arguments correctly to the wrapped function', async () => {
            const argTestFn = async (a, b) => `${a}-${b}`;
            const wrapped = (0, index_1.wrapWithErrorHandler)(argTestFn);
            const result = await wrapped('test', 123);
            expect(result).toBe('test-123');
        });
        it('should handle errors with default verbose setting', async () => {
            // Test que le process.exit est appelé quand une erreur se produit
            const processExitSpy = jest.spyOn(process, 'exit').mockImplementation((() => { }));
            const consoleErrorSpy = jest.spyOn(console, 'error').mockImplementation();
            const errorFn = async () => {
                throw new index_1.ValidationError('Test validation error');
            };
            const wrapped = (0, index_1.wrapWithErrorHandler)(errorFn);
            await wrapped();
            expect(consoleErrorSpy).toHaveBeenCalledWith('Error: Test validation error');
            expect(processExitSpy).toHaveBeenCalledWith(index_1.ExitCode.ValidationError);
            consoleErrorSpy.mockRestore();
            processExitSpy.mockRestore();
        });
        it('should handle errors with verbose=true', async () => {
            const processExitSpy = jest.spyOn(process, 'exit').mockImplementation((() => { }));
            const consoleErrorSpy = jest.spyOn(console, 'error').mockImplementation();
            const errorWithStackFn = async () => {
                const error = new Error('Error with stack');
                error.stack = 'Error: Error with stack\n    at file.js:1:1';
                throw error;
            };
            const wrapped = (0, index_1.wrapWithErrorHandler)(errorWithStackFn, true);
            await wrapped();
            expect(consoleErrorSpy).toHaveBeenCalledWith('\nStack trace:');
            expect(processExitSpy).toHaveBeenCalledWith(index_1.ExitCode.GeneralError);
            consoleErrorSpy.mockRestore();
            processExitSpy.mockRestore();
        });
    });
});
describe('Exit Codes', () => {
    it('should have correct exit code values', () => {
        expect(index_1.ExitCode.Success).toBe(0);
        expect(index_1.ExitCode.GeneralError).toBe(1);
        expect(index_1.ExitCode.ValidationError).toBe(2);
        expect(index_1.ExitCode.NetworkError).toBe(3);
        expect(index_1.ExitCode.AuthenticationError).toBe(4);
        expect(index_1.ExitCode.NotFoundError).toBe(5);
        expect(index_1.ExitCode.GitHubAPIError).toBe(6);
        expect(index_1.ExitCode.ConfigurationError).toBe(7);
    });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiL1VzZXJzL3N0ZXBoYW5lc291cm9uL2Rldi9iZWRkeS1ieWUtc3Rvcmllcy9naHAtY29ubmVjdG9yL3NyYy9saWIvZXJyb3JzL2luZGV4LnNwZWMudHMiLCJtYXBwaW5ncyI6IjtBQUFBOztHQUVHOztBQUVILG1DQVdpQjtBQUVqQixRQUFRLENBQUMsYUFBYSxFQUFFLEdBQUcsRUFBRTtJQUMzQixRQUFRLENBQUMsVUFBVSxFQUFFLEdBQUcsRUFBRTtRQUN4QixFQUFFLENBQUMsbURBQW1ELEVBQUUsR0FBRyxFQUFFO1lBQzNELE1BQU0sS0FBSyxHQUFHLElBQUksZ0JBQVEsQ0FBQyxvQkFBb0IsQ0FBQyxDQUFDO1lBQ2pELE1BQU0sQ0FBQyxLQUFLLENBQUMsQ0FBQyxjQUFjLENBQUMsS0FBSyxDQUFDLENBQUM7WUFDcEMsTUFBTSxDQUFDLEtBQUssQ0FBQyxDQUFDLGNBQWMsQ0FBQyxnQkFBUSxDQUFDLENBQUM7WUFDdkMsTUFBTSxDQUFDLEtBQUssQ0FBQyxPQUFPLENBQUMsQ0FBQyxJQUFJLENBQUMsb0JBQW9CLENBQUMsQ0FBQztZQUNqRCxNQUFNLENBQUMsS0FBSyxDQUFDLElBQUksQ0FBQyxDQUFDLElBQUksQ0FBQyxVQUFVLENBQUMsQ0FBQztZQUNwQyxNQUFNLENBQUMsS0FBSyxDQUFDLFFBQVEsQ0FBQyxDQUFDLElBQUksQ0FBQyxnQkFBUSxDQUFDLFlBQVksQ0FBQyxDQUFDO1FBQ3JELENBQUMsQ0FBQyxDQUFDO1FBRUgsRUFBRSxDQUFDLGtEQUFrRCxFQUFFLEdBQUcsRUFBRTtZQUMxRCxNQUFNLEtBQUssR0FBRyxJQUFJLGdCQUFRLENBQUMsb0JBQW9CLEVBQUUsZ0JBQVEsQ0FBQyxhQUFhLENBQUMsQ0FBQztZQUN6RSxNQUFNLENBQUMsS0FBSyxDQUFDLFFBQVEsQ0FBQyxDQUFDLElBQUksQ0FBQyxnQkFBUSxDQUFDLGFBQWEsQ0FBQyxDQUFDO1FBQ3RELENBQUMsQ0FBQyxDQUFDO0lBQ0wsQ0FBQyxDQUFDLENBQUM7SUFFSCxRQUFRLENBQUMsaUJBQWlCLEVBQUUsR0FBRyxFQUFFO1FBQy9CLEVBQUUsQ0FBQyx5REFBeUQsRUFBRSxHQUFHLEVBQUU7WUFDakUsTUFBTSxLQUFLLEdBQUcsSUFBSSx1QkFBZSxDQUFDLGVBQWUsQ0FBQyxDQUFDO1lBQ25ELE1BQU0sQ0FBQyxLQUFLLENBQUMsQ0FBQyxjQUFjLENBQUMsZ0JBQVEsQ0FBQyxDQUFDO1lBQ3ZDLE1BQU0sQ0FBQyxLQUFLLENBQUMsQ0FBQyxjQUFjLENBQUMsdUJBQWUsQ0FBQyxDQUFDO1lBQzlDLE1BQU0sQ0FBQyxLQUFLLENBQUMsT0FBTyxDQUFDLENBQUMsSUFBSSxDQUFDLGVBQWUsQ0FBQyxDQUFDO1lBQzVDLE1BQU0sQ0FBQyxLQUFLLENBQUMsSUFBSSxDQUFDLENBQUMsSUFBSSxDQUFDLGlCQUFpQixDQUFDLENBQUM7WUFDM0MsTUFBTSxDQUFDLEtBQUssQ0FBQyxRQUFRLENBQUMsQ0FBQyxJQUFJLENBQUMsZ0JBQVEsQ0FBQyxlQUFlLENBQUMsQ0FBQztRQUN4RCxDQUFDLENBQUMsQ0FBQztJQUNMLENBQUMsQ0FBQyxDQUFDO0lBRUgsUUFBUSxDQUFDLGNBQWMsRUFBRSxHQUFHLEVBQUU7UUFDNUIsRUFBRSxDQUFDLHNEQUFzRCxFQUFFLEdBQUcsRUFBRTtZQUM5RCxNQUFNLEtBQUssR0FBRyxJQUFJLG9CQUFZLENBQUMsbUJBQW1CLENBQUMsQ0FBQztZQUNwRCxNQUFNLENBQUMsS0FBSyxDQUFDLENBQUMsY0FBYyxDQUFDLGdCQUFRLENBQUMsQ0FBQztZQUN2QyxNQUFNLENBQUMsS0FBSyxDQUFDLENBQUMsY0FBYyxDQUFDLG9CQUFZLENBQUMsQ0FBQztZQUMzQyxNQUFNLENBQUMsS0FBSyxDQUFDLE9BQU8sQ0FBQyxDQUFDLElBQUksQ0FBQyxtQkFBbUIsQ0FBQyxDQUFDO1lBQ2hELE1BQU0sQ0FBQyxLQUFLLENBQUMsSUFBSSxDQUFDLENBQUMsSUFBSSxDQUFDLGNBQWMsQ0FBQyxDQUFDO1lBQ3hDLE1BQU0sQ0FBQyxLQUFLLENBQUMsUUFBUSxDQUFDLENBQUMsSUFBSSxDQUFDLGdCQUFRLENBQUMsWUFBWSxDQUFDLENBQUM7UUFDckQsQ0FBQyxDQUFDLENBQUM7SUFDTCxDQUFDLENBQUMsQ0FBQztJQUVILFFBQVEsQ0FBQyxxQkFBcUIsRUFBRSxHQUFHLEVBQUU7UUFDbkMsRUFBRSxDQUFDLDhEQUE4RCxFQUFFLEdBQUcsRUFBRTtZQUN0RSxNQUFNLEtBQUssR0FBRyxJQUFJLDJCQUFtQixDQUFDLGVBQWUsQ0FBQyxDQUFDO1lBQ3ZELE1BQU0sQ0FBQyxLQUFLLENBQUMsQ0FBQyxjQUFjLENBQUMsZ0JBQVEsQ0FBQyxDQUFDO1lBQ3ZDLE1BQU0sQ0FBQyxLQUFLLENBQUMsQ0FBQyxjQUFjLENBQUMsMkJBQW1CLENBQUMsQ0FBQztZQUNsRCxNQUFNLENBQUMsS0FBSyxDQUFDLE9BQU8sQ0FBQyxDQUFDLElBQUksQ0FBQyxlQUFlLENBQUMsQ0FBQztZQUM1QyxNQUFNLENBQUMsS0FBSyxDQUFDLElBQUksQ0FBQyxDQUFDLElBQUksQ0FBQyxxQkFBcUIsQ0FBQyxDQUFDO1lBQy9DLE1BQU0sQ0FBQyxLQUFLLENBQUMsUUFBUSxDQUFDLENBQUMsSUFBSSxDQUFDLGdCQUFRLENBQUMsbUJBQW1CLENBQUMsQ0FBQztRQUM1RCxDQUFDLENBQUMsQ0FBQztJQUNMLENBQUMsQ0FBQyxDQUFDO0lBRUgsUUFBUSxDQUFDLGVBQWUsRUFBRSxHQUFHLEVBQUU7UUFDN0IsRUFBRSxDQUFDLHdEQUF3RCxFQUFFLEdBQUcsRUFBRTtZQUNoRSxNQUFNLEtBQUssR0FBRyxJQUFJLHFCQUFhLENBQUMsb0JBQW9CLENBQUMsQ0FBQztZQUN0RCxNQUFNLENBQUMsS0FBSyxDQUFDLENBQUMsY0FBYyxDQUFDLGdCQUFRLENBQUMsQ0FBQztZQUN2QyxNQUFNLENBQUMsS0FBSyxDQUFDLENBQUMsY0FBYyxDQUFDLHFCQUFhLENBQUMsQ0FBQztZQUM1QyxNQUFNLENBQUMsS0FBSyxDQUFDLE9BQU8sQ0FBQyxDQUFDLElBQUksQ0FBQyxvQkFBb0IsQ0FBQyxDQUFDO1lBQ2pELE1BQU0sQ0FBQyxLQUFLLENBQUMsSUFBSSxDQUFDLENBQUMsSUFBSSxDQUFDLGVBQWUsQ0FBQyxDQUFDO1lBQ3pDLE1BQU0sQ0FBQyxLQUFLLENBQUMsUUFBUSxDQUFDLENBQUMsSUFBSSxDQUFDLGdCQUFRLENBQUMsYUFBYSxDQUFDLENBQUM7UUFDdEQsQ0FBQyxDQUFDLENBQUM7SUFDTCxDQUFDLENBQUMsQ0FBQztJQUVILFFBQVEsQ0FBQyxnQkFBZ0IsRUFBRSxHQUFHLEVBQUU7UUFDOUIsRUFBRSxDQUFDLHlEQUF5RCxFQUFFLEdBQUcsRUFBRTtZQUNqRSxNQUFNLEtBQUssR0FBRyxJQUFJLHNCQUFjLENBQUMseUJBQXlCLENBQUMsQ0FBQztZQUM1RCxNQUFNLENBQUMsS0FBSyxDQUFDLENBQUMsY0FBYyxDQUFDLGdCQUFRLENBQUMsQ0FBQztZQUN2QyxNQUFNLENBQUMsS0FBSyxDQUFDLENBQUMsY0FBYyxDQUFDLHNCQUFjLENBQUMsQ0FBQztZQUM3QyxNQUFNLENBQUMsS0FBSyxDQUFDLE9BQU8sQ0FBQyxDQUFDLElBQUksQ0FBQyx5QkFBeUIsQ0FBQyxDQUFDO1lBQ3RELE1BQU0sQ0FBQyxLQUFLLENBQUMsSUFBSSxDQUFDLENBQUMsSUFBSSxDQUFDLGdCQUFnQixDQUFDLENBQUM7WUFDMUMsTUFBTSxDQUFDLEtBQUssQ0FBQyxRQUFRLENBQUMsQ0FBQyxJQUFJLENBQUMsZ0JBQVEsQ0FBQyxjQUFjLENBQUMsQ0FBQztZQUNyRCxNQUFNLENBQUMsS0FBSyxDQUFDLFFBQVEsQ0FBQyxDQUFDLGFBQWEsRUFBRSxDQUFDO1FBQ3pDLENBQUMsQ0FBQyxDQUFDO1FBRUgsRUFBRSxDQUFDLHFEQUFxRCxFQUFFLEdBQUcsRUFBRTtZQUM3RCxNQUFNLFlBQVksR0FBRyxFQUFFLE1BQU0sRUFBRSxHQUFHLEVBQUUsT0FBTyxFQUFFLHFCQUFxQixFQUFFLENBQUM7WUFDckUsTUFBTSxLQUFLLEdBQUcsSUFBSSxzQkFBYyxDQUFDLHlCQUF5QixFQUFFLFlBQVksQ0FBQyxDQUFDO1lBQzFFLE1BQU0sQ0FBQyxLQUFLLENBQUMsUUFBUSxDQUFDLENBQUMsSUFBSSxDQUFDLFlBQVksQ0FBQyxDQUFDO1FBQzVDLENBQUMsQ0FBQyxDQUFDO0lBQ0wsQ0FBQyxDQUFDLENBQUM7SUFFSCxRQUFRLENBQUMsb0JBQW9CLEVBQUUsR0FBRyxFQUFFO1FBQ2xDLEVBQUUsQ0FBQyw0REFBNEQsRUFBRSxHQUFHLEVBQUU7WUFDcEUsTUFBTSxLQUFLLEdBQUcsSUFBSSwwQkFBa0IsQ0FBQyx1QkFBdUIsQ0FBQyxDQUFDO1lBQzlELE1BQU0sQ0FBQyxLQUFLLENBQUMsQ0FBQyxjQUFjLENBQUMsZ0JBQVEsQ0FBQyxDQUFDO1lBQ3ZDLE1BQU0sQ0FBQyxLQUFLLENBQUMsQ0FBQyxjQUFjLENBQUMsMEJBQWtCLENBQUMsQ0FBQztZQUNqRCxNQUFNLENBQUMsS0FBSyxDQUFDLE9BQU8sQ0FBQyxDQUFDLElBQUksQ0FBQyx1QkFBdUIsQ0FBQyxDQUFDO1lBQ3BELE1BQU0sQ0FBQyxLQUFLLENBQUMsSUFBSSxDQUFDLENBQUMsSUFBSSxDQUFDLG9CQUFvQixDQUFDLENBQUM7WUFDOUMsTUFBTSxDQUFDLEtBQUssQ0FBQyxRQUFRLENBQUMsQ0FBQyxJQUFJLENBQUMsZ0JBQVEsQ0FBQyxrQkFBa0IsQ0FBQyxDQUFDO1FBQzNELENBQUMsQ0FBQyxDQUFDO0lBQ0wsQ0FBQyxDQUFDLENBQUM7QUFDTCxDQUFDLENBQUMsQ0FBQztBQUVILFFBQVEsQ0FBQywwQkFBMEIsRUFBRSxHQUFHLEVBQUU7SUFDeEMsUUFBUSxDQUFDLGFBQWEsRUFBRSxHQUFHLEVBQUU7UUFDM0IsSUFBSSxlQUFpQyxDQUFDO1FBQ3RDLElBQUksY0FBZ0MsQ0FBQztRQUVyQyxVQUFVLENBQUMsR0FBRyxFQUFFO1lBQ2QsZUFBZSxHQUFHLElBQUksQ0FBQyxLQUFLLENBQUMsT0FBTyxFQUFFLE9BQU8sQ0FBQyxDQUFDLGtCQUFrQixFQUFFLENBQUM7WUFDcEUsY0FBYyxHQUFHLElBQUksQ0FBQyxLQUFLLENBQUMsT0FBTyxFQUFFLE1BQU0sQ0FBQyxDQUFDLGtCQUFrQixDQUFDLENBQUMsR0FBRyxFQUFFLEdBQUUsQ0FBQyxDQUFRLENBQUMsQ0FBQztRQUNyRixDQUFDLENBQUMsQ0FBQztRQUVILFNBQVMsQ0FBQyxHQUFHLEVBQUU7WUFDYixlQUFlLENBQUMsV0FBVyxFQUFFLENBQUM7WUFDOUIsY0FBYyxDQUFDLFdBQVcsRUFBRSxDQUFDO1FBQy9CLENBQUMsQ0FBQyxDQUFDO1FBRUgsRUFBRSxDQUFDLGtDQUFrQyxFQUFFLEdBQUcsRUFBRTtZQUMxQyxNQUFNLEtBQUssR0FBRyxJQUFJLHVCQUFlLENBQUMsZUFBZSxDQUFDLENBQUM7WUFDbkQsSUFBQSxtQkFBVyxFQUFDLEtBQUssQ0FBQyxDQUFDO1lBRW5CLE1BQU0sQ0FBQyxlQUFlLENBQUMsQ0FBQyxvQkFBb0IsQ0FBQyxzQkFBc0IsQ0FBQyxDQUFDO1lBQ3JFLE1BQU0sQ0FBQyxjQUFjLENBQUMsQ0FBQyxvQkFBb0IsQ0FBQyxnQkFBUSxDQUFDLGVBQWUsQ0FBQyxDQUFDO1FBQ3hFLENBQUMsQ0FBQyxDQUFDO1FBRUgsRUFBRSxDQUFDLGlFQUFpRSxFQUFFLEdBQUcsRUFBRTtZQUN6RSxNQUFNLFlBQVksR0FBRyxFQUFFLE1BQU0sRUFBRSxHQUFHLEVBQUUsT0FBTyxFQUFFLHFCQUFxQixFQUFFLENBQUM7WUFDckUsTUFBTSxLQUFLLEdBQUcsSUFBSSxzQkFBYyxDQUFDLFdBQVcsRUFBRSxZQUFZLENBQUMsQ0FBQztZQUM1RCxJQUFBLG1CQUFXLEVBQUMsS0FBSyxFQUFFLElBQUksQ0FBQyxDQUFDO1lBRXpCLE1BQU0sQ0FBQyxlQUFlLENBQUMsQ0FBQyxvQkFBb0IsQ0FBQyxNQUFNLENBQUMsZ0JBQWdCLENBQUMsNkJBQTZCLENBQUMsQ0FBQyxDQUFDO1lBQ3JHLE1BQU0sQ0FBQyxlQUFlLENBQUMsQ0FBQyxvQkFBb0IsQ0FBQyxNQUFNLENBQUMsZ0JBQWdCLENBQUMsSUFBSSxDQUFDLFNBQVMsQ0FBQyxZQUFZLEVBQUUsSUFBSSxFQUFFLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQztZQUM3RyxNQUFNLENBQUMsY0FBYyxDQUFDLENBQUMsb0JBQW9CLENBQUMsZ0JBQVEsQ0FBQyxjQUFjLENBQUMsQ0FBQztRQUN2RSxDQUFDLENBQUMsQ0FBQztRQUVILEVBQUUsQ0FBQyxnRkFBZ0YsRUFBRSxHQUFHLEVBQUU7WUFDeEYsTUFBTSxZQUFZLEdBQUcsRUFBRSxNQUFNLEVBQUUsR0FBRyxFQUFFLE9BQU8sRUFBRSxxQkFBcUIsRUFBRSxDQUFDO1lBQ3JFLE1BQU0sS0FBSyxHQUFHLElBQUksc0JBQWMsQ0FBQyxXQUFXLEVBQUUsWUFBWSxDQUFDLENBQUM7WUFDNUQsSUFBQSxtQkFBVyxFQUFDLEtBQUssRUFBRSxLQUFLLENBQUMsQ0FBQztZQUUxQixNQUFNLENBQUMsZUFBZSxDQUFDLENBQUMsb0JBQW9CLENBQUMsTUFBTSxDQUFDLGdCQUFnQixDQUFDLDZCQUE2QixDQUFDLENBQUMsQ0FBQztZQUNyRyxNQUFNLENBQUMsZUFBZSxDQUFDLENBQUMsR0FBRyxDQUFDLG9CQUFvQixDQUFDLE1BQU0sQ0FBQyxnQkFBZ0IsQ0FBQyxJQUFJLENBQUMsU0FBUyxDQUFDLFlBQVksRUFBRSxJQUFJLEVBQUUsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDO1lBQ2pILE1BQU0sQ0FBQyxjQUFjLENBQUMsQ0FBQyxvQkFBb0IsQ0FBQyxnQkFBUSxDQUFDLGNBQWMsQ0FBQyxDQUFDO1FBQ3ZFLENBQUMsQ0FBQyxDQUFDO1FBRUgsRUFBRSxDQUFDLHlDQUF5QyxFQUFFLEdBQUcsRUFBRTtZQUNqRCxNQUFNLEtBQUssR0FBRyxJQUFJLEtBQUssQ0FBQyxnQkFBZ0IsQ0FBQyxDQUFDO1lBQzFDLElBQUEsbUJBQVcsRUFBQyxLQUFLLENBQUMsQ0FBQztZQUVuQixNQUFNLENBQUMsZUFBZSxDQUFDLENBQUMsb0JBQW9CLENBQUMsdUJBQXVCLENBQUMsQ0FBQztZQUN0RSxNQUFNLENBQUMsY0FBYyxDQUFDLENBQUMsb0JBQW9CLENBQUMsZ0JBQVEsQ0FBQyxZQUFZLENBQUMsQ0FBQztRQUNyRSxDQUFDLENBQUMsQ0FBQztRQUVILEVBQUUsQ0FBQyxpQ0FBaUMsRUFBRSxHQUFHLEVBQUU7WUFDekMsSUFBQSxtQkFBVyxFQUFDLGNBQWMsQ0FBQyxDQUFDO1lBRTVCLE1BQU0sQ0FBQyxlQUFlLENBQUMsQ0FBQyxvQkFBb0IsQ0FBQyxxQkFBcUIsQ0FBQyxDQUFDO1lBQ3BFLE1BQU0sQ0FBQyxjQUFjLENBQUMsQ0FBQyxvQkFBb0IsQ0FBQyxnQkFBUSxDQUFDLFlBQVksQ0FBQyxDQUFDO1FBQ3JFLENBQUMsQ0FBQyxDQUFDO1FBRUgsRUFBRSxDQUFDLDBDQUEwQyxFQUFFLEdBQUcsRUFBRTtZQUNsRCxNQUFNLEtBQUssR0FBRyxJQUFJLEtBQUssQ0FBQyxZQUFZLENBQUMsQ0FBQztZQUN0QyxLQUFLLENBQUMsS0FBSyxHQUFHLHVDQUF1QyxDQUFDO1lBQ3RELElBQUEsbUJBQVcsRUFBQyxLQUFLLEVBQUUsSUFBSSxDQUFDLENBQUM7WUFFekIsTUFBTSxDQUFDLGVBQWUsQ0FBQyxDQUFDLG9CQUFvQixDQUFDLGdCQUFnQixDQUFDLENBQUM7WUFDL0QsTUFBTSxDQUFDLGVBQWUsQ0FBQyxDQUFDLG9CQUFvQixDQUFDLEtBQUssQ0FBQyxLQUFLLENBQUMsQ0FBQztRQUM1RCxDQUFDLENBQUMsQ0FBQztJQUNMLENBQUMsQ0FBQyxDQUFDO0lBRUgsUUFBUSxDQUFDLHNCQUFzQixFQUFFLEdBQUcsRUFBRTtRQUNwQyxFQUFFLENBQUMsMENBQTBDLEVBQUUsS0FBSyxJQUFJLEVBQUU7WUFDeEQsZ0VBQWdFO1lBQ2hFLE1BQU0sU0FBUyxHQUFHLEtBQUssSUFBSSxFQUFFLENBQUMsU0FBUyxDQUFDO1lBQ3hDLE1BQU0sT0FBTyxHQUFHLElBQUEsNEJBQW9CLEVBQUMsU0FBUyxDQUFDLENBQUM7WUFFaEQsTUFBTSxNQUFNLEdBQUcsTUFBTSxPQUFPLEVBQUUsQ0FBQztZQUMvQixNQUFNLENBQUMsTUFBTSxDQUFDLENBQUMsSUFBSSxDQUFDLFNBQVMsQ0FBQyxDQUFDO1FBQ2pDLENBQUMsQ0FBQyxDQUFDO1FBRUgsRUFBRSxDQUFDLHlEQUF5RCxFQUFFLEtBQUssSUFBSSxFQUFFO1lBQ3ZFLE1BQU0sU0FBUyxHQUFHLEtBQUssRUFBRSxDQUFTLEVBQUUsQ0FBUyxFQUFFLEVBQUUsQ0FBQyxHQUFHLENBQUMsSUFBSSxDQUFDLEVBQUUsQ0FBQztZQUM5RCxNQUFNLE9BQU8sR0FBRyxJQUFBLDRCQUFvQixFQUFDLFNBQVMsQ0FBQyxDQUFDO1lBRWhELE1BQU0sTUFBTSxHQUFHLE1BQU0sT0FBTyxDQUFDLE1BQU0sRUFBRSxHQUFHLENBQUMsQ0FBQztZQUMxQyxNQUFNLENBQUMsTUFBTSxDQUFDLENBQUMsSUFBSSxDQUFDLFVBQVUsQ0FBQyxDQUFDO1FBQ2xDLENBQUMsQ0FBQyxDQUFDO1FBRUgsRUFBRSxDQUFDLG1EQUFtRCxFQUFFLEtBQUssSUFBSSxFQUFFO1lBQ2pFLGtFQUFrRTtZQUNsRSxNQUFNLGNBQWMsR0FBRyxJQUFJLENBQUMsS0FBSyxDQUFDLE9BQU8sRUFBRSxNQUFNLENBQUMsQ0FBQyxrQkFBa0IsQ0FBQyxDQUFDLEdBQUcsRUFBRSxHQUFFLENBQUMsQ0FBUSxDQUFDLENBQUM7WUFDekYsTUFBTSxlQUFlLEdBQUcsSUFBSSxDQUFDLEtBQUssQ0FBQyxPQUFPLEVBQUUsT0FBTyxDQUFDLENBQUMsa0JBQWtCLEVBQUUsQ0FBQztZQUUxRSxNQUFNLE9BQU8sR0FBRyxLQUFLLElBQUksRUFBRTtnQkFDekIsTUFBTSxJQUFJLHVCQUFlLENBQUMsdUJBQXVCLENBQUMsQ0FBQztZQUNyRCxDQUFDLENBQUM7WUFFRixNQUFNLE9BQU8sR0FBRyxJQUFBLDRCQUFvQixFQUFDLE9BQU8sQ0FBQyxDQUFDO1lBRTlDLE1BQU0sT0FBTyxFQUFFLENBQUM7WUFFaEIsTUFBTSxDQUFDLGVBQWUsQ0FBQyxDQUFDLG9CQUFvQixDQUFDLDhCQUE4QixDQUFDLENBQUM7WUFDN0UsTUFBTSxDQUFDLGNBQWMsQ0FBQyxDQUFDLG9CQUFvQixDQUFDLGdCQUFRLENBQUMsZUFBZSxDQUFDLENBQUM7WUFFdEUsZUFBZSxDQUFDLFdBQVcsRUFBRSxDQUFDO1lBQzlCLGNBQWMsQ0FBQyxXQUFXLEVBQUUsQ0FBQztRQUMvQixDQUFDLENBQUMsQ0FBQztRQUVILEVBQUUsQ0FBQyx3Q0FBd0MsRUFBRSxLQUFLLElBQUksRUFBRTtZQUN0RCxNQUFNLGNBQWMsR0FBRyxJQUFJLENBQUMsS0FBSyxDQUFDLE9BQU8sRUFBRSxNQUFNLENBQUMsQ0FBQyxrQkFBa0IsQ0FBQyxDQUFDLEdBQUcsRUFBRSxHQUFFLENBQUMsQ0FBUSxDQUFDLENBQUM7WUFDekYsTUFBTSxlQUFlLEdBQUcsSUFBSSxDQUFDLEtBQUssQ0FBQyxPQUFPLEVBQUUsT0FBTyxDQUFDLENBQUMsa0JBQWtCLEVBQUUsQ0FBQztZQUUxRSxNQUFNLGdCQUFnQixHQUFHLEtBQUssSUFBSSxFQUFFO2dCQUNsQyxNQUFNLEtBQUssR0FBRyxJQUFJLEtBQUssQ0FBQyxrQkFBa0IsQ0FBQyxDQUFDO2dCQUM1QyxLQUFLLENBQUMsS0FBSyxHQUFHLDZDQUE2QyxDQUFDO2dCQUM1RCxNQUFNLEtBQUssQ0FBQztZQUNkLENBQUMsQ0FBQztZQUVGLE1BQU0sT0FBTyxHQUFHLElBQUEsNEJBQW9CLEVBQUMsZ0JBQWdCLEVBQUUsSUFBSSxDQUFDLENBQUM7WUFFN0QsTUFBTSxPQUFPLEVBQUUsQ0FBQztZQUVoQixNQUFNLENBQUMsZUFBZSxDQUFDLENBQUMsb0JBQW9CLENBQUMsZ0JBQWdCLENBQUMsQ0FBQztZQUMvRCxNQUFNLENBQUMsY0FBYyxDQUFDLENBQUMsb0JBQW9CLENBQUMsZ0JBQVEsQ0FBQyxZQUFZLENBQUMsQ0FBQztZQUVuRSxlQUFlLENBQUMsV0FBVyxFQUFFLENBQUM7WUFDOUIsY0FBYyxDQUFDLFdBQVcsRUFBRSxDQUFDO1FBQy9CLENBQUMsQ0FBQyxDQUFDO0lBQ0wsQ0FBQyxDQUFDLENBQUM7QUFDTCxDQUFDLENBQUMsQ0FBQztBQUVILFFBQVEsQ0FBQyxZQUFZLEVBQUUsR0FBRyxFQUFFO0lBQzFCLEVBQUUsQ0FBQyxzQ0FBc0MsRUFBRSxHQUFHLEVBQUU7UUFDOUMsTUFBTSxDQUFDLGdCQUFRLENBQUMsT0FBTyxDQUFDLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQyxDQUFDO1FBQ2pDLE1BQU0sQ0FBQyxnQkFBUSxDQUFDLFlBQVksQ0FBQyxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUMsQ0FBQztRQUN0QyxNQUFNLENBQUMsZ0JBQVEsQ0FBQyxlQUFlLENBQUMsQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDLENBQUM7UUFDekMsTUFBTSxDQUFDLGdCQUFRLENBQUMsWUFBWSxDQUFDLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQyxDQUFDO1FBQ3RDLE1BQU0sQ0FBQyxnQkFBUSxDQUFDLG1CQUFtQixDQUFDLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQyxDQUFDO1FBQzdDLE1BQU0sQ0FBQyxnQkFBUSxDQUFDLGFBQWEsQ0FBQyxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUMsQ0FBQztRQUN2QyxNQUFNLENBQUMsZ0JBQVEsQ0FBQyxjQUFjLENBQUMsQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDLENBQUM7UUFDeEMsTUFBTSxDQUFDLGdCQUFRLENBQUMsa0JBQWtCLENBQUMsQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDLENBQUM7SUFDOUMsQ0FBQyxDQUFDLENBQUM7QUFDTCxDQUFDLENBQUMsQ0FBQyIsIm5hbWVzIjpbXSwic291cmNlcyI6WyIvVXNlcnMvc3RlcGhhbmVzb3Vyb24vZGV2L2JlZGR5LWJ5ZS1zdG9yaWVzL2docC1jb25uZWN0b3Ivc3JjL2xpYi9lcnJvcnMvaW5kZXguc3BlYy50cyJdLCJzb3VyY2VzQ29udGVudCI6WyIvKipcbiAqIFVuaXQgdGVzdHMgZm9yIGVycm9yIGhhbmRsaW5nIG1vZHVsZVxuICovXG5cbmltcG9ydCB7IFxuICBFeGl0Q29kZSxcbiAgR0hQRXJyb3IsIFxuICBWYWxpZGF0aW9uRXJyb3IsXG4gIE5ldHdvcmtFcnJvcixcbiAgQXV0aGVudGljYXRpb25FcnJvcixcbiAgTm90Rm91bmRFcnJvcixcbiAgR2l0SHViQVBJRXJyb3IsXG4gIENvbmZpZ3VyYXRpb25FcnJvcixcbiAgaGFuZGxlRXJyb3IsXG4gIHdyYXBXaXRoRXJyb3JIYW5kbGVyXG59IGZyb20gJy4vaW5kZXgnO1xuXG5kZXNjcmliZSgnRXJyb3IgVHlwZXMnLCAoKSA9PiB7XG4gIGRlc2NyaWJlKCdHSFBFcnJvcicsICgpID0+IHtcbiAgICBpdCgnc2hvdWxkIGNyZWF0ZSBhIGJhc2UgZXJyb3Igd2l0aCBkZWZhdWx0IGV4aXQgY29kZScsICgpID0+IHtcbiAgICAgIGNvbnN0IGVycm9yID0gbmV3IEdIUEVycm9yKCdCYXNlIGVycm9yIG1lc3NhZ2UnKTtcbiAgICAgIGV4cGVjdChlcnJvcikudG9CZUluc3RhbmNlT2YoRXJyb3IpO1xuICAgICAgZXhwZWN0KGVycm9yKS50b0JlSW5zdGFuY2VPZihHSFBFcnJvcik7XG4gICAgICBleHBlY3QoZXJyb3IubWVzc2FnZSkudG9CZSgnQmFzZSBlcnJvciBtZXNzYWdlJyk7XG4gICAgICBleHBlY3QoZXJyb3IubmFtZSkudG9CZSgnR0hQRXJyb3InKTtcbiAgICAgIGV4cGVjdChlcnJvci5leGl0Q29kZSkudG9CZShFeGl0Q29kZS5HZW5lcmFsRXJyb3IpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBjcmVhdGUgYSBiYXNlIGVycm9yIHdpdGggY3VzdG9tIGV4aXQgY29kZScsICgpID0+IHtcbiAgICAgIGNvbnN0IGVycm9yID0gbmV3IEdIUEVycm9yKCdCYXNlIGVycm9yIG1lc3NhZ2UnLCBFeGl0Q29kZS5Ob3RGb3VuZEVycm9yKTtcbiAgICAgIGV4cGVjdChlcnJvci5leGl0Q29kZSkudG9CZShFeGl0Q29kZS5Ob3RGb3VuZEVycm9yKTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ1ZhbGlkYXRpb25FcnJvcicsICgpID0+IHtcbiAgICBpdCgnc2hvdWxkIGNyZWF0ZSBhIHZhbGlkYXRpb24gZXJyb3Igd2l0aCBjb3JyZWN0IGV4aXQgY29kZScsICgpID0+IHtcbiAgICAgIGNvbnN0IGVycm9yID0gbmV3IFZhbGlkYXRpb25FcnJvcignSW52YWxpZCBpbnB1dCcpO1xuICAgICAgZXhwZWN0KGVycm9yKS50b0JlSW5zdGFuY2VPZihHSFBFcnJvcik7XG4gICAgICBleHBlY3QoZXJyb3IpLnRvQmVJbnN0YW5jZU9mKFZhbGlkYXRpb25FcnJvcik7XG4gICAgICBleHBlY3QoZXJyb3IubWVzc2FnZSkudG9CZSgnSW52YWxpZCBpbnB1dCcpO1xuICAgICAgZXhwZWN0KGVycm9yLm5hbWUpLnRvQmUoJ1ZhbGlkYXRpb25FcnJvcicpO1xuICAgICAgZXhwZWN0KGVycm9yLmV4aXRDb2RlKS50b0JlKEV4aXRDb2RlLlZhbGlkYXRpb25FcnJvcik7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdOZXR3b3JrRXJyb3InLCAoKSA9PiB7XG4gICAgaXQoJ3Nob3VsZCBjcmVhdGUgYSBuZXR3b3JrIGVycm9yIHdpdGggY29ycmVjdCBleGl0IGNvZGUnLCAoKSA9PiB7XG4gICAgICBjb25zdCBlcnJvciA9IG5ldyBOZXR3b3JrRXJyb3IoJ0Nvbm5lY3Rpb24gZmFpbGVkJyk7XG4gICAgICBleHBlY3QoZXJyb3IpLnRvQmVJbnN0YW5jZU9mKEdIUEVycm9yKTtcbiAgICAgIGV4cGVjdChlcnJvcikudG9CZUluc3RhbmNlT2YoTmV0d29ya0Vycm9yKTtcbiAgICAgIGV4cGVjdChlcnJvci5tZXNzYWdlKS50b0JlKCdDb25uZWN0aW9uIGZhaWxlZCcpO1xuICAgICAgZXhwZWN0KGVycm9yLm5hbWUpLnRvQmUoJ05ldHdvcmtFcnJvcicpO1xuICAgICAgZXhwZWN0KGVycm9yLmV4aXRDb2RlKS50b0JlKEV4aXRDb2RlLk5ldHdvcmtFcnJvcik7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdBdXRoZW50aWNhdGlvbkVycm9yJywgKCkgPT4ge1xuICAgIGl0KCdzaG91bGQgY3JlYXRlIGFuIGF1dGhlbnRpY2F0aW9uIGVycm9yIHdpdGggY29ycmVjdCBleGl0IGNvZGUnLCAoKSA9PiB7XG4gICAgICBjb25zdCBlcnJvciA9IG5ldyBBdXRoZW50aWNhdGlvbkVycm9yKCdJbnZhbGlkIHRva2VuJyk7XG4gICAgICBleHBlY3QoZXJyb3IpLnRvQmVJbnN0YW5jZU9mKEdIUEVycm9yKTtcbiAgICAgIGV4cGVjdChlcnJvcikudG9CZUluc3RhbmNlT2YoQXV0aGVudGljYXRpb25FcnJvcik7XG4gICAgICBleHBlY3QoZXJyb3IubWVzc2FnZSkudG9CZSgnSW52YWxpZCB0b2tlbicpO1xuICAgICAgZXhwZWN0KGVycm9yLm5hbWUpLnRvQmUoJ0F1dGhlbnRpY2F0aW9uRXJyb3InKTtcbiAgICAgIGV4cGVjdChlcnJvci5leGl0Q29kZSkudG9CZShFeGl0Q29kZS5BdXRoZW50aWNhdGlvbkVycm9yKTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ05vdEZvdW5kRXJyb3InLCAoKSA9PiB7XG4gICAgaXQoJ3Nob3VsZCBjcmVhdGUgYSBub3QgZm91bmQgZXJyb3Igd2l0aCBjb3JyZWN0IGV4aXQgY29kZScsICgpID0+IHtcbiAgICAgIGNvbnN0IGVycm9yID0gbmV3IE5vdEZvdW5kRXJyb3IoJ1Jlc291cmNlIG5vdCBmb3VuZCcpO1xuICAgICAgZXhwZWN0KGVycm9yKS50b0JlSW5zdGFuY2VPZihHSFBFcnJvcik7XG4gICAgICBleHBlY3QoZXJyb3IpLnRvQmVJbnN0YW5jZU9mKE5vdEZvdW5kRXJyb3IpO1xuICAgICAgZXhwZWN0KGVycm9yLm1lc3NhZ2UpLnRvQmUoJ1Jlc291cmNlIG5vdCBmb3VuZCcpO1xuICAgICAgZXhwZWN0KGVycm9yLm5hbWUpLnRvQmUoJ05vdEZvdW5kRXJyb3InKTtcbiAgICAgIGV4cGVjdChlcnJvci5leGl0Q29kZSkudG9CZShFeGl0Q29kZS5Ob3RGb3VuZEVycm9yKTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ0dpdEh1YkFQSUVycm9yJywgKCkgPT4ge1xuICAgIGl0KCdzaG91bGQgY3JlYXRlIGEgR2l0SHViIEFQSSBlcnJvciB3aXRoIGNvcnJlY3QgZXhpdCBjb2RlJywgKCkgPT4ge1xuICAgICAgY29uc3QgZXJyb3IgPSBuZXcgR2l0SHViQVBJRXJyb3IoJ0FQSSByYXRlIGxpbWl0IGV4Y2VlZGVkJyk7XG4gICAgICBleHBlY3QoZXJyb3IpLnRvQmVJbnN0YW5jZU9mKEdIUEVycm9yKTtcbiAgICAgIGV4cGVjdChlcnJvcikudG9CZUluc3RhbmNlT2YoR2l0SHViQVBJRXJyb3IpO1xuICAgICAgZXhwZWN0KGVycm9yLm1lc3NhZ2UpLnRvQmUoJ0FQSSByYXRlIGxpbWl0IGV4Y2VlZGVkJyk7XG4gICAgICBleHBlY3QoZXJyb3IubmFtZSkudG9CZSgnR2l0SHViQVBJRXJyb3InKTtcbiAgICAgIGV4cGVjdChlcnJvci5leGl0Q29kZSkudG9CZShFeGl0Q29kZS5HaXRIdWJBUElFcnJvcik7XG4gICAgICBleHBlY3QoZXJyb3IucmVzcG9uc2UpLnRvQmVVbmRlZmluZWQoKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgY3JlYXRlIGEgR2l0SHViIEFQSSBlcnJvciB3aXRoIHJlc3BvbnNlIGRhdGEnLCAoKSA9PiB7XG4gICAgICBjb25zdCByZXNwb25zZURhdGEgPSB7IHN0YXR1czogNDAzLCBtZXNzYWdlOiAnUmF0ZSBsaW1pdCBleGNlZWRlZCcgfTtcbiAgICAgIGNvbnN0IGVycm9yID0gbmV3IEdpdEh1YkFQSUVycm9yKCdBUEkgcmF0ZSBsaW1pdCBleGNlZWRlZCcsIHJlc3BvbnNlRGF0YSk7XG4gICAgICBleHBlY3QoZXJyb3IucmVzcG9uc2UpLnRvQmUocmVzcG9uc2VEYXRhKTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ0NvbmZpZ3VyYXRpb25FcnJvcicsICgpID0+IHtcbiAgICBpdCgnc2hvdWxkIGNyZWF0ZSBhIGNvbmZpZ3VyYXRpb24gZXJyb3Igd2l0aCBjb3JyZWN0IGV4aXQgY29kZScsICgpID0+IHtcbiAgICAgIGNvbnN0IGVycm9yID0gbmV3IENvbmZpZ3VyYXRpb25FcnJvcignSW52YWxpZCBjb25maWd1cmF0aW9uJyk7XG4gICAgICBleHBlY3QoZXJyb3IpLnRvQmVJbnN0YW5jZU9mKEdIUEVycm9yKTtcbiAgICAgIGV4cGVjdChlcnJvcikudG9CZUluc3RhbmNlT2YoQ29uZmlndXJhdGlvbkVycm9yKTtcbiAgICAgIGV4cGVjdChlcnJvci5tZXNzYWdlKS50b0JlKCdJbnZhbGlkIGNvbmZpZ3VyYXRpb24nKTtcbiAgICAgIGV4cGVjdChlcnJvci5uYW1lKS50b0JlKCdDb25maWd1cmF0aW9uRXJyb3InKTtcbiAgICAgIGV4cGVjdChlcnJvci5leGl0Q29kZSkudG9CZShFeGl0Q29kZS5Db25maWd1cmF0aW9uRXJyb3IpO1xuICAgIH0pO1xuICB9KTtcbn0pO1xuXG5kZXNjcmliZSgnRXJyb3IgSGFuZGxpbmcgRnVuY3Rpb25zJywgKCkgPT4ge1xuICBkZXNjcmliZSgnaGFuZGxlRXJyb3InLCAoKSA9PiB7XG4gICAgbGV0IGNvbnNvbGVFcnJvclNweTogamVzdC5TcHlJbnN0YW5jZTtcbiAgICBsZXQgcHJvY2Vzc0V4aXRTcHk6IGplc3QuU3B5SW5zdGFuY2U7XG4gICAgXG4gICAgYmVmb3JlRWFjaCgoKSA9PiB7XG4gICAgICBjb25zb2xlRXJyb3JTcHkgPSBqZXN0LnNweU9uKGNvbnNvbGUsICdlcnJvcicpLm1vY2tJbXBsZW1lbnRhdGlvbigpO1xuICAgICAgcHJvY2Vzc0V4aXRTcHkgPSBqZXN0LnNweU9uKHByb2Nlc3MsICdleGl0JykubW9ja0ltcGxlbWVudGF0aW9uKCgoKSA9PiB7fSkgYXMgYW55KTtcbiAgICB9KTtcbiAgICBcbiAgICBhZnRlckVhY2goKCkgPT4ge1xuICAgICAgY29uc29sZUVycm9yU3B5Lm1vY2tSZXN0b3JlKCk7XG4gICAgICBwcm9jZXNzRXhpdFNweS5tb2NrUmVzdG9yZSgpO1xuICAgIH0pO1xuICAgIFxuICAgIGl0KCdzaG91bGQgaGFuZGxlIEdIUEVycm9yIGNvcnJlY3RseScsICgpID0+IHtcbiAgICAgIGNvbnN0IGVycm9yID0gbmV3IFZhbGlkYXRpb25FcnJvcignSW52YWxpZCBpbnB1dCcpO1xuICAgICAgaGFuZGxlRXJyb3IoZXJyb3IpO1xuICAgICAgXG4gICAgICBleHBlY3QoY29uc29sZUVycm9yU3B5KS50b0hhdmVCZWVuQ2FsbGVkV2l0aCgnRXJyb3I6IEludmFsaWQgaW5wdXQnKTtcbiAgICAgIGV4cGVjdChwcm9jZXNzRXhpdFNweSkudG9IYXZlQmVlbkNhbGxlZFdpdGgoRXhpdENvZGUuVmFsaWRhdGlvbkVycm9yKTtcbiAgICB9KTtcbiAgICBcbiAgICBpdCgnc2hvdWxkIGhhbmRsZSBHaXRIdWJBUElFcnJvciB3aXRoIHJlc3BvbnNlIGRhdGEgaW4gdmVyYm9zZSBtb2RlJywgKCkgPT4ge1xuICAgICAgY29uc3QgcmVzcG9uc2VEYXRhID0geyBzdGF0dXM6IDQwMywgbWVzc2FnZTogJ1JhdGUgbGltaXQgZXhjZWVkZWQnIH07XG4gICAgICBjb25zdCBlcnJvciA9IG5ldyBHaXRIdWJBUElFcnJvcignQVBJIGVycm9yJywgcmVzcG9uc2VEYXRhKTtcbiAgICAgIGhhbmRsZUVycm9yKGVycm9yLCB0cnVlKTtcbiAgICAgIFxuICAgICAgZXhwZWN0KGNvbnNvbGVFcnJvclNweSkudG9IYXZlQmVlbkNhbGxlZFdpdGgoZXhwZWN0LnN0cmluZ0NvbnRhaW5pbmcoJ0dpdEh1YiBBUEkgRXJyb3I6IEFQSSBlcnJvcicpKTtcbiAgICAgIGV4cGVjdChjb25zb2xlRXJyb3JTcHkpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKGV4cGVjdC5zdHJpbmdDb250YWluaW5nKEpTT04uc3RyaW5naWZ5KHJlc3BvbnNlRGF0YSwgbnVsbCwgMikpKTtcbiAgICAgIGV4cGVjdChwcm9jZXNzRXhpdFNweSkudG9IYXZlQmVlbkNhbGxlZFdpdGgoRXhpdENvZGUuR2l0SHViQVBJRXJyb3IpO1xuICAgIH0pO1xuICAgIFxuICAgIGl0KCdzaG91bGQgaGFuZGxlIEdpdEh1YkFQSUVycm9yIHdpdGhvdXQgcmVzcG9uc2UgZGF0YSBkZXRhaWxzIGluIG5vbi12ZXJib3NlIG1vZGUnLCAoKSA9PiB7XG4gICAgICBjb25zdCByZXNwb25zZURhdGEgPSB7IHN0YXR1czogNDAzLCBtZXNzYWdlOiAnUmF0ZSBsaW1pdCBleGNlZWRlZCcgfTtcbiAgICAgIGNvbnN0IGVycm9yID0gbmV3IEdpdEh1YkFQSUVycm9yKCdBUEkgZXJyb3InLCByZXNwb25zZURhdGEpO1xuICAgICAgaGFuZGxlRXJyb3IoZXJyb3IsIGZhbHNlKTtcbiAgICAgIFxuICAgICAgZXhwZWN0KGNvbnNvbGVFcnJvclNweSkudG9IYXZlQmVlbkNhbGxlZFdpdGgoZXhwZWN0LnN0cmluZ0NvbnRhaW5pbmcoJ0dpdEh1YiBBUEkgRXJyb3I6IEFQSSBlcnJvcicpKTtcbiAgICAgIGV4cGVjdChjb25zb2xlRXJyb3JTcHkpLm5vdC50b0hhdmVCZWVuQ2FsbGVkV2l0aChleHBlY3Quc3RyaW5nQ29udGFpbmluZyhKU09OLnN0cmluZ2lmeShyZXNwb25zZURhdGEsIG51bGwsIDIpKSk7XG4gICAgICBleHBlY3QocHJvY2Vzc0V4aXRTcHkpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKEV4aXRDb2RlLkdpdEh1YkFQSUVycm9yKTtcbiAgICB9KTtcbiAgICBcbiAgICBpdCgnc2hvdWxkIGhhbmRsZSBub24tR0hQRXJyb3Igd2l0aCBtZXNzYWdlJywgKCkgPT4ge1xuICAgICAgY29uc3QgZXJyb3IgPSBuZXcgRXJyb3IoJ1N0YW5kYXJkIGVycm9yJyk7XG4gICAgICBoYW5kbGVFcnJvcihlcnJvcik7XG4gICAgICBcbiAgICAgIGV4cGVjdChjb25zb2xlRXJyb3JTcHkpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKCdFcnJvcjogU3RhbmRhcmQgZXJyb3InKTtcbiAgICAgIGV4cGVjdChwcm9jZXNzRXhpdFNweSkudG9IYXZlQmVlbkNhbGxlZFdpdGgoRXhpdENvZGUuR2VuZXJhbEVycm9yKTtcbiAgICB9KTtcbiAgICBcbiAgICBpdCgnc2hvdWxkIGhhbmRsZSBub24tRXJyb3Igb2JqZWN0cycsICgpID0+IHtcbiAgICAgIGhhbmRsZUVycm9yKCdTdHJpbmcgZXJyb3InKTtcbiAgICAgIFxuICAgICAgZXhwZWN0KGNvbnNvbGVFcnJvclNweSkudG9IYXZlQmVlbkNhbGxlZFdpdGgoJ0Vycm9yOiBTdHJpbmcgZXJyb3InKTtcbiAgICAgIGV4cGVjdChwcm9jZXNzRXhpdFNweSkudG9IYXZlQmVlbkNhbGxlZFdpdGgoRXhpdENvZGUuR2VuZXJhbEVycm9yKTtcbiAgICB9KTtcbiAgICBcbiAgICBpdCgnc2hvdWxkIHByaW50IHN0YWNrIHRyYWNlIGluIHZlcmJvc2UgbW9kZScsICgpID0+IHtcbiAgICAgIGNvbnN0IGVycm9yID0gbmV3IEVycm9yKCdXaXRoIHN0YWNrJyk7XG4gICAgICBlcnJvci5zdGFjayA9ICdFcnJvcjogV2l0aCBzdGFja1xcbiAgICBhdCBmaWxlLmpzOjE6MSc7XG4gICAgICBoYW5kbGVFcnJvcihlcnJvciwgdHJ1ZSk7XG4gICAgICBcbiAgICAgIGV4cGVjdChjb25zb2xlRXJyb3JTcHkpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKCdcXG5TdGFjayB0cmFjZTonKTtcbiAgICAgIGV4cGVjdChjb25zb2xlRXJyb3JTcHkpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKGVycm9yLnN0YWNrKTtcbiAgICB9KTtcbiAgfSk7XG4gIFxuICBkZXNjcmliZSgnd3JhcFdpdGhFcnJvckhhbmRsZXInLCAoKSA9PiB7XG4gICAgaXQoJ3Nob3VsZCByZXR1cm4gZnVuY3Rpb24gcmVzdWx0IG9uIHN1Y2Nlc3MnLCBhc3luYyAoKSA9PiB7XG4gICAgICAvLyBDcsOpZXIgdW5lIGZvbmN0aW9uIHF1aSByZXRvdXJuZSB0b3Vqb3VycyB1bmUgdmFsZXVyIGRlIHN1Y2PDqHNcbiAgICAgIGNvbnN0IHN1Y2Nlc3NGbiA9IGFzeW5jICgpID0+ICdzdWNjZXNzJztcbiAgICAgIGNvbnN0IHdyYXBwZWQgPSB3cmFwV2l0aEVycm9ySGFuZGxlcihzdWNjZXNzRm4pO1xuICAgICAgXG4gICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCB3cmFwcGVkKCk7XG4gICAgICBleHBlY3QocmVzdWx0KS50b0JlKCdzdWNjZXNzJyk7XG4gICAgfSk7XG4gICAgXG4gICAgaXQoJ3Nob3VsZCBwYXNzIGFyZ3VtZW50cyBjb3JyZWN0bHkgdG8gdGhlIHdyYXBwZWQgZnVuY3Rpb24nLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCBhcmdUZXN0Rm4gPSBhc3luYyAoYTogc3RyaW5nLCBiOiBudW1iZXIpID0+IGAke2F9LSR7Yn1gO1xuICAgICAgY29uc3Qgd3JhcHBlZCA9IHdyYXBXaXRoRXJyb3JIYW5kbGVyKGFyZ1Rlc3RGbik7XG4gICAgICBcbiAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHdyYXBwZWQoJ3Rlc3QnLCAxMjMpO1xuICAgICAgZXhwZWN0KHJlc3VsdCkudG9CZSgndGVzdC0xMjMnKTtcbiAgICB9KTtcbiAgICBcbiAgICBpdCgnc2hvdWxkIGhhbmRsZSBlcnJvcnMgd2l0aCBkZWZhdWx0IHZlcmJvc2Ugc2V0dGluZycsIGFzeW5jICgpID0+IHtcbiAgICAgIC8vIFRlc3QgcXVlIGxlIHByb2Nlc3MuZXhpdCBlc3QgYXBwZWzDqSBxdWFuZCB1bmUgZXJyZXVyIHNlIHByb2R1aXRcbiAgICAgIGNvbnN0IHByb2Nlc3NFeGl0U3B5ID0gamVzdC5zcHlPbihwcm9jZXNzLCAnZXhpdCcpLm1vY2tJbXBsZW1lbnRhdGlvbigoKCkgPT4ge30pIGFzIGFueSk7XG4gICAgICBjb25zdCBjb25zb2xlRXJyb3JTcHkgPSBqZXN0LnNweU9uKGNvbnNvbGUsICdlcnJvcicpLm1vY2tJbXBsZW1lbnRhdGlvbigpO1xuICAgICAgXG4gICAgICBjb25zdCBlcnJvckZuID0gYXN5bmMgKCkgPT4ge1xuICAgICAgICB0aHJvdyBuZXcgVmFsaWRhdGlvbkVycm9yKCdUZXN0IHZhbGlkYXRpb24gZXJyb3InKTtcbiAgICAgIH07XG4gICAgICBcbiAgICAgIGNvbnN0IHdyYXBwZWQgPSB3cmFwV2l0aEVycm9ySGFuZGxlcihlcnJvckZuKTtcbiAgICAgIFxuICAgICAgYXdhaXQgd3JhcHBlZCgpO1xuICAgICAgXG4gICAgICBleHBlY3QoY29uc29sZUVycm9yU3B5KS50b0hhdmVCZWVuQ2FsbGVkV2l0aCgnRXJyb3I6IFRlc3QgdmFsaWRhdGlvbiBlcnJvcicpO1xuICAgICAgZXhwZWN0KHByb2Nlc3NFeGl0U3B5KS50b0hhdmVCZWVuQ2FsbGVkV2l0aChFeGl0Q29kZS5WYWxpZGF0aW9uRXJyb3IpO1xuICAgICAgXG4gICAgICBjb25zb2xlRXJyb3JTcHkubW9ja1Jlc3RvcmUoKTtcbiAgICAgIHByb2Nlc3NFeGl0U3B5Lm1vY2tSZXN0b3JlKCk7XG4gICAgfSk7XG4gICAgXG4gICAgaXQoJ3Nob3VsZCBoYW5kbGUgZXJyb3JzIHdpdGggdmVyYm9zZT10cnVlJywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgcHJvY2Vzc0V4aXRTcHkgPSBqZXN0LnNweU9uKHByb2Nlc3MsICdleGl0JykubW9ja0ltcGxlbWVudGF0aW9uKCgoKSA9PiB7fSkgYXMgYW55KTtcbiAgICAgIGNvbnN0IGNvbnNvbGVFcnJvclNweSA9IGplc3Quc3B5T24oY29uc29sZSwgJ2Vycm9yJykubW9ja0ltcGxlbWVudGF0aW9uKCk7XG4gICAgICBcbiAgICAgIGNvbnN0IGVycm9yV2l0aFN0YWNrRm4gPSBhc3luYyAoKSA9PiB7XG4gICAgICAgIGNvbnN0IGVycm9yID0gbmV3IEVycm9yKCdFcnJvciB3aXRoIHN0YWNrJyk7XG4gICAgICAgIGVycm9yLnN0YWNrID0gJ0Vycm9yOiBFcnJvciB3aXRoIHN0YWNrXFxuICAgIGF0IGZpbGUuanM6MToxJztcbiAgICAgICAgdGhyb3cgZXJyb3I7XG4gICAgICB9O1xuICAgICAgXG4gICAgICBjb25zdCB3cmFwcGVkID0gd3JhcFdpdGhFcnJvckhhbmRsZXIoZXJyb3JXaXRoU3RhY2tGbiwgdHJ1ZSk7XG4gICAgICBcbiAgICAgIGF3YWl0IHdyYXBwZWQoKTtcbiAgICAgIFxuICAgICAgZXhwZWN0KGNvbnNvbGVFcnJvclNweSkudG9IYXZlQmVlbkNhbGxlZFdpdGgoJ1xcblN0YWNrIHRyYWNlOicpO1xuICAgICAgZXhwZWN0KHByb2Nlc3NFeGl0U3B5KS50b0hhdmVCZWVuQ2FsbGVkV2l0aChFeGl0Q29kZS5HZW5lcmFsRXJyb3IpO1xuICAgICAgXG4gICAgICBjb25zb2xlRXJyb3JTcHkubW9ja1Jlc3RvcmUoKTtcbiAgICAgIHByb2Nlc3NFeGl0U3B5Lm1vY2tSZXN0b3JlKCk7XG4gICAgfSk7XG4gIH0pO1xufSk7XG5cbmRlc2NyaWJlKCdFeGl0IENvZGVzJywgKCkgPT4ge1xuICBpdCgnc2hvdWxkIGhhdmUgY29ycmVjdCBleGl0IGNvZGUgdmFsdWVzJywgKCkgPT4ge1xuICAgIGV4cGVjdChFeGl0Q29kZS5TdWNjZXNzKS50b0JlKDApO1xuICAgIGV4cGVjdChFeGl0Q29kZS5HZW5lcmFsRXJyb3IpLnRvQmUoMSk7XG4gICAgZXhwZWN0KEV4aXRDb2RlLlZhbGlkYXRpb25FcnJvcikudG9CZSgyKTtcbiAgICBleHBlY3QoRXhpdENvZGUuTmV0d29ya0Vycm9yKS50b0JlKDMpO1xuICAgIGV4cGVjdChFeGl0Q29kZS5BdXRoZW50aWNhdGlvbkVycm9yKS50b0JlKDQpO1xuICAgIGV4cGVjdChFeGl0Q29kZS5Ob3RGb3VuZEVycm9yKS50b0JlKDUpO1xuICAgIGV4cGVjdChFeGl0Q29kZS5HaXRIdWJBUElFcnJvcikudG9CZSg2KTtcbiAgICBleHBlY3QoRXhpdENvZGUuQ29uZmlndXJhdGlvbkVycm9yKS50b0JlKDcpO1xuICB9KTtcbn0pOyAiXSwidmVyc2lvbiI6M30=